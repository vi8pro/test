<!DOCTYPE html><html lang="en" class="__className_e34cb4"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://github.com/gaearon.png"/><link rel="preload" as="image" href="./react.png"/><link rel="stylesheet" href="/_next/static/css/0f6647b39fdbcb3d.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/3c6c21fa7f32edf2.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/f9d4d708579596e8.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-fdca05b8968262b2.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-da4818c833129d2a.js" async="" crossorigin=""></script><script src="/_next/static/chunks/472-44c3d350117a997d.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-74b5bca37634105e.js" async="" crossorigin=""></script><script src="/_next/static/chunks/569-52e5d813bbfa85ea.js" async=""></script><script src="/_next/static/chunks/app/layout-cfb37acb14684668.js" async=""></script><script src="/_next/static/chunks/app/%5Bslug%5D/layout-d3e08fbfdc858bf2.js" async=""></script><script src="/_next/static/chunks/app/%5Bslug%5D/page-798073576b23f3f1.js" async=""></script><title>React as a UI Runtime — overreacted</title><meta name="description" content="An in-depth description of the React programming model."/><link rel="icon" href="/icon.png?e0852c1e2c7f0e65" type="image/png" sizes="329x329"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="mx-auto max-w-2xl bg-[--bg] px-5 py-12 text-[--text]"><header class="mb-14 flex flex-row place-content-between"><a class="__className_b47211 inline-block text-2xl font-black hover:scale-[1.02] scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/"><span style="--myColor1:var(--pink);--myColor2:var(--purple);background-image:linear-gradient(45deg, var(--myColor1), var(--myColor2));background-clip:text;-webkit-background-clip:text;color:transparent;transition:--myColor1 0.2s ease-out, --myColor2 0.2s ease-in-out">overreacted</span></a><span class="relative top-[4px] italic">by<!-- --> <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://danabra.mov"><img alt="Dan Abramov" src="https://github.com/gaearon.png" class="relative -top-1 mx-1 inline h-8 w-8 rounded-full"/></a></span></header><main><article><h1 class="__className_b47211 text-[40px] font-black leading-[44px] text-[--title]">React as a UI Runtime</h1><p class="mt-2 text-[13px] text-gray-700 dark:text-gray-300">February 2, 2019</p><div class="markdown mt-10"><p>Most tutorials introduce React as a UI library. This makes sense because React <em>is</em> a UI library. That’s literally what the tagline says!</p>
<p><img src="./react.png" alt="React homepage screenshot: &quot;A JavaScript library for building user interfaces&quot;"/></p>
<p>I’ve written about the challenges of creating <a class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/the-elements-of-ui-engineering/">user interfaces</a> before. But this post talks about React in a different way — more as a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://en.wikipedia.org/wiki/Runtime_system">programming runtime</a>.</p>
<p><strong>This post won’t teach you anything about creating user interfaces.</strong> But it might help you understand the React programming model in more depth.</p>
<hr/>
<p><strong>Note: If you’re <em>learning</em> React, check out <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/getting-started.html#learn-react">the docs</a> instead.</strong></p>
<p><font size="60">⚠️</font></p>
<p><strong>This is a deep dive — THIS IS NOT a beginner-friendly post.</strong> In this post, I’m describing most of the React programming model from first principles. I don’t explain how to use it — just how it works.</p>
<p>It’s aimed at experienced programmers and folks working on other UI libraries who asked about some tradeoffs chosen in React. I hope you’ll find it useful!</p>
<p><strong>Many people successfully use React for years without thinking about most of these topics.</strong> This is definitely a programmer-centric view of React rather than, say, a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="http://mrmrs.cc/writing/developing-ui/">designer-centric one</a>. But I don’t think it hurts to have resources for both.</p>
<p>With that disclaimer out of the way, let’s go!</p>
<hr/>
<h2>Host Tree</h2>
<p>Some programs output numbers. Other programs output poems. Different languages and their runtimes are often optimized for a particular set of use cases, and React is no exception to that.</p>
<p>React programs usually output <strong>a tree that may change over time</strong>. It might be a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://www.npmjs.com/package/react-dom">DOM tree</a>, an <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://developer.apple.com/library/archive/documentation/General/Conceptual/Devpedia-CocoaApp/View%20Hierarchy.html">iOS hierarchy</a>, a tree of <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://react-pdf.org/">PDF primitives</a>, or even of <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/test-renderer.html">JSON objects</a>. However, usually, we want to represent some UI with it. We’ll call it a “<em>host</em> tree” because it is a part of the <em>host environment</em> outside of React — like DOM or iOS. The host tree usually has <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild">its</a> <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://developer.apple.com/documentation/uikit/uiview/1622616-addsubview">own</a> imperative API. React is a layer on top of it.</p>
<p>So what is React useful for? Very abstractly, it helps you write a program that predictably manipulates a complex host tree in response to external events like interactions, network responses, timers, and so on.</p>
<p>A specialized tool works better than a generic one when it can impose and benefit from particular constraints. React makes a bet on two principles:</p>
<ul>
<li>
<p><strong>Stability.</strong> The host tree is relatively stable and most updates don’t radically change its overall structure. If an app rearranged all its interactive elements into a completely different combination every second, it would be difficult to use. Where did that button go? Why is my screen dancing?</p>
</li>
<li>
<p><strong>Regularity.</strong> The host tree can be broken down into UI patterns that look and behave consistently (such as buttons, lists, avatars) rather than random shapes.</p>
</li>
</ul>
<p><strong>These principles happen to be true for most UIs.</strong> However, React is ill-suited when there are no stable “patterns” in the output. For example, React may help you write a Twitter client but won’t be very useful for a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://www.youtube.com/watch?v=Uzx9ArZ7MUU">3D pipes screensaver</a>.</p>
<h2>Host Instances</h2>
<p>The host tree consists of nodes. We’ll call them “host instances”.</p>
<p>In the DOM environment, host instances are regular DOM nodes — like the objects you get when you call <code>document.createElement(&#x27;div&#x27;)</code>. On iOS, host instances could be values uniquely identifying a native view from JavaScript.</p>
<p>Host instances have their own properties (e.g. <code>domNode.className</code> or <code>view.tintColor</code>). They may also contain other host instances as children.</p>
<p>(This has nothing to do with React — I’m describing the host environments.)</p>
<p>There is usually an API to manipulate host instances. For example, the DOM provides APIs like <code>appendChild</code>, <code>removeChild</code>, <code>setAttribute</code>, and so on. In React apps, you usually don’t call these APIs. That’s the job of React.</p>
<h2>Renderers</h2>
<p>A <em>renderer</em> teaches React to talk to a specific host environment and manage its host instances. React DOM, React Native, and even <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://mobile.twitter.com/vadimdemedes/status/1089344289102942211">Ink</a> are React renderers. You can also <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/facebook/react/tree/master/packages/react-reconciler">create your own React renderer</a>.</p>
<p>React renderers can work in one of two modes.</p>
<p>The vast majority of renderers are written to use the “mutating” mode. This mode is how the DOM works: we can create a node, set its properties, and later add or remove children from it. The host instances are completely mutable.</p>
<p>React can also work in a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://en.wikipedia.org/wiki/Persistent_data_structure">“persistent”</a> mode. This mode is for host environments that don’t provide methods like <code>appendChild()</code> but instead clone the parent tree and always replace the top-level child. Immutability on the host tree level makes multi-threading easier. <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://facebook.github.io/react-native/blog/2018/06/14/state-of-react-native-2018">React Fabric</a> takes advantage of that.</p>
<p>As a React user, you never need to think about these modes. I only want to highlight that React isn’t just an adapter from one mode to another. Its usefulness is orthogonal to the target low-level view API paradigm.</p>
<h2>React Elements</h2>
<p>In the host environment, a host instance (like a DOM node) is the smallest building block. In React, the smallest building block is a <em>React element</em>.</p>
<p>A React element is a plain JavaScript object. It can <em>describe</em> a host instance.</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// JSX is a syntax sugar for these objects.</span></span>
<span data-line=""><span style="color:#637777">// &lt;button className=&quot;blue&quot; /&gt;</span></span>
<span data-line=""><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  type: </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">button</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#CED2D6">  props: </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> className: </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">blue</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>A React element is lightweight and has no host instance tied to it. Again, it is merely a <em>description</em> of what you want to see on the screen.</p>
<p>Like host instances, React elements can form a tree:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// JSX is a syntax sugar for these objects.</span></span>
<span data-line=""><span style="color:#637777">// &lt;dialog&gt;</span></span>
<span data-line=""><span style="color:#637777">//   &lt;button className=&quot;blue&quot; /&gt;</span></span>
<span data-line=""><span style="color:#637777">//   &lt;button className=&quot;red&quot; /&gt;</span></span>
<span data-line=""><span style="color:#637777">// &lt;/dialog&gt;</span></span>
<span data-line=""><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  type: </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">dialog</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#CED2D6">  props: </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    children: </span><span style="color:#C792EA">[{</span></span>
<span data-line=""><span style="color:#CED2D6">      type</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">button</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#CED2D6">      props</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> className</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">blue</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      type</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">button</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#CED2D6">      props</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> className</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">red</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}]</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><em>(Note: I omitted <a class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/why-do-react-elements-have-typeof-property/">some properties</a> that aren’t important to this explanation.)</em></p>
<p>However, remember that <strong>React elements don’t have their own persistent identity.</strong> They’re meant to be re-created and thrown away all the time.</p>
<p>React elements are immutable. For example, you can’t change the children or a property of a React element. If you want to render something different later, you will <em>describe</em> it with a new React element tree created from scratch.</p>
<p>I like to think of React elements as being like frames in a movie. They capture what the UI should look like at a specific point in time. They don’t change.</p>
<h2>Entry Point</h2>
<p>Each React renderer has an “entry point”. It’s the API that lets us tell React to render a particular React element tree inside a container host instance.</p>
<p>For example, React DOM entry point is <code>ReactDOM.render</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// { type: &#x27;button&#x27;, props: { className: &#x27;blue&#x27; } }</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">blue</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA"> /&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">getElementById</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">container</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span></code></pre></div>
<p>When we say <code>ReactDOM.render(reactElement, domContainer)</code>, we mean: <strong>“Dear React, make the <code>domContainer</code> host tree match my <code>reactElement</code>.”</strong></p>
<p>React will look at the <code>reactElement.type</code> (in our example, <code>&#x27;button&#x27;</code>) and ask the React DOM renderer to create a host instance for it and set the properties:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// Somewhere in the ReactDOM renderer (simplified)</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">createHostInstance</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">reactElement</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">domNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">createElement</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">reactElement</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">type</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">domNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">className </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">reactElement</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">className</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> domNode</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>In our example, effectively React will do this:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">domNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">createElement</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">button</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">domNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">className </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">blue</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">domContainer</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">appendChild</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">domNode</span><span style="color:#C792EA">);</span></span></code></pre></div>
<p>If the React element has child elements in <code>reactElement.props.children</code>, React will recursively create host instances for them too on the first render.</p>
<h2>Reconciliation</h2>
<p>What happens if we call <code>ReactDOM.render()</code> twice with the same container?</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">blue</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA"> /&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">getElementById</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">container</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// ... later ...</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// Should this *replace* the button host instance</span></span>
<span data-line=""><span style="color:#637777">// or merely update a property on an existing one?</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">red</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA"> /&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">getElementById</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">container</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span></code></pre></div>
<p>Again, React’s job is to <em>make the host tree match the provided React element tree</em>. The process of figuring out <em>what</em> to do to the host instance tree in response to new information is sometimes called <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/reconciliation.html">reconciliation</a>.</p>
<p>There are two ways to go about it. A simplified version of React could blow away the existing tree and re-create it from scratch:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">domContainer</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">getElementById</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">container</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#637777">// Clear the tree</span></span>
<span data-line=""><span style="color:#FFA7C4">domContainer</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">innerHTML </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;&#x27;</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#637777">// Create the new host instance tree</span></span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">domNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">createElement</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">button</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">domNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">className </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">red</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#FFA7C4">domContainer</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">appendChild</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">domNode</span><span style="color:#C792EA">);</span></span></code></pre></div>
<p>But in DOM, this is slow and loses important information like focus, selection, scroll state, and so on. Instead, we want React to do something like this:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">domNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> domContainer</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">firstChild</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#637777">// Update existing host instance</span></span>
<span data-line=""><span style="color:#FFA7C4">domNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">className </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">red</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span></span></code></pre></div>
<p>In other words, React needs to decide when to <em>update</em> an existing host instance to match a new React element, and when to create a <em>new</em> one.</p>
<p>This raises a question of <em>identity</em>. The React element may be different every time, but when does it refer to the same host instance conceptually?</p>
<p>In our example, it’s simple. We used to render a <code>&lt;button&gt;</code> as a first (and only) child, and we want to render a <code>&lt;button&gt;</code> in the same place again. We already have a <code>&lt;button&gt;</code> host instance there so why re-create it? Let’s just reuse it.</p>
<p>This is pretty close to how React thinks about it.</p>
<p><strong>If an element type in the same place in the tree “matches up” between the previous and the next renders, React reuses the existing host instance.</strong></p>
<p>Here is an example with comments showing roughly what React does:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// let domNode = document.createElement(&#x27;button&#x27;);</span></span>
<span data-line=""><span style="color:#637777">// domNode.className = &#x27;blue&#x27;;</span></span>
<span data-line=""><span style="color:#637777">// domContainer.appendChild(domNode);</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">blue</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA"> /&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">getElementById</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">container</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#637777">// Can reuse host instance? Yes! (button → button)</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#637777">// domNode.className = &#x27;red&#x27;;</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">red</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA"> /&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">getElementById</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">container</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#637777">// Can reuse host instance? No! (button → p)</span></span>
<span data-line=""><span style="color:#637777">// domContainer.removeChild(domNode);</span></span>
<span data-line=""><span style="color:#637777">// domNode = document.createElement(&#x27;p&#x27;);</span></span>
<span data-line=""><span style="color:#637777">// domNode.textContent = &#x27;Hello&#x27;;</span></span>
<span data-line=""><span style="color:#637777">// domContainer.appendChild(domNode);</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">Hello</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">getElementById</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">container</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#637777">// Can reuse host instance? Yes! (p → p)</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#637777">// domNode.textContent = &#x27;Goodbye&#x27;;</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">Goodbye</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">getElementById</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">container</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span></code></pre></div>
<p>The same heuristic is used for child trees. For example, when we update a <code>&lt;dialog&gt;</code> with two <code>&lt;button&gt;</code>s inside, React first decides whether to re-use the <code>&lt;dialog&gt;</code>, and then repeats this decision procedure for each child.</p>
<h2>Conditions</h2>
<p>If React only reuses host instances when the element types “match up” between updates, how can we render conditional content?</p>
<p>Say we want to first show only an input, but later render a message before it:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// First render</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">dialog</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">input</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">dialog</span><span style="color:#C792EA">&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  domContainer</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// Next render</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">dialog</span><span style="color:#C792EA">&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">I was just added here!</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">input</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">dialog</span><span style="color:#C792EA">&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  domContainer</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span></code></pre></div>
<p>In this example, the <code>&lt;input&gt;</code> host instance would get re-created. React would walk the element tree, comparing it with the previous version:</p>
<ul>
<li><code>dialog → dialog</code>: Can reuse the host instance? <strong>Yes — the type matches.</strong>
<ul>
<li><code>input → p</code>: Can reuse the host instance? <strong>No, the type has changed!</strong> Need to remove the existing <code>input</code> and create a new <code>p</code> host instance.</li>
<li><code>(nothing) → input</code>: Need to create a new <code>input</code> host instance.</li>
</ul>
</li>
</ul>
<p>So effectively the update code executed by React would be like:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">oldInputNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> dialogNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">firstChild</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">dialogNode</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">removeChild</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">oldInputNode</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">pNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">createElement</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">p</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">pNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">textContent </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">I was just added here!</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#FFA7C4">dialogNode</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">appendChild</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">pNode</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">newInputNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">createElement</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">input</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">dialogNode</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">appendChild</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">newInputNode</span><span style="color:#C792EA">);</span></span></code></pre></div>
<p>This is not great because <em>conceptually</em> the <code>&lt;input&gt;</code> hasn’t been <em>replaced</em> with <code>&lt;p&gt;</code> — it just moved. We don’t want to lose its selection, focus state, and content due to re-creating the DOM.</p>
<p>While this problem has an easy fix (which we’ll get to in a minute), it doesn’t occur often in React applications. It’s interesting to see why.</p>
<p>In practice, you would rarely call <code>ReactDOM.render</code> directly. Instead, React apps tend to be broken down into functions like this:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Form</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ showMessage }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">message</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F87086">null</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">showMessage</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    message </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">I was just added here!</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">dialog</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">message</span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">input</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">dialog</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>This example doesn’t suffer from the problem we just described. It might be easier to see why if we use object notation instead of JSX. Look at the <code>dialog</code> child element tree:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Form</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ showMessage }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">message</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F87086">null</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">showMessage</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    message </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      type</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">p</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#CED2D6">      props</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> children</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">I was just added here!</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    type</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">dialog</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#CED2D6">    props</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      children</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">        message</span><span style="color:#C792EA">,</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">        </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> type</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">input</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> props</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{}</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">}</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">]</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><strong>Regardless of whether <code>showMessage</code> is <code>true</code> or <code>false</code>, the <code>&lt;input&gt;</code> is the second child and doesn’t change its tree position between renders.</strong></p>
<p>If <code>showMessage</code> changes from <code>false</code> to <code>true</code>, React would walk the element tree, comparing it with the previous version:</p>
<ul>
<li><code>dialog → dialog</code>: Can reuse the host instance? <strong>Yes — the type matches.</strong>
<ul>
<li><code>(null) → p</code>: Need to insert a new <code>p</code> host instance.</li>
<li><code>input → input</code>: Can reuse the host instance? <strong>Yes — the type matches.</strong></li>
</ul>
</li>
</ul>
<p>And the code executed by React would be similar to this:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">inputNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> dialogNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">firstChild</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">pNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">createElement</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">p</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">pNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">textContent </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">I was just added here!</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#FFA7C4">dialogNode</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">insertBefore</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">pNode</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> inputNode</span><span style="color:#C792EA">);</span></span></code></pre></div>
<p>No input state is lost now.</p>
<h2>Lists</h2>
<p>Comparing the element type at the same position in the tree is usually enough to decide whether to reuse or re-create the corresponding host instance.</p>
<p>But this only works well if child positions are static and don’t re-order. In our example above, even though <code>message</code> could be a “hole”, we still knew that the input goes after the message, and there are no other children.</p>
<p>With dynamic lists, we can’t be sure the order is ever the same:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">ShoppingList</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ list }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">form</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4">list</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">map</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">item </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">        </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">          You bought </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4">item</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">          </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">br</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">          Enter how many do you want: </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">input</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">))}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">form</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>If the <code>list</code> of our shopping items is ever re-ordered, React will see that all <code>p</code> and <code>input</code> elements inside have the same type, and won’t know to move them. (From React’s point of view, the <em>items themselves</em> changed, not their order.)</p>
<p>The code executed by React to re-order 10 items would be something like:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">for</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">i</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">0</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> i </span><span style="color:#C792EA">&lt;</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">10</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> i</span><span style="color:#C792EA">++)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">pNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> formNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">childNodes</span><span style="color:#C792EA">[</span><span style="color:#CED2D6">i</span><span style="color:#C792EA">];</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">textNode</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> pNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">firstChild</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">textNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">textContent </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">You bought </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> items</span><span style="color:#C792EA">[</span><span style="color:#CED2D6">i</span><span style="color:#C792EA">].</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>So instead of <em>re-ordering</em> them, React would effectively <em>update</em> each of them. This can create performance issues and possible bugs. For example, the content of the first input would stay reflected in first input <em>after</em> the sort — even though conceptually they might refer to different products in your shopping list!</p>
<p><strong>This is why React nags you to specify a special property called <code>key</code> every time you include an array of elements in your output:</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">ShoppingList</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ list }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">form</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4">list</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">map</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">item </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">        </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA"> key={</span><span style="color:#FFA7C4">item</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">productId</span><span style="color:#C792EA">}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">          You bought </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4">item</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">          </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">br</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">          Enter how many do you want: </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">input</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">))}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">form</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>A <code>key</code> tells React that it should consider an item to be <em>conceptually</em> the same even if it has different <em>positions</em> inside its parent element between renders.</p>
<p>When React sees <code>&lt;p key=&quot;42&quot;&gt;</code> inside a <code>&lt;form&gt;</code>, it will check if the previous render also contained <code>&lt;p key=&quot;42&quot;&gt;</code> inside the same <code>&lt;form&gt;</code>. This works even if <code>&lt;form&gt;</code> children changed their order. React will reuse the previous host instance with the same key if it exists, and re-order the siblings accordingly.</p>
<p>Note that the <code>key</code> is only relevant within a particular parent React element, such as a <code>&lt;form&gt;</code>. React won’t try to “match up” elements with the same keys between different parents. (React doesn’t have idiomatic support for moving a host instance between different parents without re-creating it.)</p>
<p>What’s a good value for a <code>key</code>? An easy way to answer this is to ask: <strong>when would <em>you</em> say an item is the “same” even if the order changed?</strong> For example, in our shopping list, the product ID uniquely identifies it between siblings.</p>
<h2>Components</h2>
<p>We’ve already seen functions that return React elements:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Form</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ showMessage }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">message</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F87086">null</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">showMessage</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    message </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">I was just added here!</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">dialog</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">message</span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">input</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">dialog</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>They are called <em>components</em>. They let us create our own “toolbox” of buttons, avatars, comments, and so on. Components are the bread and butter of React.</p>
<p>Components take one argument — an object hash. It contains “props” (short for “properties”). Here, <code>showMessage</code> is a prop. They’re like named arguments.</p>
<h2>Purity</h2>
<p>React components are assumed to be pure with respect to their props.</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Button</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// 🔴 Doesn&#x27;t work</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">isActive </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#F87086">true</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>In general, mutation is not idiomatic in React. (We’ll talk more about the idiomatic way to update the UI in response to events later.)</p>
<p>However, <em>local mutation</em> is absolutely fine:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">FriendList</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ friends }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">items</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[];</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">for</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">i</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">0</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> i </span><span style="color:#C792EA">&lt;</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">friends</span><span style="color:#C792EA">.</span><span style="color:#FFA7C4">length</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> i</span><span style="color:#C792EA">++)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">friend</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">friends</span><span style="color:#C792EA">[</span><span style="color:#CED2D6">i</span><span style="color:#C792EA">];</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">items</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">push</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Friend</span><span style="color:#C792EA"> key={</span><span style="color:#FFA7C4">friend</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">} friend={</span><span style="color:#CED2D6">friend</span><span style="color:#C792EA">} /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">section</span><span style="color:#C792EA">&gt;{</span><span style="color:#CED2D6">items</span><span style="color:#C792EA">}&lt;/</span><span style="color:#FFA7C4">section</span><span style="color:#C792EA">&gt;;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>We created <code>items</code> <em>while rendering</em> and no other component “saw” it so we can mutate it as much as we like before handing it off as part of the render result. There is no need to contort your code to avoid local mutation.</p>
<p>Similarly, lazy initialization is fine despite not being fully “pure”:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">ExpenseForm</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Fine if it doesn&#x27;t affect other components:</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">SuperCalculator</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">initializeIfNotReady</span><span style="color:#C792EA">();</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Continue rendering...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>As long as calling a component multiple times is safe and doesn’t affect the rendering of other components, React doesn’t care if it’s 100% pure in the strict FP sense of the word. <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://stackoverflow.com/questions/1077412/what-is-an-idempotent-operation">Idempotence</a> is more important to React than purity.</p>
<p>That said, side effects that are directly visible to the user are not allowed in React components. In other words, merely <em>calling</em> a component function shouldn’t by itself produce a change on the screen.</p>
<h2>Recursion</h2>
<p>How do we <em>use</em> components from other components? Components are functions so we <em>could</em> call them:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">reactElement</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">Form</span><span style="color:#C792EA">({</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">showMessage</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#F87086">true</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">reactElement</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> domContainer</span><span style="color:#C792EA">);</span></span></code></pre></div>
<p>However, this is <em>not</em> the idiomatic way to use components in the React runtime.</p>
<p>Instead, the idiomatic way to use a component is with the same mechanism we’ve already seen before — React elements. <strong>This means that you don’t directly call the component function, but instead let React later do it for you</strong>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// { type: Form, props: { showMessage: true } }</span></span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">reactElement</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Form</span><span style="color:#C792EA"> showMessage={</span><span style="color:#F87086">true</span><span style="color:#C792EA">} /&gt;;</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">reactElement</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> domContainer</span><span style="color:#C792EA">);</span></span></code></pre></div>
<p>And somewhere inside React, your component will be called:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// Somewhere inside React</span></span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">type</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> reactElement</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">type</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Form</span></span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">props</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> reactElement</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// { showMessage: true }</span></span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">result</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">type</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Whatever Form returns</span></span></code></pre></div>
<p>Component function names are by convention capitalized. When the JSX transform sees <code>&lt;Form&gt;</code> rather than <code>&lt;form&gt;</code>, it makes the object <code>type</code> itself an identifier rather than a string:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">console</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">log</span><span style="color:#C792EA">(&lt;</span><span style="color:#FFA7C4">form</span><span style="color:#C792EA"> /&gt;.</span><span style="color:#CED2D6">type</span><span style="color:#C792EA">);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// &#x27;form&#x27; string</span></span>
<span data-line=""><span style="color:#FFA7C4">console</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">log</span><span style="color:#C792EA">(&lt;</span><span style="color:#FFA7C4">Form</span><span style="color:#C792EA"> /&gt;.</span><span style="color:#CED2D6">type</span><span style="color:#C792EA">);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Form function</span></span></code></pre></div>
<p>There is no global registration mechanism — we literally refer to <code>Form</code> by name when typing <code>&lt;Form /&gt;</code>. If <code>Form</code> doesn’t exist in local scope, you’ll see a JavaScript error just like you normally would with a bad variable name.</p>
<p><strong>Okay, so what does React do when an element type is a function? It calls your component, and asks what element <em>that</em> component wants to render.</strong></p>
<p>This process continues recursively and is described in more detail <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html">here</a>. In short, it looks like this:</p>
<ul>
<li><strong>You:</strong> <code>ReactDOM.render(&lt;App /&gt;, domContainer)</code></li>
<li><strong>React:</strong> Hey <code>App</code>, what do you render to?<!-- -->
<ul>
<li><code>App</code>: I render <code>&lt;Layout&gt;</code> with <code>&lt;Content&gt;</code> inside.</li>
</ul>
</li>
<li><strong>React:</strong> Hey <code>Layout</code>, what do you render to?<!-- -->
<ul>
<li><code>Layout</code>: I render my children in a <code>&lt;div&gt;</code>. My child was <code>&lt;Content&gt;</code> so I guess that goes into the <code>&lt;div&gt;</code>.</li>
</ul>
</li>
<li><strong>React:</strong> Hey <code>&lt;Content&gt;</code>, what do you render to?<!-- -->
<ul>
<li><code>Content</code>: I render an <code>&lt;article&gt;</code> with some text and a <code>&lt;Footer&gt;</code> inside.</li>
</ul>
</li>
<li><strong>React:</strong> Hey <code>&lt;Footer&gt;</code>, what do you render to?<!-- -->
<ul>
<li><code>Footer</code>: I render a <code>&lt;footer&gt;</code> with some more text.</li>
</ul>
</li>
<li><strong>React:</strong> Okay, here you go:</li>
</ul>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// Resulting DOM structure</span></span>
<span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">article</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    Some text</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">footer</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">some more text</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">footer</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">article</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p>This is why we say reconciliation is recursive. When React walks the element tree, it might meet an element whose <code>type</code> is a component. It will call it and keep descending down the tree of returned React elements. Eventually, we’ll run out of components, and React will know what to change in the host tree.</p>
<p>The same reconciliation rules we already discussed apply here too. If the <code>type</code> at the same position (as determined by index and optional <code>key</code>) changes, React will throw away the host instances inside, and re-create them.</p>
<h2>Inversion of Control</h2>
<p>You might be wondering: why don’t we just call components directly? Why write <code>&lt;Form /&gt;</code> rather than <code>Form()</code>?</p>
<p><strong>React can do its job better if it “knows” about your components rather than if it only sees the React element tree after recursively calling them.</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// 🔴 React has no idea Layout and Article exist.</span></span>
<span data-line=""><span style="color:#637777">// You&#x27;re calling them.</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">Layout</span><span style="color:#C792EA">({</span><span style="color:#CED2D6"> children</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Article</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">}),</span></span>
<span data-line=""><span style="color:#CED2D6">  domContainer</span></span>
<span data-line=""><span style="color:#C792EA">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// ✅ React knows Layout and Article exist.</span></span>
<span data-line=""><span style="color:#637777">// React calls them.</span></span>
<span data-line=""><span style="color:#FFA7C4">ReactDOM</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">render</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Layout</span><span style="color:#C792EA">&gt;&lt;</span><span style="color:#FFA7C4">Article</span><span style="color:#C792EA"> /&gt;&lt;/</span><span style="color:#FFA7C4">Layout</span><span style="color:#C792EA">&gt;,</span></span>
<span data-line=""><span style="color:#CED2D6">  domContainer</span></span>
<span data-line=""><span style="color:#C792EA">)</span></span></code></pre></div>
<p>This is a classic example of <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://en.wikipedia.org/wiki/Inversion_of_control">inversion of control</a>. There’s a few interesting properties we get by letting React take control of calling our components:</p>
<ul>
<li>
<p><strong>Components become more than functions.</strong> React can augment component functions with features like <em>local state</em> that are tied to the component identity in the tree. A good runtime provides fundamental abstractions that match the problem at hand. As we already mentioned, React is oriented specifically at programs that render UI trees and respond to interactions. If you called components directly, you’d have to build these features yourself.</p>
</li>
<li>
<p><strong>Component types participate in the reconciliation.</strong> By letting React call your components, you also tell it more about the conceptual structure of your tree. For example, when you move from rendering <code>&lt;Feed&gt;</code> to the <code>&lt;Profile&gt;</code> page, React won’t attempt to re-use host instances inside them — just like when you replace <code>&lt;button&gt;</code> with a <code>&lt;p&gt;</code>. All state will be gone — which is usually good when you render a conceptually different view. You wouldn’t want to preserve input state between <code>&lt;PasswordForm&gt;</code> and <code>&lt;MessengerChat&gt;</code> even if the <code>&lt;input&gt;</code> position in the tree accidentally “lines up” between them.</p>
</li>
<li>
<p><strong>React can delay the reconciliation.</strong> If React takes control over calling our components, it can do many interesting things. For example, it can let the browser do some work between the component calls so that re-rendering a large component tree <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html">doesn’t block the main thread</a>. Orchestrating this manually without reimplementing a large part of React is difficult.</p>
</li>
<li>
<p><strong>A better debugging story.</strong> If components are first-class citizens that the library is aware of, we can build <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/facebook/react-devtools">rich developer tools</a> for introspection in development.</p>
</li>
</ul>
<p>The last benefit to React calling your component functions is <em>lazy evaluation</em>. Let’s see what this means.</p>
<h2>Lazy Evaluation</h2>
<p>When we call functions in JavaScript, arguments are evaluated before the call:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// (2) This gets computed second</span></span>
<span data-line=""><span style="color:#8EACE3">eat</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// (1) This gets computed first</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">prepareMeal</span><span style="color:#C792EA">()</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span></code></pre></div>
<p>This is usually what JavaScript developers expect because JavaScript functions can have implicit side effects. It would be surprising if we called a function, but it wouldn’t execute until its result gets somehow “used” in JavaScript.</p>
<p>However, React components are <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="#purity">relatively</a> pure. There is absolutely no need to execute it if we know its result won’t get rendered on the screen.</p>
<p>Consider this component putting <code>&lt;Comments&gt;</code> inside a <code>&lt;Page&gt;</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Story</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ currentUser }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// return {</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">//   type: Page,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">//   props: {</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">//     user: currentUser,</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">//     children: { type: Comments, props: {} }</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">//   }</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// }</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Page</span><span style="color:#C792EA"> user={</span><span style="color:#CED2D6">currentUser</span><span style="color:#C792EA">}&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Comments</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">Page</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>The <code>Page</code> component can render the children given to it inside some <code>Layout</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Page</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ user</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> children }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Layout</span><span style="color:#C792EA">&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">children</span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">Layout</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><em>(<code>&lt;A&gt;&lt;B /&gt;&lt;/A&gt;</code> in JSX is the same as <code>&lt;A children={&lt;B /&gt;} /&gt;</code>.)</em></p>
<p>But what if it has an early exit condition?</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Page</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ user</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> children }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(!</span><span style="color:#FFA7C4">user</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">isLoggedIn</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">Please log in</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Layout</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">children</span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">Layout</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>If we called <code>Comments()</code> as a function, it would execute immediately regardless of whether <code>Page</code> wants to render them or not:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// {</span></span>
<span data-line=""><span style="color:#637777">//   type: Page,</span></span>
<span data-line=""><span style="color:#637777">//   props: {</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#637777">//     children: Comments() // Always runs!</span></span>
<span data-line=""><span style="color:#637777">//   }</span></span>
<span data-line=""><span style="color:#637777">// }</span></span>
<span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Page</span><span style="color:#C792EA">&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">{</span><span style="color:#8EACE3">Comments</span><span style="color:#C792EA">()}</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">Page</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p>But if we pass a React element, we don’t execute <code>Comments</code> ourselves at all:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// {</span></span>
<span data-line=""><span style="color:#637777">//   type: Page,</span></span>
<span data-line=""><span style="color:#637777">//   props: {</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#637777">//     children: { type: Comments }</span></span>
<span data-line=""><span style="color:#637777">//   }</span></span>
<span data-line=""><span style="color:#637777">// }</span></span>
<span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Page</span><span style="color:#C792EA">&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Comments</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">Page</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p>This lets React decide when and <em>whether</em> to call it. If our <code>Page</code> component ignores its <code>children</code> prop and renders
<code>&lt;h1&gt;Please log in&lt;/h1&gt;</code> instead, React won’t even attempt to call the <code>Comments</code> function. What’s the point?</p>
<p>This is good because it both lets us avoid unnecessary rendering work that would be thrown away, and makes the code less fragile. (We don’t care if <code>Comments</code> throws or not when the user is logged out — it won’t be called.)</p>
<h2>State</h2>
<p>We talked <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="#reconciliation">earlier</a> about identity and how an element’s conceptual “position” in the tree tells React whether to re-use a host instance or create a new one. Host instances can have all kinds of local state: focus, selection, input, etc. We want to preserve this state between updates that conceptually render the same UI. We also want to predictably destroy it when we render something conceptually different (such as moving from <code>&lt;SignupForm&gt;</code> to <code>&lt;MessengerChat&gt;</code>).</p>
<p><strong>Local state is so useful that React lets <em>your own</em> components have it too.</strong> Components are still functions but React augments them with features that are useful for UIs. Local state tied to the position in the tree is one of these features.</p>
<p>We call these features <em>Hooks</em>. For example, <code>useState</code> is a Hook.</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        Click me</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>It returns a pair of values: the current state and a function that updates it.</p>
<p>The <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Array_destructuring">array destructuring</a> syntax lets us give arbitrary names to our state variables. For example, I called this pair <code>count</code> and <code>setCount</code>, but it could’ve been <code>banana</code> and <code>setBanana</code>. In the text below, I will use <code>setState</code> to refer to the second value regardless of its actual name in the specific examples.</p>
<p><em>(You can learn more about <code>useState</code> and other Hooks provided by React <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-intro.html">here</a>.)</em></p>
<h2>Consistency</h2>
<p>Even if we want to split the reconciliation process itself into <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://www.youtube.com/watch?v=mDdgfyRB5kg">non-blocking</a> chunks of work, we should still perform the actual host tree operations in a single synchronous swoop. This way we can ensure that the user doesn’t see a half-updated UI, and that the browser doesn’t perform unnecessary layout and style recalculation for intermediate states that the user shouldn’t see.</p>
<p>This is why React splits all work into the “render phase” and the “commit phase”. <em>Render phase</em> is when React calls your components and performs reconciliation. It is safe to interrupt and <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html">in the future</a> will be asynchronous. <em>Commit phase</em> is when React touches the host tree. It is always synchronous.</p>
<h2>Memoization</h2>
<p>When a parent schedules an update by calling <code>setState</code>, by default React reconciles its whole child subtree. This is because React can’t know whether an update in the parent would affect the child or not, and by default, React opts to be consistent. This may sound very expensive but in practice, it’s not a problem for small and medium-sized subtrees.</p>
<p>When trees get too deep or wide, you can tell React to <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://en.wikipedia.org/wiki/Memoization">memoize</a> a subtree and reuse previous render results during shallow equal prop changes:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Row</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ item }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">export</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">default</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">React</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">memo</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">Row</span><span style="color:#C792EA">);</span></span></code></pre></div>
<p>Now <code>setState</code> in a parent <code>&lt;Table&gt;</code> component would skip over reconciling <code>Row</code>s whose <code>item</code> is referentially equal to the <code>item</code> rendered last time.</p>
<p>You can get fine-grained memoization at the level of individual expressions with the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-reference.html#usememo"><code>useMemo()</code> Hook</a>. The cache is local to component tree position and will be destroyed together with its local state. It only holds one last item.</p>
<p>React intentionally doesn’t memoize components by default. Many components always receive different props so memoizing them would be a net loss.</p>
<h2>Raw Models</h2>
<p>Ironically, React doesn’t use a “reactivity” system for fine-grained updates. In other words, any update at the top triggers reconciliation instead of updating just the components affected by changes.</p>
<p>This is an intentional design decision. <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://calibreapp.com/blog/time-to-interactive/">Time to interactive</a> is a crucial metric in consumer web applications, and traversing models to set up fine-grained listeners spends that precious time. Additionally, in many apps, interactions tend to result either in small (button hover) or large (page transition) updates, in which case fine-grained subscriptions are a waste of memory resources.</p>
<p>One of the core design principles of React is that it works with raw data. If you have a bunch of JavaScript objects received from the network, you can pump them directly into your components with no preprocessing. There are no gotchas about which properties you can access, or unexpected performance cliffs when a structure slightly changes. React rendering is O(<em>view size</em>) rather than O(<em>model size</em>), and you can significantly cut the <em>view size</em> with <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://react-window.now.sh/#/examples/list/fixed-size">windowing</a>.</p>
<p>There are some kinds of applications where fine-grained subscriptions are beneficial — such as stock tickers. This is a rare example of “everything constantly updating at the same time”. While imperative escape hatches can help optimize such code, React might not be the best fit for this use case. Still, you can implement your own fine-grained subscription system on top of React.</p>
<p><strong>Note that there are common performance issues that even fine-grained subscriptions and “reactivity” systems can’t solve.</strong> For example, rendering a <em>new</em> deep tree (which happens on every page transition) without blocking the browser. Change tracking doesn’t make it faster — it makes it slower because we have to do more work to set up subscriptions. Another problem is that we have to wait for data before we can start rendering the view. In React, we aim to solve both of these problems with <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html">Concurrent Rendering</a>.</p>
<h2>Batching</h2>
<p>Several components may want to update state in response to the same event. This example is contrived but it illustrates a common pattern:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Parent</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      Parent clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Child</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Child</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      Child clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>When an event is dispatched, the child’s <code>onClick</code> fires first (triggering its <code>setState</code>). Then the parent calls <code>setState</code> in its own <code>onClick</code> handler.</p>
<p>If React immediately re-rendered components in response to <code>setState</code> calls, we’d end up rendering the child twice:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#C792EA">***</span><span style="color:#CED2D6"> Entering React</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">s browser click event handler **</span><span style="color:#CED2D6">*</span></span>
<span data-line=""><span style="color:#8EACE3">Child</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">onClick</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> setState</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> re</span><span style="color:#C792EA">-</span><span style="color:#CED2D6">render Child </span><span style="color:#637777">// 😞 unnecessary</span></span>
<span data-line=""><span style="color:#8EACE3">Parent</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">onClick</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> setState</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> re</span><span style="color:#C792EA">-</span><span style="color:#CED2D6">render Parent</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> re</span><span style="color:#C792EA">-</span><span style="color:#CED2D6">render Child</span></span>
<span data-line=""><span style="color:#C792EA">***</span><span style="color:#CED2D6"> Exiting React</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">s browser click event handler **</span><span style="color:#CED2D6">*</span></span></code></pre></div>
<p>The first <code>Child</code> render would be wasted. And we couldn’t make React skip rendering <code>Child</code> for the second time because the <code>Parent</code> might pass some different data to it based on its updated state.</p>
<p><strong>This is why React batches updates inside event handlers:</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#C792EA">***</span><span style="color:#CED2D6"> Entering React</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">s browser click event handler **</span><span style="color:#CED2D6">*</span></span>
<span data-line=""><span style="color:#8EACE3">Child</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">onClick</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> setState</span></span>
<span data-line=""><span style="color:#8EACE3">Parent</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">onClick</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> setState</span></span>
<span data-line=""><span style="color:#C792EA">***</span><span style="color:#CED2D6"> Processing state updates                     </span><span style="color:#C792EA">***</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> re</span><span style="color:#C792EA">-</span><span style="color:#CED2D6">render Parent</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">-</span><span style="color:#CED2D6"> re</span><span style="color:#C792EA">-</span><span style="color:#CED2D6">render Child</span></span>
<span data-line=""><span style="color:#C792EA">***</span><span style="color:#CED2D6"> Exiting React</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">s browser click event handler  **</span><span style="color:#CED2D6">*</span></span></code></pre></div>
<p>The <code>setState</code> calls in components wouldn’t immediately cause a re-render. Instead, React would execute all event handlers first, and then trigger a single re-render batching all of those updates together.</p>
<p>Batching is good for performance but can be surprising if you write code like:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">increment</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">increment</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">increment</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">increment</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>If we start with <code>count</code> set to <code>0</code>, these would just be three <code>setCount(1)</code> calls. To fix this, <code>setState</code> provides an overload that accepts an “updater” function:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">increment</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">c </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> c </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">increment</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">increment</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">increment</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>React would put the updater functions in a queue, and later run them in sequence, resulting in a re-render with <code>count</code> set to <code>3</code>.</p>
<p>When state logic gets more complex than a few <code>setState</code> calls, I recommend expressing it as a local state reducer with the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-reference.html#usereducer"><code>useReducer</code> Hook</a>. It’s like an evolution of this “updater” pattern where each update is given a name:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">counter</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">dispatch</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useReducer</span><span style="color:#C792EA">((</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">action</span><span style="color:#C792EA">)</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">if</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">action</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">===</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">increment</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#FFA7C4">      return </span><span style="color:#CED2D6">state</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">}</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">else</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#FFA7C4">      return </span><span style="color:#CED2D6">state</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#FFA7C4">  </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">dispatch</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">increment</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">dispatch</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">increment</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">dispatch</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">increment</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>The <code>action</code> argument can be anything, although an object is a common choice.</p>
<h2>Call Tree</h2>
<p>A programming language runtime usually has a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://medium.freecodecamp.org/understanding-the-javascript-call-stack-861e41ae61d4">call stack</a>. When a function <code>a()</code> calls <code>b()</code> which itself calls <code>c()</code>, somewhere in the JavaScript engine there’s a data structure like <code>[a, b, c]</code> that “keeps track” of where you are and what code to execute next. Once you exit out of <code>c</code>, its call stack frame is gone — poof! It’s not needed anymore. We jump back into <code>b</code>. By the time we exit <code>a</code>, the call stack is empty.</p>
<p>Of course, React itself runs in JavaScript and obeys JavaScript rules. But we can imagine that internally React has some kind of its own call stack to remember which component we are currently rendering, e.g. <code>[App, Page, Layout, Article /* we&#x27;re here */]</code>.</p>
<p>React is different from a general purpose language runtime because it’s aimed at rendering UI trees. These trees need to “stay alive” for us to interact with them. The DOM doesn’t disappear after our first <code>ReactDOM.render()</code> call.</p>
<p>This may be stretching the metaphor but I like to think of React components as being in a “call tree” rather than just a “call stack”. When we go “out” of the <code>Article</code> component, its React “call tree” frame doesn’t get destroyed. We need to keep the local state and references to the host instances <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://medium.com/react-in-depth/the-how-and-why-on-reacts-usage-of-linked-list-in-fiber-67f1014d0eb7">somewhere</a>.</p>
<p>These “call tree” frames <em>are</em> destroyed along with their local state and host instances, but only when the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="#reconciliation">reconciliation</a> rules say it’s necessary. If you ever read React source, you might have seen these frames being referred to as <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://en.wikipedia.org/wiki/Fiber_(computer_science)">Fibers</a>.</p>
<p>Fibers are where the local state actually lives. When the state is updated, React marks the Fibers below as needing reconciliation, and calls those components.</p>
<h2>Context</h2>
<p>In React, we pass things down to other components as props. Sometimes, the majority of components need the same thing — for example, the currently chosen visual theme. It gets cumbersome to pass it down through every level.</p>
<p>In React, this is solved by <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/context.html">Context</a>. It is essentially like <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="http://wiki.c2.com/?DynamicScoping">dynamic scoping</a> for components. It’s like a wormhole that lets you put something on the top, and have every child at the bottom be able to read it and re-render when it changes.</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">ThemeContext</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> React</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">createContext</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#FFA7C4">  </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">light</span><span style="color:#C792EA">&#x27;</span><span style="color:#FFA7C4"> </span><span style="color:#637777">// Default value as a fallback</span></span>
<span data-line=""><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">DarkApp</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">ThemeContext.Provider</span><span style="color:#C792EA"> value=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">dark</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">MyComponents</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">ThemeContext.Provider</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SomeDeeplyNestedChild</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Depends on where the child is rendered</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">theme</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useContext</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">ThemeContext</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>When <code>SomeDeeplyNestedChild</code> renders, <code>useContext(ThemeContext)</code> will look for the closest <code>&lt;ThemeContext.Provider&gt;</code> above it in the tree, and use its <code>value</code>.</p>
<p>(In practice, React maintains a context stack while it renders.)</p>
<p>If there’s no <code>ThemeContext.Provider</code> above, the result of <code>useContext(ThemeContext)</code> call will be the default value specified in the <code>createContext()</code> call. In our example, it is <code>&#x27;light&#x27;</code>.</p>
<h2>Effects</h2>
<p>We mentioned earlier that React components shouldn’t have observable side effects during rendering. But side effects are sometimes necessary. We may want to manage focus, draw on a canvas, subscribe to a data source, and so on.</p>
<p>In React, this is done by declaring an effect:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#CED2D6">count</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        Click me</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>When possible, React defers executing effects until after the browser re-paints the screen. This is good because code like data source subscriptions shouldn’t hurt <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://calibreapp.com/blog/time-to-interactive/">time to interactive</a> and <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://developers.google.com/web/tools/lighthouse/audits/first-meaningful-paint">time to first paint</a>. (There’s a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-reference.html#uselayouteffect">rarely used</a> Hook that lets you opt out of that behavior and do things synchronously. Avoid it.)</p>
<p>Effects don’t just run once. They run both after a component is shown to the user for the first time, and after it updates. Effects can close over current props and state, such as with <code>count</code> in the above example.</p>
<p>Effects may require cleanup, such as in case of subscriptions. To clean up after itself, an effect can return a function:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">DataSource</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">addSubscription</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">handleChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">DataSource</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">removeSubscription</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">handleChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span></code></pre></div>
<p>React will execute the returned function before applying this effect the next time, and also before the component is destroyed.</p>
<p>Sometimes, re-running the effect on every render can be undesirable. You can tell React to <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects">skip</a> applying an effect if certain variables didn’t change:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#CED2D6">count</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">]);</span></span></code></pre></div>
<p>However, it is often a premature optimization and can lead to problems if you’re not familiar with how JavaScript closures work.</p>
<p>For example, this code is buggy:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">DataSource</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">addSubscription</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">handleChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">DataSource</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">removeSubscription</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">handleChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span></span></code></pre></div>
<p>It is buggy because <code>[]</code> says “don’t ever re-execute this effect”. But the effect closes over <code>handleChange</code> which is defined outside of it. And <code>handleChange</code> might reference any props or state:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleChange</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">console</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">log</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>If we never let the effect re-run, <code>handleChange</code> will keep pointing at the version from the first render, and <code>count</code> will always be <code>0</code> inside of it.</p>
<p>To solve this, make sure that if you specify the dependency array, it includes <strong>all</strong> things that can change, including the functions:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">DataSource</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">addSubscription</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">handleChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">DataSource</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">removeSubscription</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">handleChange</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">handleChange</span><span style="color:#C792EA">]);</span></span></code></pre></div>
<p>Depending on your code, you might still see unnecessary resubscriptions because <code>handleChange</code> itself is different on every render. The <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-reference.html#usecallback"><code>useCallback</code></a> Hook can help you with that. Alternatively, you can just let it re-subscribe. For example, browser’s <code>addEventListener</code> API is extremely fast, and jumping through hoops to avoid calling it might cause more problems than it’s worth.</p>
<p><em>(You can learn more about <code>useEffect</code> and other Hooks provided by React <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-effect.html">here</a>.)</em></p>
<h2>Custom Hooks</h2>
<p>Since Hooks like <code>useState</code> and <code>useEffect</code> are function calls, we can compose them into our own Hooks:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">MyResponsiveComponent</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">width</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useWindowWidth</span><span style="color:#C792EA">();</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Our custom Hook</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">Window width is </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">width</span><span style="color:#C792EA">}&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">useWindowWidth</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">width</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setWidth</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">window</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">innerWidth</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#8EACE3">handleResize</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#8EACE3">setWidth</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">window</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">innerWidth</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">window</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">addEventListener</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">resize</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> handleResize</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">window</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">removeEventListener</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">resize</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> handleResize</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> width</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Custom Hooks let different components share reusable stateful logic. Note that the <em>state itself</em> is not shared. Each call to a Hook declares its own isolated state.</p>
<p><em>(You can learn more about writing your own Hooks <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-custom.html">here</a>.)</em></p>
<h2>Static Use Order</h2>
<p>You can think of <code>useState</code> as a syntax for defining a “React state variable”. It’s not <em>really</em> a syntax, of course. We’re still writing JavaScript. But we are looking at React as a runtime environment, and because React tailors JavaScript to describing UI trees, its features sometimes live closer to the language space.</p>
<p>If <code>use</code> <em>were</em> a syntax, it would make sense for it to be at the top level:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// 😉 Note: not a real syntax</span></span>
<span data-line=""><span style="color:#CED2D6">component </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">use</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">State</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        Click me</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>What would putting it into a condition or a callback or outside a component even mean?</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// 😉 Note: not a real syntax</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// This is local state... of what?</span></span>
<span data-line=""><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">use</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">State</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">component </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">condition</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// What happens to it when condition is false?</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">use</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">State</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// What happens to it when we leave a function?</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// How is this different from a variable?</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">use</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">State</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>React state is local to the <em>component</em> and its identity in the tree. If <code>use</code> were a real syntax it would make sense to scope it to the top-level of a component too:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// 😉 Note: not a real syntax</span></span>
<span data-line=""><span style="color:#CED2D6">component </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Only valid here</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">use</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">State</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">condition</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// This would be a syntax error</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">use</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">State</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>This is similar to how <code>import</code> only works at the top level of a module.</p>
<p><strong>Of course, <code>use</code> is not actually a syntax.</strong> (It wouldn’t bring much benefit and would create a lot of friction.)</p>
<p>However, React <em>does</em> expect that all calls to Hooks happen only at the top level of a component and unconditionally. These <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-rules.html">Rules of Hooks</a> can be enforced with <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://www.npmjs.com/package/eslint-plugin-react-hooks">a linter plugin</a>. There have been heated arguments about this design choice but in practice, I haven’t seen it confusing people. I also wrote about why commonly proposed alternatives <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://overreacted.io/why-do-hooks-rely-on-call-order/">don’t work</a>.</p>
<p>Internally, Hooks are implemented as <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://dev.to/aspittel/thank-u-next-an-introduction-to-linked-lists-4pph">linked lists</a>. When you call <code>useState</code>, we move the pointer to the next item. When we exit the component’s <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="#call-tree">“call tree” frame</a>, we save the resulting list there until the next render.</p>
<p><a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e">This article</a> provides a simplified explanation for how Hooks work internally. Arrays might be an easier mental model than linked lists:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// Pseudocode</span></span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">hooks</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">i</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  i</span><span style="color:#C792EA">++;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">hooks</span><span style="color:#C792EA">[</span><span style="color:#CED2D6">i</span><span style="color:#C792EA">])</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Next renders</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> hooks</span><span style="color:#C792EA">[</span><span style="color:#CED2D6">i</span><span style="color:#C792EA">];</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// First render</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">hooks</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">push</span><span style="color:#C792EA">(...);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// Prepare to render</span></span>
<span data-line=""><span style="color:#CED2D6">i </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">-</span><span style="color:#F78C6C">1</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">hooks </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">fiber</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">hooks </span><span style="color:#C792EA">||</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[];</span></span>
<span data-line=""><span style="color:#637777">// Call the component</span></span>
<span data-line=""><span style="color:#8EACE3">YourComponent</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#637777">// Remember the state of Hooks</span></span>
<span data-line=""><span style="color:#FFA7C4">fiber</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">hooks </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> hooks</span><span style="color:#C792EA">;</span></span></code></pre></div>
<p><em>(If you’re curious, the real code is <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/facebook/react/blob/master/packages/react-reconciler/src/ReactFiberHooks.new.js">here</a>.)</em></p>
<p>This is roughly how each <code>useState()</code> call gets the right state. As we’ve learned <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="#reconciliation">earlier</a>, “matching things up” isn’t new to React — reconciliation relies on the elements matching up between renders in a similar way.</p>
<h2>What’s Left Out</h2>
<p>We’ve touched on pretty much all important aspects of the React runtime environment. If you finished this page, you probably know React in more detail than 90% of its users. And there’s nothing wrong with that!</p>
<p>There are some parts I left out — mostly because they’re unclear even to us. React doesn’t currently have a good story for multipass rendering, i.e. when the parent render needs information about the children. Also, the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/error-boundaries.html">error handling API</a> doesn’t yet have a Hooks version. It’s possible that these two problems can be solved together. Concurrent Mode is not stable yet, and there are interesting questions about how Suspense fits into this picture. Maybe I’ll do a follow-up when they’re fleshed out and Suspense is ready for more than <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/blog/2018/10/23/react-v-16-6.html#reactlazy-code-splitting-with-suspense">lazy loading</a>.</p>
<p><strong>I think it speaks to the success of React’s API that you can get very far without ever thinking about most of these topics.</strong> Good defaults like the reconciliation heuristics do the right thing in most cases. Warnings, like the <code>key</code> warning, nudge you when you risk shooting yourself in the foot.</p>
<p>If you’re a UI library nerd, I hope this post was somewhat entertaining and clarified how React works in more depth. Or maybe you decided React is too complicated and you’ll never look at it again. In either case, I’d love to hear from you on Twitter! Thank you for reading.</p><hr/><p><a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://x.com/search?q=https%3A%2F%2Foverreacted.io%2Freact-as-a-ui-runtime%2F">Discuss on 𝕏</a>  ·  <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/gaearon/overreacted.io/edit/main/public/react-as-a-ui-runtime/index.md">Edit on GitHub</a></p></div></article><footer class="mt-12"><a class="__className_b47211 inline-block text-2xl font-black hover:scale-[1.02] scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/"><span style="--myColor1:var(--pink);--myColor2:var(--purple);background-image:linear-gradient(45deg, var(--myColor1), var(--myColor2));background-clip:text;-webkit-background-clip:text;color:transparent;transition:--myColor1 0.2s ease-out, --myColor2 0.2s ease-in-out">overreacted</span></a></footer></main><script src="/_next/static/chunks/webpack-fdca05b8968262b2.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/0f6647b39fdbcb3d.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/3c6c21fa7f32edf2.css\",\"style\",{\"crossOrigin\":\"\"}]\n4:HL[\"/_next/static/css/f9d4d708579596e8.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[3728,[],\"\"]\n7:I[9928,[],\"\"]\n8:I[4982,[\"569\",\"static/chunks/569-52e5d813bbfa85ea.js\",\"185\",\"static/chunks/app/layout-cfb37acb14684668.js\"],\"\"]\n9:I[8256,[\"569\",\"static/chunks/569-52e5d813bbfa85ea.js\",\"64\",\"static/chunks/app/%5Bslug%5D/layout-d3e08fbfdc858bf2.js\"],\"\"]\na:I[2008,[\"569\",\"static/chunks/569-52e5d813bbfa85ea.js\",\"42\",\"static/chunks/app/%5Bslug%5D/page-798073576b23f3f1.js\"],\"\"]\nb:I[6954,[],\"\"]\nc:I[7264,[],\"\"]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0f6647b39fdbcb3d.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"iWWiOWlg3tDiHen4DuUO-\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/react-as-a-ui-runtime/\",\"initialTree\":[\"\",{\"children\":[[\"slug\",\"react-as-a-ui-runtime\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"react-as-a-ui-runtime\\\"}\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L6\"],\"globalErrorComponent\":\"$7\",\"children\":[null,[\"$\",\"$L8\",null,{\"children\":[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__className_e34cb4\",\"children\":[\"$\",\"body\",null,{\"className\":\"mx-auto max-w-2xl bg-[--bg] px-5 py-12 text-[--text]\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-14 flex flex-row place-content-between\",\"children\":[[\"$\",\"$L9\",null,{}],[\"$\",\"span\",null,{\"className\":\"relative top-[4px] italic\",\"children\":[\"by\",\" \",[\"$\",\"$La\",null,{\"href\":\"https://danabra.mov\",\"target\":\"_blank\",\"children\":[\"$\",\"img\",null,{\"alt\":\"Dan Abramov\",\"src\":\"https://github.com/gaearon.png\",\"className\":\"relative -top-1 mx-1 inline h-8 w-8 rounded-full\"}]}]]}]]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"article\",null,{\"className\":\"markdown\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"__className_b47211 text-[40px] font-black leading-[44px] text-[--title]\",\"children\":\"Not found\"}],[\"$\",\"div\",null,{\"className\":\"markdown mt-10\",\"children\":[[\"$\",\"p\",null,{\"children\":\"This page doesn't exist (yet?)\"}],[\"$\",\"p\",null,{\"children\":[\"I recently rewrote the site so maybe something broke. Please\",\" \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/gaearon/overreacted.io/issues/796\",\"children\":\"complain here.\"}]]}],[\"$\",\"p\",null,{\"children\":[\"If you're looking for translated posts, they're not on the site anymore but you can find\",\" \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/gaearon/overreacted.io/tree/archive/src/pages\",\"children\":\"an archive of them here.\"}]]}],[\"$\",\"p\",null,{\"children\":\"Hope you'll find what you're looking for.\"}]]}]]}],\"notFoundStyles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f9d4d708579596e8.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],\"childProp\":{\"current\":[null,[[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",[\"slug\",\"react-as-a-ui-runtime\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Ld\",\"$Le\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"react-as-a-ui-runtime\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f9d4d708579596e8.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}],[\"$\",\"footer\",null,{\"className\":\"mt-12\",\"children\":[\"$\",\"$L9\",null,{}]}]],null],\"segment\":[\"slug\",\"react-as-a-ui-runtime\",\"d\"]},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3c6c21fa7f32edf2.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]}]]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"article\",null,{\"children\":[[\"$\",\"h1\",null,{\"className\":\"__className_b47211 text-[40px] font-black leading-[44px] text-[--title]\",\"children\":\"React as a UI Runtime\"}],[\"$\",\"p\",null,{\"className\":\"mt-2 text-[13px] text-gray-700 dark:text-gray-300\",\"children\":\"February 2, 2019\"}],[\"$\",\"div\",null,{\"className\":\"markdown mt-10\",\"children\":[\"$Lf\",[\"$\",\"hr\",null,{}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"$La\",null,{\"href\":\"https://x.com/search?q=https%3A%2F%2Foverreacted.io%2Freact-as-a-ui-runtime%2F\",\"children\":\"Discuss on 𝕏\"}],\"  ·  \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/gaearon/overreacted.io/edit/main/public/react-as-a-ui-runtime/index.md\",\"children\":\"Edit on GitHub\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"6:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"React as a UI Runtime — overreacted\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"An in-depth description of the React programming model.\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/icon.png?e0852c1e2c7f0e65\",\"type\":\"image/png\",\"sizes\":\"329x329\"}]]\nd:null\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"p\",null,{\"children\":[\"Most tutorials introduce React as a UI library. This makes sense because React \",[\"$\",\"em\",null,{\"children\":\"is\"}],\" a UI library. That’s literally what the tagline says!\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./react.png\",\"alt\":\"React homepage screenshot: \\\"A JavaScript library for building user interfaces\\\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I’ve written about the challenges of creating \",[\"$\",\"$La\",null,{\"href\":\"/the-elements-of-ui-engineering/\",\"children\":\"user interfaces\"}],\" before. But this post talks about React in a different way — more as a \",[\"$\",\"$La\",null,{\"href\":\"https://en.wikipedia.org/wiki/Runtime_system\",\"children\":\"programming runtime\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"This post won’t teach you anything about creating user interfaces.\"}],\" But it might help you understand the React programming model in more depth.\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"Note: If you’re \",[\"$\",\"em\",null,{\"children\":\"learning\"}],\" React, check out \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/getting-started.html#learn-react\",\"children\":\"the docs\"}],\" instead.\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"font\",null,{\"size\":\"60\",\"children\":\"⚠️\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"This is a deep dive — THIS IS NOT a beginner-friendly post.\"}],\" In this post, I’m describing most of the React programming model from first principles. I don’t explain how to use it — just how it works.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"It’s aimed at experienced programmers and folks working on other UI libraries who asked about some tradeoffs chosen in React. I hope you’ll find it useful!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Many people successfully use React for years without thinking about most of these topics.\"}],\" This is definitely a programmer-centric view of React rather than, say, a \",[\"$\",\"$La\",null,{\"href\":\"http://mrmrs.cc/writing/developing-ui/\",\"children\":\"designer-centric one\"}],\". But I don’t think it hurts to have resources for both.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"With that disclaimer out of the way, let’s go!\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Host Tree\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Some programs output numbers. Other programs output poems. Different languages and their runtimes are often optimized for a particular set of use cases, and React is no exception to that.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"React programs usually output \",[\"$\",\"strong\",null,{\"children\":\"a tree that may change over time\"}],\". It might be a \",[\"$\",\"$La\",null,{\"href\":\"https://www.npmjs.com/package/react-dom\",\"children\":\"DOM tree\"}],\", an \",[\"$\",\"$La\",null,{\"href\":\"https://developer.apple.com/library/archive/documentation/General/Conceptual/Devpedia-CocoaApp/View%20Hierarchy.html\",\"children\":\"iOS hierarchy\"}],\", a tree of \",[\"$\",\"$La\",null,{\"href\":\"https://react-pdf.org/\",\"children\":\"PDF primitives\"}],\", or even of \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/test-renderer.html\",\"children\":\"JSON objects\"}],\". However, usually, we want to represent some UI with it. We’ll call it a “\",[\"$\",\"em\",null,{\"children\":\"host\"}],\" tree” because it is a part of the \",[\"$\",\"em\",null,{\"children\":\"host environment\"}],\" outside of React — like DOM or iOS. The host tree usually has \",[\"$\",\"$La\",null,{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild\",\"children\":\"its\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"https://developer.apple.com/documentation/uikit/uiview/1622616-addsubview\",\"children\":\"own\"}],\" imperative API. React is a layer on top of it.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So what is React useful for? Very abstractly, it helps you write a program that predictably manipulates a complex host tree in response to external events like interactions, network responses, timers, and so on.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A specialized tool works better than a generic one when it can impose and benefit from particular constraints. React makes a bet on two principles:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Stability.\"}],\" The host tree is relatively stable and most updates don’t radically change its overall structure. If an app rearranged all its interactive elements into a completely different combination every second, it would be difficult to use. Where did that button go? Why is my screen dancing?\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Regularity.\"}],\" The host tree can be broken down into UI patterns that look and behave consistently (such as buttons, lists, avatars) rather than random shapes.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"These principles happen to be true for most UIs.\"}],\" However, React is ill-suited when there are no stable “patterns” in the output. For example, React may help you write a Twitter client but won’t be very useful for a \",[\"$\",\"$La\",null,{\"href\":\"https://www.youtube.com/watch?v=Uzx9ArZ7MUU\",\"children\":\"3D pipes screensaver\"}],\".\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Host Instances\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The host tree consists of nodes. We’ll call them “host instances”.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In the DOM environment, host instances are regular DOM nodes — like the objects you get when you call \",[\"$\",\"code\",null,{\"children\":\"document.createElement('div')\"}],\". On iOS, host instances could be values uniquely identifying a native view from JavaScript.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Host instances have their own properties (e.g. \",[\"$\",\"code\",null,{\"children\":\"domNode.className\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"view.tintColor\"}],\"). They may also contain other host instances as children.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"(This has nothing to do with React — I’m describing the host environments.)\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"There is usually an API to manipulate host instances. For example, the DOM provides APIs like \",[\"$\",\"code\",null,{\"children\":\"appendChild\"}],\", \",[\"$\",\"code\",null,{\"children\":\"removeChild\"}],\", \",[\"$\",\"code\",null,{\"children\":\"setAttribute\"}],\", and so on. In React apps, you usually don’t call these APIs. That’s the job of React.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Renderers\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A \",[\"$\",\"em\",null,{\"children\":\"renderer\"}],\" teaches React to talk to a specific host environment and manage its host instances. React DOM, React Native, and even \",[\"$\",\"$La\",null,{\"href\":\"https://mobile.twitter.com/vadimdemedes/status/1089344289102942211\",\"children\":\"Ink\"}],\" are React renderers. You can also \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/facebook/react/tree/master/packages/react-reconciler\",\"children\":\"create your own React renderer\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"React renderers can work in one of two modes.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The vast majority of renderers are written to use the “mutating” mode. This mode is how the DOM works: we can create a node, set its properties, and later add or remove children from it. The host instances are completely mutable.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"React can also work in a \",[\"$\",\"$La\",null,{\"href\":\"https://en.wikipedia.org/wiki/Persistent_data_structure\",\"children\":\"“persistent”\"}],\" mode. This mode is for host environments that don’t provide methods like \",[\"$\",\"code\",null,{\"children\":\"appendChild()\"}],\" but instead clone the parent tree and always replace the top-level child. Immutability on the host tree level makes multi-threading easier. \",[\"$\",\"$La\",null,{\"href\":\"https://facebook.github.io/react-native/blog/2018/06/14/state-of-react-native-2018\",\"children\":\"React Fabric\"}],\" takes advantage of that.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"As a React user, you never need to think about these modes. I only want to highlight that React isn’t just an adapter from one mode to another. Its usefulness is orthogonal to the target low-level view API paradigm.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"React Elements\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In the host environment, a host instance (like a DOM node) is the smallest building block. In React, the smallest building block is a \",[\"$\",\"em\",null,{\"children\":\"React element\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A React element is a plain JavaScript object. It can \",[\"$\",\"em\",null,{\"children\":\"describe\"}],\" a host instance.\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// JSX is a syntax sugar for these objects.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// \u003cbutton className=\\\"blue\\\" /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  type: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  props: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" className: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"blue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A React element is lightweight and has no host instance tied to it. Again, it is merely a \",[\"$\",\"em\",null,{\"children\":\"description\"}],\" of what you want to see on the screen.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Like host instances, React elements can form a tree:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// JSX is a syntax sugar for these objects.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// \u003cdialog\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   \u003cbutton className=\\\"blue\\\" /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   \u003cbutton className=\\\"red\\\" /\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// \u003c/dialog\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  type: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  props: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    children: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"blue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"red\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(Note: I omitted \",[\"$\",\"$La\",null,{\"href\":\"/why-do-react-elements-have-typeof-property/\",\"children\":\"some properties\"}],\" that aren’t important to this explanation.)\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, remember that \",[\"$\",\"strong\",null,{\"children\":\"React elements don’t have their own persistent identity.\"}],\" They’re meant to be re-created and thrown away all the time.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"React elements are immutable. For example, you can’t change the children or a property of a React element. If you want to render something different later, you will \",[\"$\",\"em\",null,{\"children\":\"describe\"}],\" it with a new React element tree created from scratch.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I like to think of React elements as being like frames in a movie. They capture what the UI should look like at a specific point in time. They don’t change.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Entry Point\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Each React renderer has an “entry point”. It’s the API that lets us tell React to render a particular React element tree inside a container host instance.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"For example, React DOM entry point is \",[\"$\",\"code\",null,{\"children\":\"ReactDOM.render\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// { type: 'button', props: { className: 'blue' } }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"blue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getElementById\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"container\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When we say \",[\"$\",\"code\",null,{\"children\":\"ReactDOM.render(reactElement, domContainer)\"}],\", we mean: \",[\"$\",\"strong\",null,{\"children\":[\"“Dear React, make the \",[\"$\",\"code\",null,{\"children\":\"domContainer\"}],\" host tree match my \",[\"$\",\"code\",null,{\"children\":\"reactElement\"}],\".”\"]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"React will look at the \",[\"$\",\"code\",null,{\"children\":\"reactElement.type\"}],\" (in our example, \",[\"$\",\"code\",null,{\"children\":\"'button'\"}],\") and ask the React DOM renderer to create a host instance for it and set the properties:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Somewhere in the ReactDOM renderer (simplified)\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"createHostInstance\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"createElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"className \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In our example, effectively React will do this:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"createElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"className \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"blue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"domContainer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"appendChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If the React element has child elements in \",[\"$\",\"code\",null,{\"children\":\"reactElement.props.children\"}],\", React will recursively create host instances for them too on the first render.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Reconciliation\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"What happens if we call \",[\"$\",\"code\",null,{\"children\":\"ReactDOM.render()\"}],\" twice with the same container?\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"blue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getElementById\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"container\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... later ...\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Should this *replace* the button host instance\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// or merely update a property on an existing one?\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"red\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getElementById\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"container\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Again, React’s job is to \",[\"$\",\"em\",null,{\"children\":\"make the host tree match the provided React element tree\"}],\". The process of figuring out \",[\"$\",\"em\",null,{\"children\":\"what\"}],\" to do to the host instance tree in response to new information is sometimes called \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/reconciliation.html\",\"children\":\"reconciliation\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"There are two ways to go about it. A simplified version of React could blow away the existing tree and re-create it from scratch:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"domContainer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getElementById\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"container\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Clear the tree\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"domContainer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"innerHTML \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"''\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Create the new host instance tree\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"createElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"className \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"red\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"domContainer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"appendChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"But in DOM, this is slow and loses important information like focus, selection, scroll state, and so on. Instead, we want React to do something like this:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" domContainer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"firstChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Update existing host instance\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"className \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"red\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In other words, React needs to decide when to \",[\"$\",\"em\",null,{\"children\":\"update\"}],\" an existing host instance to match a new React element, and when to create a \",[\"$\",\"em\",null,{\"children\":\"new\"}],\" one.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This raises a question of \",[\"$\",\"em\",null,{\"children\":\"identity\"}],\". The React element may be different every time, but when does it refer to the same host instance conceptually?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In our example, it’s simple. We used to render a \",[\"$\",\"code\",null,{\"children\":\"\u003cbutton\u003e\"}],\" as a first (and only) child, and we want to render a \",[\"$\",\"code\",null,{\"children\":\"\u003cbutton\u003e\"}],\" in the same place again. We already have a \",[\"$\",\"code\",null,{\"children\":\"\u003cbutton\u003e\"}],\" host instance there so why re-create it? Let’s just reuse it.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This is pretty close to how React thinks about it.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"If an element type in the same place in the tree “matches up” between the previous and the next renders, React reuses the existing host instance.\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Here is an example with comments showing roughly what React does:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// let domNode = document.createElement('button');\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// domNode.className = 'blue';\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// domContainer.appendChild(domNode);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"blue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getElementById\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"container\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Can reuse host instance? Yes! (button → button)\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// domNode.className = 'red';\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"red\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getElementById\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"container\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Can reuse host instance? No! (button → p)\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// domContainer.removeChild(domNode);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// domNode = document.createElement('p');\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// domNode.textContent = 'Hello';\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// domContainer.appendChild(domNode);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"Hello\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getElementById\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"container\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Can reuse host instance? Yes! (p → p)\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// domNode.textContent = 'Goodbye';\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"Goodbye\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getElementById\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"container\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The same heuristic is used for child trees. For example, when we update a \",[\"$\",\"code\",null,{\"children\":\"\u003cdialog\u003e\"}],\" with two \",[\"$\",\"code\",null,{\"children\":\"\u003cbutton\u003e\"}],\"s inside, React first decides whether to re-use the \",[\"$\",\"code\",null,{\"children\":\"\u003cdialog\u003e\"}],\", and then repeats this decision procedure for each child.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Conditions\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If React only reuses host instances when the element types “match up” between updates, how can we render conditional content?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Say we want to first show only an input, but later render a message before it:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// First render\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  domContainer\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Next render\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"I was just added here!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  domContainer\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In this example, the \",[\"$\",\"code\",null,{\"children\":\"\u003cinput\u003e\"}],\" host instance would get re-created. React would walk the element tree, comparing it with the previous version:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"dialog → dialog\"}],\": Can reuse the host instance? \",[\"$\",\"strong\",null,{\"children\":\"Yes — the type matches.\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"input → p\"}],\": Can reuse the host instance? \",[\"$\",\"strong\",null,{\"children\":\"No, the type has changed!\"}],\" Need to remove the existing \",[\"$\",\"code\",null,{\"children\":\"input\"}],\" and create a new \",[\"$\",\"code\",null,{\"children\":\"p\"}],\" host instance.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"(nothing) → input\"}],\": Need to create a new \",[\"$\",\"code\",null,{\"children\":\"input\"}],\" host instance.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So effectively the update code executed by React would be like:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"oldInputNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" dialogNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"firstChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialogNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"removeChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"oldInputNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"pNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"createElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"pNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"textContent \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"I was just added here!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialogNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"appendChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"pNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"newInputNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"createElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialogNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"appendChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"newInputNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is not great because \",[\"$\",\"em\",null,{\"children\":\"conceptually\"}],\" the \",[\"$\",\"code\",null,{\"children\":\"\u003cinput\u003e\"}],\" hasn’t been \",[\"$\",\"em\",null,{\"children\":\"replaced\"}],\" with \",[\"$\",\"code\",null,{\"children\":\"\u003cp\u003e\"}],\" — it just moved. We don’t want to lose its selection, focus state, and content due to re-creating the DOM.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"While this problem has an easy fix (which we’ll get to in a minute), it doesn’t occur often in React applications. It’s interesting to see why.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In practice, you would rarely call \",[\"$\",\"code\",null,{\"children\":\"ReactDOM.render\"}],\" directly. Instead, React apps tend to be broken down into functions like this:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ showMessage }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"showMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    message \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"I was just added here!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This example doesn’t suffer from the problem we just described. It might be easier to see why if we use object notation instead of JSX. Look at the \",[\"$\",\"code\",null,{\"children\":\"dialog\"}],\" child element tree:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ showMessage }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"showMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    message \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"I was just added here!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"Regardless of whether \",[\"$\",\"code\",null,{\"children\":\"showMessage\"}],\" is \",[\"$\",\"code\",null,{\"children\":\"true\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"false\"}],\", the \",[\"$\",\"code\",null,{\"children\":\"\u003cinput\u003e\"}],\" is the second child and doesn’t change its tree position between renders.\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If \",[\"$\",\"code\",null,{\"children\":\"showMessage\"}],\" changes from \",[\"$\",\"code\",null,{\"children\":\"false\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"true\"}],\", React would walk the element tree, comparing it with the previous version:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"dialog → dialog\"}],\": Can reuse the host instance? \",[\"$\",\"strong\",null,{\"children\":\"Yes — the type matches.\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"(null) → p\"}],\": Need to insert a new \",[\"$\",\"code\",null,{\"children\":\"p\"}],\" host instance.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"input → input\"}],\": Can reuse the host instance? \",[\"$\",\"strong\",null,{\"children\":\"Yes — the type matches.\"}]]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"And the code executed by React would be similar to this:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"inputNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" dialogNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"firstChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"pNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"createElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"pNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"textContent \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"I was just added here!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialogNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"insertBefore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"pNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" inputNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"No input state is lost now.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Lists\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Comparing the element type at the same position in the tree is usually enough to decide whether to reuse or re-create the corresponding host instance.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"But this only works well if child positions are static and don’t re-order. In our example above, even though \",[\"$\",\"code\",null,{\"children\":\"message\"}],\" could be a “hole”, we still knew that the input goes after the message, and there are no other children.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"With dynamic lists, we can’t be sure the order is ever the same:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"ShoppingList\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ list }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"list\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"item \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"          You bought \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"item\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"          \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"br\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"          Enter how many do you want: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"))}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If the \",[\"$\",\"code\",null,{\"children\":\"list\"}],\" of our shopping items is ever re-ordered, React will see that all \",[\"$\",\"code\",null,{\"children\":\"p\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"input\"}],\" elements inside have the same type, and won’t know to move them. (From React’s point of view, the \",[\"$\",\"em\",null,{\"children\":\"items themselves\"}],\" changed, not their order.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The code executed by React to re-order 10 items would be something like:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" i \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"10\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"++)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"pNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" formNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"childNodes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"textNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" pNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"firstChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"textNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"textContent \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"You bought \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" items\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"].\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"So instead of \",[\"$\",\"em\",null,{\"children\":\"re-ordering\"}],\" them, React would effectively \",[\"$\",\"em\",null,{\"children\":\"update\"}],\" each of them. This can create performance issues and possible bugs. For example, the content of the first input would stay reflected in first input \",[\"$\",\"em\",null,{\"children\":\"after\"}],\" the sort — even though conceptually they might refer to different products in your shopping list!\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"This is why React nags you to specify a special property called \",[\"$\",\"code\",null,{\"children\":\"key\"}],\" every time you include an array of elements in your output:\"]}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"ShoppingList\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ list }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"list\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"item \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" key={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"item\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"productId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"          You bought \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"item\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"          \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"br\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"          Enter how many do you want: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"))}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A \",[\"$\",\"code\",null,{\"children\":\"key\"}],\" tells React that it should consider an item to be \",[\"$\",\"em\",null,{\"children\":\"conceptually\"}],\" the same even if it has different \",[\"$\",\"em\",null,{\"children\":\"positions\"}],\" inside its parent element between renders.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When React sees \",[\"$\",\"code\",null,{\"children\":\"\u003cp key=\\\"42\\\"\u003e\"}],\" inside a \",[\"$\",\"code\",null,{\"children\":\"\u003cform\u003e\"}],\", it will check if the previous render also contained \",[\"$\",\"code\",null,{\"children\":\"\u003cp key=\\\"42\\\"\u003e\"}],\" inside the same \",[\"$\",\"code\",null,{\"children\":\"\u003cform\u003e\"}],\". This works even if \",[\"$\",\"code\",null,{\"children\":\"\u003cform\u003e\"}],\" children changed their order. React will reuse the previous host instance with the same key if it exists, and re-order the siblings accordingly.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Note that the \",[\"$\",\"code\",null,{\"children\":\"key\"}],\" is only relevant within a particular parent React element, such as a \",[\"$\",\"code\",null,{\"children\":\"\u003cform\u003e\"}],\". React won’t try to “match up” elements with the same keys between different parents. (React doesn’t have idiomatic support for moving a host instance between different parents without re-creating it.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"What’s a good value for a \",[\"$\",\"code\",null,{\"children\":\"key\"}],\"? An easy way to answer this is to ask: \",[\"$\",\"strong\",null,{\"children\":[\"when would \",[\"$\",\"em\",null,{\"children\":\"you\"}],\" say an item is the “same” even if the order changed?\"]}],\" For example, in our shopping list, the product ID uniquely identifies it between siblings.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Components\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We’ve already seen functions that return React elements:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ showMessage }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"showMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    message \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"I was just added here!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"dialog\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"They are called \",[\"$\",\"em\",null,{\"children\":\"components\"}],\". They let us create our own “toolbox” of buttons, avatars, comments, and so on. Components are the bread and butter of React.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Components take one argument — an object hash. It contains “props” (short for “properties”). Here, \",[\"$\",\"code\",null,{\"children\":\"showMessage\"}],\" is a prop. They’re like named arguments.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Purity\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"React components are assumed to be pure with respect to their props.\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🔴 Doesn't work\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"isActive \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In general, mutation is not idiomatic in React. (We’ll talk more about the idiomatic way to update the UI in response to events later.)\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, \",[\"$\",\"em\",null,{\"children\":\"local mutation\"}],\" is absolutely fine:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"FriendList\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ friends }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"items\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" i \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"friends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"length\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"++)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"friend\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"friends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"items\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"push\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Friend\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" key={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"friend\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} friend={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"friend\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"section\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"items\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"section\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We created \",[\"$\",\"code\",null,{\"children\":\"items\"}],\" \",[\"$\",\"em\",null,{\"children\":\"while rendering\"}],\" and no other component “saw” it so we can mutate it as much as we like before handing it off as part of the render result. There is no need to contort your code to avoid local mutation.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Similarly, lazy initialization is fine despite not being fully “pure”:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"ExpenseForm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Fine if it doesn't affect other components:\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"SuperCalculator\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"initializeIfNotReady\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Continue rendering...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"As long as calling a component multiple times is safe and doesn’t affect the rendering of other components, React doesn’t care if it’s 100% pure in the strict FP sense of the word. \",[\"$\",\"$La\",null,{\"href\":\"https://stackoverflow.com/questions/1077412/what-is-an-idempotent-operation\",\"children\":\"Idempotence\"}],\" is more important to React than purity.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"That said, side effects that are directly visible to the user are not allowed in React components. In other words, merely \",[\"$\",\"em\",null,{\"children\":\"calling\"}],\" a component function shouldn’t by itself produce a change on the screen.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Recursion\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"How do we \",[\"$\",\"em\",null,{\"children\":\"use\"}],\" components from other components? Components are functions so we \",[\"$\",\"em\",null,{\"children\":\"could\"}],\" call them:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"showMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" domContainer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, this is \",[\"$\",\"em\",null,{\"children\":\"not\"}],\" the idiomatic way to use components in the React runtime.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Instead, the idiomatic way to use a component is with the same mechanism we’ve already seen before — React elements. \",[\"$\",\"strong\",null,{\"children\":\"This means that you don’t directly call the component function, but instead let React later do it for you\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// { type: Form, props: { showMessage: true } }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" showMessage={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" domContainer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"And somewhere inside React, your component will be called:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Somewhere inside React\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Form\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" reactElement\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// { showMessage: true }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Whatever Form returns\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Component function names are by convention capitalized. When the JSX transform sees \",[\"$\",\"code\",null,{\"children\":\"\u003cForm\u003e\"}],\" rather than \",[\"$\",\"code\",null,{\"children\":\"\u003cform\u003e\"}],\", it makes the object \",[\"$\",\"code\",null,{\"children\":\"type\"}],\" itself an identifier rather than a string:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 'form' string\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Form\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Form function\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"There is no global registration mechanism — we literally refer to \",[\"$\",\"code\",null,{\"children\":\"Form\"}],\" by name when typing \",[\"$\",\"code\",null,{\"children\":\"\u003cForm /\u003e\"}],\". If \",[\"$\",\"code\",null,{\"children\":\"Form\"}],\" doesn’t exist in local scope, you’ll see a JavaScript error just like you normally would with a bad variable name.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"Okay, so what does React do when an element type is a function? It calls your component, and asks what element \",[\"$\",\"em\",null,{\"children\":\"that\"}],\" component wants to render.\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This process continues recursively and is described in more detail \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html\",\"children\":\"here\"}],\". In short, it looks like this:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"You:\"}],\" \",[\"$\",\"code\",null,{\"children\":\"ReactDOM.render(\u003cApp /\u003e, domContainer)\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Hey \",[\"$\",\"code\",null,{\"children\":\"App\"}],\", what do you render to?\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"App\"}],\": I render \",[\"$\",\"code\",null,{\"children\":\"\u003cLayout\u003e\"}],\" with \",[\"$\",\"code\",null,{\"children\":\"\u003cContent\u003e\"}],\" inside.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Hey \",[\"$\",\"code\",null,{\"children\":\"Layout\"}],\", what do you render to?\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Layout\"}],\": I render my children in a \",[\"$\",\"code\",null,{\"children\":\"\u003cdiv\u003e\"}],\". My child was \",[\"$\",\"code\",null,{\"children\":\"\u003cContent\u003e\"}],\" so I guess that goes into the \",[\"$\",\"code\",null,{\"children\":\"\u003cdiv\u003e\"}],\".\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Hey \",[\"$\",\"code\",null,{\"children\":\"\u003cContent\u003e\"}],\", what do you render to?\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Content\"}],\": I render an \",[\"$\",\"code\",null,{\"children\":\"\u003carticle\u003e\"}],\" with some text and a \",[\"$\",\"code\",null,{\"children\":\"\u003cFooter\u003e\"}],\" inside.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Hey \",[\"$\",\"code\",null,{\"children\":\"\u003cFooter\u003e\"}],\", what do you render to?\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Footer\"}],\": I render a \",[\"$\",\"code\",null,{\"children\":\"\u003cfooter\u003e\"}],\" with some more text.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Okay, here you go:\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Resulting DOM structure\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    Some text\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"footer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"some more text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"footer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is why we say reconciliation is recursive. When React walks the element tree, it might meet an element whose \",[\"$\",\"code\",null,{\"children\":\"type\"}],\" is a component. It will call it and keep descending down the tree of returned React elements. Eventually, we’ll run out of components, and React will know what to change in the host tree.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The same reconciliation rules we already discussed apply here too. If the \",[\"$\",\"code\",null,{\"children\":\"type\"}],\" at the same position (as determined by index and optional \",[\"$\",\"code\",null,{\"children\":\"key\"}],\") changes, React will throw away the host instances inside, and re-create them.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Inversion of Control\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You might be wondering: why don’t we just call components directly? Why write \",[\"$\",\"code\",null,{\"children\":\"\u003cForm /\u003e\"}],\" rather than \",[\"$\",\"code\",null,{\"children\":\"Form()\"}],\"?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"React can do its job better if it “knows” about your components rather than if it only sees the React element tree after recursively calling them.\"}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🔴 React has no idea Layout and Article exist.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// You're calling them.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Layout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  domContainer\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ React knows Layout and Article exist.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// React calls them.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ReactDOM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Layout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Layout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  domContainer\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is a classic example of \",[\"$\",\"$La\",null,{\"href\":\"https://en.wikipedia.org/wiki/Inversion_of_control\",\"children\":\"inversion of control\"}],\". There’s a few interesting properties we get by letting React take control of calling our components:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Components become more than functions.\"}],\" React can augment component functions with features like \",[\"$\",\"em\",null,{\"children\":\"local state\"}],\" that are tied to the component identity in the tree. A good runtime provides fundamental abstractions that match the problem at hand. As we already mentioned, React is oriented specifically at programs that render UI trees and respond to interactions. If you called components directly, you’d have to build these features yourself.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Component types participate in the reconciliation.\"}],\" By letting React call your components, you also tell it more about the conceptual structure of your tree. For example, when you move from rendering \",[\"$\",\"code\",null,{\"children\":\"\u003cFeed\u003e\"}],\" to the \",[\"$\",\"code\",null,{\"children\":\"\u003cProfile\u003e\"}],\" page, React won’t attempt to re-use host instances inside them — just like when you replace \",[\"$\",\"code\",null,{\"children\":\"\u003cbutton\u003e\"}],\" with a \",[\"$\",\"code\",null,{\"children\":\"\u003cp\u003e\"}],\". All state will be gone — which is usually good when you render a conceptually different view. You wouldn’t want to preserve input state between \",[\"$\",\"code\",null,{\"children\":\"\u003cPasswordForm\u003e\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"\u003cMessengerChat\u003e\"}],\" even if the \",[\"$\",\"code\",null,{\"children\":\"\u003cinput\u003e\"}],\" position in the tree accidentally “lines up” between them.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React can delay the reconciliation.\"}],\" If React takes control over calling our components, it can do many interesting things. For example, it can let the browser do some work between the component calls so that re-rendering a large component tree \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html\",\"children\":\"doesn’t block the main thread\"}],\". Orchestrating this manually without reimplementing a large part of React is difficult.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"A better debugging story.\"}],\" If components are first-class citizens that the library is aware of, we can build \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/facebook/react-devtools\",\"children\":\"rich developer tools\"}],\" for introspection in development.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The last benefit to React calling your component functions is \",[\"$\",\"em\",null,{\"children\":\"lazy evaluation\"}],\". Let’s see what this means.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Lazy Evaluation\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"When we call functions in JavaScript, arguments are evaluated before the call:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// (2) This gets computed second\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"eat\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// (1) This gets computed first\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"prepareMeal\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This is usually what JavaScript developers expect because JavaScript functions can have implicit side effects. It would be surprising if we called a function, but it wouldn’t execute until its result gets somehow “used” in JavaScript.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, React components are \",[\"$\",\"$La\",null,{\"href\":\"#purity\",\"children\":\"relatively\"}],\" pure. There is absolutely no need to execute it if we know its result won’t get rendered on the screen.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Consider this component putting \",[\"$\",\"code\",null,{\"children\":\"\u003cComments\u003e\"}],\" inside a \",[\"$\",\"code\",null,{\"children\":\"\u003cPage\u003e\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Story\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ currentUser }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// return {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   type: Page,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   props: {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//     user: currentUser,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//     children: { type: Comments, props: {} }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" user={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"currentUser\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Comments\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"Page\"}],\" component can render the children given to it inside some \",[\"$\",\"code\",null,{\"children\":\"Layout\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ user\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" children }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Layout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Layout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(\",[\"$\",\"code\",null,{\"children\":\"\u003cA\u003e\u003cB /\u003e\u003c/A\u003e\"}],\" in JSX is the same as \",[\"$\",\"code\",null,{\"children\":\"\u003cA children={\u003cB /\u003e} /\u003e\"}],\".)\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"But what if it has an early exit condition?\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ user\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" children }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"user\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"isLoggedIn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"Please log in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Layout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Layout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If we called \",[\"$\",\"code\",null,{\"children\":\"Comments()\"}],\" as a function, it would execute immediately regardless of whether \",[\"$\",\"code\",null,{\"children\":\"Page\"}],\" wants to render them or not:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   type: Page,\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   props: {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//     children: Comments() // Always runs!\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Comments\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"But if we pass a React element, we don’t execute \",[\"$\",\"code\",null,{\"children\":\"Comments\"}],\" ourselves at all:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   type: Page,\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   props: {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//     children: { type: Comments }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"//   }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Comments\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This lets React decide when and \",[\"$\",\"em\",null,{\"children\":\"whether\"}],\" to call it. If our \",[\"$\",\"code\",null,{\"children\":\"Page\"}],\" component ignores its \",[\"$\",\"code\",null,{\"children\":\"children\"}],\" prop and renders\\r\\n\",[\"$\",\"code\",null,{\"children\":\"\u003ch1\u003ePlease log in\u003c/h1\u003e\"}],\" instead, React won’t even attempt to call the \",[\"$\",\"code\",null,{\"children\":\"Comments\"}],\" function. What’s the point?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is good because it both lets us avoid unnecessary rendering work that would be thrown away, and makes the code less fragile. (We don’t care if \",[\"$\",\"code\",null,{\"children\":\"Comments\"}],\" throws or not when the user is logged out — it won’t be called.)\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"State\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We talked \",[\"$\",\"$La\",null,{\"href\":\"#reconciliation\",\"children\":\"earlier\"}],\" about identity and how an element’s conceptual “position” in the tree tells React whether to re-use a host instance or create a new one. Host instances can have all kinds of local state: focus, selection, input, etc. We want to preserve this state between updates that conceptually render the same UI. We also want to predictably destroy it when we render something conceptually different (such as moving from \",[\"$\",\"code\",null,{\"children\":\"\u003cSignupForm\u003e\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"\u003cMessengerChat\u003e\"}],\").\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"Local state is so useful that React lets \",[\"$\",\"em\",null,{\"children\":\"your own\"}],\" components have it too.\"]}],\" Components are still functions but React augments them with features that are useful for UIs. Local state tied to the position in the tree is one of these features.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We call these features \",[\"$\",\"em\",null,{\"children\":\"Hooks\"}],\". For example, \",[\"$\",\"code\",null,{\"children\":\"useState\"}],\" is a Hook.\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Click me\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"It returns a pair of values: the current state and a function that updates it.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"$La\",null,{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Array_destructuring\",\"children\":\"array destructuring\"}],\" syntax lets us give arbitrary names to our state variables. For example, I called this pair \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"setCount\"}],\", but it could’ve been \",[\"$\",\"code\",null,{\"children\":\"banana\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"setBanana\"}],\". In the text below, I will use \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\" to refer to the second value regardless of its actual name in the specific examples.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(You can learn more about \",[\"$\",\"code\",null,{\"children\":\"useState\"}],\" and other Hooks provided by React \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-intro.html\",\"children\":\"here\"}],\".)\"]}]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Consistency\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Even if we want to split the reconciliation process itself into \",[\"$\",\"$La\",null,{\"href\":\"https://www.youtube.com/watch?v=mDdgfyRB5kg\",\"children\":\"non-blocking\"}],\" chunks of work, we should still perform the actual host tree operations in a single synchronous swoop. This way we can ensure that the user doesn’t see a half-updated UI, and that the browser doesn’t perform unnecessary layout and style recalculation for intermediate states that the user shouldn’t see.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is why React splits all work into the “render phase” and the “commit phase”. \",[\"$\",\"em\",null,{\"children\":\"Render phase\"}],\" is when React calls your components and performs reconciliation. It is safe to interrupt and \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html\",\"children\":\"in the future\"}],\" will be asynchronous. \",[\"$\",\"em\",null,{\"children\":\"Commit phase\"}],\" is when React touches the host tree. It is always synchronous.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Memoization\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When a parent schedules an update by calling \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\", by default React reconciles its whole child subtree. This is because React can’t know whether an update in the parent would affect the child or not, and by default, React opts to be consistent. This may sound very expensive but in practice, it’s not a problem for small and medium-sized subtrees.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When trees get too deep or wide, you can tell React to \",[\"$\",\"$La\",null,{\"href\":\"https://en.wikipedia.org/wiki/Memoization\",\"children\":\"memoize\"}],\" a subtree and reuse previous render results during shallow equal prop changes:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ item }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"React\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"memo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\" in a parent \",[\"$\",\"code\",null,{\"children\":\"\u003cTable\u003e\"}],\" component would skip over reconciling \",[\"$\",\"code\",null,{\"children\":\"Row\"}],\"s whose \",[\"$\",\"code\",null,{\"children\":\"item\"}],\" is referentially equal to the \",[\"$\",\"code\",null,{\"children\":\"item\"}],\" rendered last time.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You can get fine-grained memoization at the level of individual expressions with the \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-reference.html#usememo\",\"children\":[[\"$\",\"code\",null,{\"children\":\"useMemo()\"}],\" Hook\"]}],\". The cache is local to component tree position and will be destroyed together with its local state. It only holds one last item.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"React intentionally doesn’t memoize components by default. Many components always receive different props so memoizing them would be a net loss.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Raw Models\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Ironically, React doesn’t use a “reactivity” system for fine-grained updates. In other words, any update at the top triggers reconciliation instead of updating just the components affected by changes.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is an intentional design decision. \",[\"$\",\"$La\",null,{\"href\":\"https://calibreapp.com/blog/time-to-interactive/\",\"children\":\"Time to interactive\"}],\" is a crucial metric in consumer web applications, and traversing models to set up fine-grained listeners spends that precious time. Additionally, in many apps, interactions tend to result either in small (button hover) or large (page transition) updates, in which case fine-grained subscriptions are a waste of memory resources.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"One of the core design principles of React is that it works with raw data. If you have a bunch of JavaScript objects received from the network, you can pump them directly into your components with no preprocessing. There are no gotchas about which properties you can access, or unexpected performance cliffs when a structure slightly changes. React rendering is O(\",[\"$\",\"em\",null,{\"children\":\"view size\"}],\") rather than O(\",[\"$\",\"em\",null,{\"children\":\"model size\"}],\"), and you can significantly cut the \",[\"$\",\"em\",null,{\"children\":\"view size\"}],\" with \",[\"$\",\"$La\",null,{\"href\":\"https://react-window.now.sh/#/examples/list/fixed-size\",\"children\":\"windowing\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"There are some kinds of applications where fine-grained subscriptions are beneficial — such as stock tickers. This is a rare example of “everything constantly updating at the same time”. While imperative escape hatches can help optimize such code, React might not be the best fit for this use case. Still, you can implement your own fine-grained subscription system on top of React.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note that there are common performance issues that even fine-grained subscriptions and “reactivity” systems can’t solve.\"}],\" For example, rendering a \",[\"$\",\"em\",null,{\"children\":\"new\"}],\" deep tree (which happens on every page transition) without blocking the browser. Change tracking doesn’t make it faster — it makes it slower because we have to do more work to set up subscriptions. Another problem is that we have to wait for data before we can start rendering the view. In React, we aim to solve both of these problems with \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html\",\"children\":\"Concurrent Rendering\"}],\".\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Batching\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Several components may want to update state in response to the same event. This example is contrived but it illustrates a common pattern:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Parent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      Parent clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      Child clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When an event is dispatched, the child’s \",[\"$\",\"code\",null,{\"children\":\"onClick\"}],\" fires first (triggering its \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\"). Then the parent calls \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\" in its own \",[\"$\",\"code\",null,{\"children\":\"onClick\"}],\" handler.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If React immediately re-rendered components in response to \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\" calls, we’d end up rendering the child twice:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"***\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Entering React\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"s browser click event handler **\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"*\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"onClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" setState\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" re\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"render Child \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 😞 unnecessary\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Parent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"onClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" setState\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" re\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"render Parent\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" re\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"render Child\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"***\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Exiting React\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"s browser click event handler **\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"*\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The first \",[\"$\",\"code\",null,{\"children\":\"Child\"}],\" render would be wasted. And we couldn’t make React skip rendering \",[\"$\",\"code\",null,{\"children\":\"Child\"}],\" for the second time because the \",[\"$\",\"code\",null,{\"children\":\"Parent\"}],\" might pass some different data to it based on its updated state.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"This is why React batches updates inside event handlers:\"}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"***\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Entering React\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"s browser click event handler **\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"*\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"onClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" setState\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Parent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"onClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" setState\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"***\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Processing state updates                     \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"***\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" re\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"render Parent\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" re\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"render Child\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"***\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Exiting React\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"s browser click event handler  **\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"*\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\" calls in components wouldn’t immediately cause a re-render. Instead, React would execute all event handlers first, and then trigger a single re-render batching all of those updates together.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Batching is good for performance but can be surprising if you write code like:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If we start with \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" set to \",[\"$\",\"code\",null,{\"children\":\"0\"}],\", these would just be three \",[\"$\",\"code\",null,{\"children\":\"setCount(1)\"}],\" calls. To fix this, \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\" provides an overload that accepts an “updater” function:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"c \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" c \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"React would put the updater functions in a queue, and later run them in sequence, resulting in a re-render with \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" set to \",[\"$\",\"code\",null,{\"children\":\"3\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When state logic gets more complex than a few \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\" calls, I recommend expressing it as a local state reducer with the \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-reference.html#usereducer\",\"children\":[[\"$\",\"code\",null,{\"children\":\"useReducer\"}],\" Hook\"]}],\". It’s like an evolution of this “updater” pattern where each update is given a name:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useReducer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      return \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      return \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"increment\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"action\"}],\" argument can be anything, although an object is a common choice.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Call Tree\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A programming language runtime usually has a \",[\"$\",\"$La\",null,{\"href\":\"https://medium.freecodecamp.org/understanding-the-javascript-call-stack-861e41ae61d4\",\"children\":\"call stack\"}],\". When a function \",[\"$\",\"code\",null,{\"children\":\"a()\"}],\" calls \",[\"$\",\"code\",null,{\"children\":\"b()\"}],\" which itself calls \",[\"$\",\"code\",null,{\"children\":\"c()\"}],\", somewhere in the JavaScript engine there’s a data structure like \",[\"$\",\"code\",null,{\"children\":\"[a, b, c]\"}],\" that “keeps track” of where you are and what code to execute next. Once you exit out of \",[\"$\",\"code\",null,{\"children\":\"c\"}],\", its call stack frame is gone — poof! It’s not needed anymore. We jump back into \",[\"$\",\"code\",null,{\"children\":\"b\"}],\". By the time we exit \",[\"$\",\"code\",null,{\"children\":\"a\"}],\", the call stack is empty.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Of course, React itself runs in JavaScript and obeys JavaScript rules. But we can imagine that internally React has some kind of its own call stack to remember which component we are currently rendering, e.g. \",[\"$\",\"code\",null,{\"children\":\"[App, Page, Layout, Article /* we're here */]\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"React is different from a general purpose language runtime because it’s aimed at rendering UI trees. These trees need to “stay alive” for us to interact with them. The DOM doesn’t disappear after our first \",[\"$\",\"code\",null,{\"children\":\"ReactDOM.render()\"}],\" call.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This may be stretching the metaphor but I like to think of React components as being in a “call tree” rather than just a “call stack”. When we go “out” of the \",[\"$\",\"code\",null,{\"children\":\"Article\"}],\" component, its React “call tree” frame doesn’t get destroyed. We need to keep the local state and references to the host instances \",[\"$\",\"$La\",null,{\"href\":\"https://medium.com/react-in-depth/the-how-and-why-on-reacts-usage-of-linked-list-in-fiber-67f1014d0eb7\",\"children\":\"somewhere\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"These “call tree” frames \",[\"$\",\"em\",null,{\"children\":\"are\"}],\" destroyed along with their local state and host instances, but only when the \",[\"$\",\"$La\",null,{\"href\":\"#reconciliation\",\"children\":\"reconciliation\"}],\" rules say it’s necessary. If you ever read React source, you might have seen these frames being referred to as \",[\"$\",\"$La\",null,{\"href\":\"https://en.wikipedia.org/wiki/Fiber_(computer_science)\",\"children\":\"Fibers\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Fibers are where the local state actually lives. When the state is updated, React marks the Fibers below as needing reconciliation, and calls those components.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Context\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In React, we pass things down to other components as props. Sometimes, the majority of components need the same thing — for example, the currently chosen visual theme. It gets cumbersome to pass it down through every level.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In React, this is solved by \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/context.html\",\"children\":\"Context\"}],\". It is essentially like \",[\"$\",\"$La\",null,{\"href\":\"http://wiki.c2.com/?DynamicScoping\",\"children\":\"dynamic scoping\"}],\" for components. It’s like a wormhole that lets you put something on the top, and have every child at the bottom be able to read it and re-render when it changes.\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"ThemeContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" React\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"createContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"light\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Default value as a fallback\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"DarkApp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ThemeContext.Provider\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" value=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"dark\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"MyComponents\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ThemeContext.Provider\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SomeDeeplyNestedChild\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Depends on where the child is rendered\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"theme\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"ThemeContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When \",[\"$\",\"code\",null,{\"children\":\"SomeDeeplyNestedChild\"}],\" renders, \",[\"$\",\"code\",null,{\"children\":\"useContext(ThemeContext)\"}],\" will look for the closest \",[\"$\",\"code\",null,{\"children\":\"\u003cThemeContext.Provider\u003e\"}],\" above it in the tree, and use its \",[\"$\",\"code\",null,{\"children\":\"value\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"(In practice, React maintains a context stack while it renders.)\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If there’s no \",[\"$\",\"code\",null,{\"children\":\"ThemeContext.Provider\"}],\" above, the result of \",[\"$\",\"code\",null,{\"children\":\"useContext(ThemeContext)\"}],\" call will be the default value specified in the \",[\"$\",\"code\",null,{\"children\":\"createContext()\"}],\" call. In our example, it is \",[\"$\",\"code\",null,{\"children\":\"'light'\"}],\".\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Effects\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We mentioned earlier that React components shouldn’t have observable side effects during rendering. But side effects are sometimes necessary. We may want to manage focus, draw on a canvas, subscribe to a data source, and so on.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In React, this is done by declaring an effect:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Click me\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When possible, React defers executing effects until after the browser re-paints the screen. This is good because code like data source subscriptions shouldn’t hurt \",[\"$\",\"$La\",null,{\"href\":\"https://calibreapp.com/blog/time-to-interactive/\",\"children\":\"time to interactive\"}],\" and \",[\"$\",\"$La\",null,{\"href\":\"https://developers.google.com/web/tools/lighthouse/audits/first-meaningful-paint\",\"children\":\"time to first paint\"}],\". (There’s a \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-reference.html#uselayouteffect\",\"children\":\"rarely used\"}],\" Hook that lets you opt out of that behavior and do things synchronously. Avoid it.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Effects don’t just run once. They run both after a component is shown to the user for the first time, and after it updates. Effects can close over current props and state, such as with \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" in the above example.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Effects may require cleanup, such as in case of subscriptions. To clean up after itself, an effect can return a function:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"DataSource\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"addSubscription\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"DataSource\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"removeSubscription\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"React will execute the returned function before applying this effect the next time, and also before the component is destroyed.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Sometimes, re-running the effect on every render can be undesirable. You can tell React to \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects\",\"children\":\"skip\"}],\" applying an effect if certain variables didn’t change:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"However, it is often a premature optimization and can lead to problems if you’re not familiar with how JavaScript closures work.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For example, this code is buggy:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"DataSource\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"addSubscription\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"DataSource\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"removeSubscription\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"It is buggy because \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\" says “don’t ever re-execute this effect”. But the effect closes over \",[\"$\",\"code\",null,{\"children\":\"handleChange\"}],\" which is defined outside of it. And \",[\"$\",\"code\",null,{\"children\":\"handleChange\"}],\" might reference any props or state:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If we never let the effect re-run, \",[\"$\",\"code\",null,{\"children\":\"handleChange\"}],\" will keep pointing at the version from the first render, and \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" will always be \",[\"$\",\"code\",null,{\"children\":\"0\"}],\" inside of it.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To solve this, make sure that if you specify the dependency array, it includes \",[\"$\",\"strong\",null,{\"children\":\"all\"}],\" things that can change, including the functions:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"DataSource\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"addSubscription\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"DataSource\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"removeSubscription\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Depending on your code, you might still see unnecessary resubscriptions because \",[\"$\",\"code\",null,{\"children\":\"handleChange\"}],\" itself is different on every render. The \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-reference.html#usecallback\",\"children\":[\"$\",\"code\",null,{\"children\":\"useCallback\"}]}],\" Hook can help you with that. Alternatively, you can just let it re-subscribe. For example, browser’s \",[\"$\",\"code\",null,{\"children\":\"addEventListener\"}],\" API is extremely fast, and jumping through hoops to avoid calling it might cause more problems than it’s worth.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(You can learn more about \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" and other Hooks provided by React \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-effect.html\",\"children\":\"here\"}],\".)\"]}]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Custom Hooks\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Since Hooks like \",[\"$\",\"code\",null,{\"children\":\"useState\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" are function calls, we can compose them into our own Hooks:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"MyResponsiveComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"width\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useWindowWidth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Our custom Hook\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"Window width is \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"width\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useWindowWidth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"width\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setWidth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"window\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"innerWidth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleResize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setWidth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"window\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"innerWidth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"window\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"addEventListener\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"resize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" handleResize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"window\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"removeEventListener\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"resize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" handleResize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" width\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Custom Hooks let different components share reusable stateful logic. Note that the \",[\"$\",\"em\",null,{\"children\":\"state itself\"}],\" is not shared. Each call to a Hook declares its own isolated state.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(You can learn more about writing your own Hooks \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-custom.html\",\"children\":\"here\"}],\".)\"]}]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Static Use Order\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You can think of \",[\"$\",\"code\",null,{\"children\":\"useState\"}],\" as a syntax for defining a “React state variable”. It’s not \",[\"$\",\"em\",null,{\"children\":\"really\"}],\" a syntax, of course. We’re still writing JavaScript. But we are looking at React as a runtime environment, and because React tailors JavaScript to describing UI trees, its features sometimes live closer to the language space.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If \",[\"$\",\"code\",null,{\"children\":\"use\"}],\" \",[\"$\",\"em\",null,{\"children\":\"were\"}],\" a syntax, it would make sense for it to be at the top level:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 😉 Note: not a real syntax\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"State\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Click me\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"What would putting it into a condition or a callback or outside a component even mean?\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 😉 Note: not a real syntax\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// This is local state... of what?\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"State\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"condition\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// What happens to it when condition is false?\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"State\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// What happens to it when we leave a function?\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// How is this different from a variable?\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"State\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"React state is local to the \",[\"$\",\"em\",null,{\"children\":\"component\"}],\" and its identity in the tree. If \",[\"$\",\"code\",null,{\"children\":\"use\"}],\" were a real syntax it would make sense to scope it to the top-level of a component too:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 😉 Note: not a real syntax\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Only valid here\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"State\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"condition\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// This would be a syntax error\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"State\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is similar to how \",[\"$\",\"code\",null,{\"children\":\"import\"}],\" only works at the top level of a module.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"Of course, \",[\"$\",\"code\",null,{\"children\":\"use\"}],\" is not actually a syntax.\"]}],\" (It wouldn’t bring much benefit and would create a lot of friction.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, React \",[\"$\",\"em\",null,{\"children\":\"does\"}],\" expect that all calls to Hooks happen only at the top level of a component and unconditionally. These \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-rules.html\",\"children\":\"Rules of Hooks\"}],\" can be enforced with \",[\"$\",\"$La\",null,{\"href\":\"https://www.npmjs.com/package/eslint-plugin-react-hooks\",\"children\":\"a linter plugin\"}],\". There have been heated arguments about this design choice but in practice, I haven’t seen it confusing people. I also wrote about why commonly proposed alternatives \",[\"$\",\"$La\",null,{\"href\":\"https://overreacted.io/why-do-hooks-rely-on-call-order/\",\"children\":\"don’t work\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Internally, Hooks are implemented as \",[\"$\",\"$La\",null,{\"href\":\"https://dev.to/aspittel/thank-u-next-an-introduction-to-linked-lists-4pph\",\"children\":\"linked lists\"}],\". When you call \",[\"$\",\"code\",null,{\"children\":\"useState\"}],\", we move the pointer to the next item. When we exit the component’s \",[\"$\",\"$La\",null,{\"href\":\"#call-tree\",\"children\":\"“call tree” frame\"}],\", we save the resulting list there until the next render.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"$La\",null,{\"href\":\"https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e\",\"children\":\"This article\"}],\" provides a simplified explanation for how Hooks work internally. Arrays might be an easier mental model than linked lists:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Pseudocode\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"hooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"++;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"hooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"])\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Next renders\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" hooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// First render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"hooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"push\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(...);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Prepare to render\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"i \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"hooks \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"fiber\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"hooks \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"||\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Call the component\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"YourComponent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Remember the state of Hooks\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"fiber\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"hooks \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" hooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(If you’re curious, the real code is \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/facebook/react/blob/master/packages/react-reconciler/src/ReactFiberHooks.new.js\",\"children\":\"here\"}],\".)\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is roughly how each \",[\"$\",\"code\",null,{\"children\":\"useState()\"}],\" call gets the right state. As we’ve learned \",[\"$\",\"$La\",null,{\"href\":\"#reconciliation\",\"children\":\"earlier\"}],\", “matching things up” isn’t new to React — reconciliation relies on the elements matching up between renders in a similar way.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"What’s Left Out\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We’ve touched on pretty much all important aspects of the React runtime environment. If you finished this page, you probably know React in more detail than 90% of its users. And there’s nothing wrong with that!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"There are some parts I left out — mostly because they’re unclear even to us. React doesn’t currently have a good story for multipass rendering, i.e. when the parent render needs information about the children. Also, the \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/error-boundaries.html\",\"children\":\"error handling API\"}],\" doesn’t yet have a Hooks version. It’s possible that these two problems can be solved together. Concurrent Mode is not stable yet, and there are interesting questions about how Suspense fits into this picture. Maybe I’ll do a follow-up when they’re fleshed out and Suspense is ready for more than \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/blog/2018/10/23/react-v-16-6.html#reactlazy-code-splitting-with-suspense\",\"children\":\"lazy loading\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"I think it speaks to the success of React’s API that you can get very far without ever thinking about most of these topics.\"}],\" Good defaults like the reconciliation heuristics do the right thing in most cases. Warnings, like the \",[\"$\",\"code\",null,{\"children\":\"key\"}],\" warning, nudge you when you risk shooting yourself in the foot.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If you’re a UI library nerd, I hope this post was somewhat entertaining and clarified how React works in more depth. Or maybe you decided React is too complicated and you’ll never look at it again. In either case, I’d love to hear from you on Twitter! Thank you for reading.\"}]]\n"])</script><script>self.__next_f.push([1,""])</script></body></html>