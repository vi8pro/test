<!DOCTYPE html><html lang="en" class="__className_e34cb4"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://github.com/gaearon.png"/><link rel="preload" as="image" href="./yoda.jpg"/><link rel="preload" as="image" href="./counter.gif"/><link rel="preload" as="image" href="./timeout_counter.gif"/><link rel="preload" as="image" href="./timeout_counter_class.gif"/><link rel="preload" as="image" href="./timeout_counter_refs.gif"/><link rel="preload" as="image" href="./deja_vu.gif"/><link rel="preload" as="image" href="./deps-compare-correct.gif"/><link rel="preload" as="image" href="./deps-compare-wrong.gif"/><link rel="preload" as="image" href="./interval-wrong.gif"/><link rel="stylesheet" href="/_next/static/css/0f6647b39fdbcb3d.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/3c6c21fa7f32edf2.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/f9d4d708579596e8.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-fdca05b8968262b2.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-da4818c833129d2a.js" async="" crossorigin=""></script><script src="/_next/static/chunks/472-44c3d350117a997d.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-74b5bca37634105e.js" async="" crossorigin=""></script><script src="/_next/static/chunks/569-52e5d813bbfa85ea.js" async=""></script><script src="/_next/static/chunks/app/layout-cfb37acb14684668.js" async=""></script><script src="/_next/static/chunks/app/%5Bslug%5D/layout-d3e08fbfdc858bf2.js" async=""></script><script src="/_next/static/chunks/app/%5Bslug%5D/page-798073576b23f3f1.js" async=""></script><link rel="preload" as="image" href="./interval-rightish.gif"/><link rel="preload" as="image" href="./interval-right.gif"/><link rel="preload" as="image" href="./exhaustive-deps.gif"/><title>A Complete Guide to useEffect — overreacted</title><meta name="description" content="Effects are a part of your data flow."/><link rel="icon" href="/icon.png?e0852c1e2c7f0e65" type="image/png" sizes="329x329"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="mx-auto max-w-2xl bg-[--bg] px-5 py-12 text-[--text]"><header class="mb-14 flex flex-row place-content-between"><a class="__className_b47211 inline-block text-2xl font-black hover:scale-[1.02] scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/"><span style="--myColor1:var(--pink);--myColor2:var(--purple);background-image:linear-gradient(45deg, var(--myColor1), var(--myColor2));background-clip:text;-webkit-background-clip:text;color:transparent;transition:--myColor1 0.2s ease-out, --myColor2 0.2s ease-in-out">overreacted</span></a><span class="relative top-[4px] italic">by<!-- --> <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://danabra.mov"><img alt="Dan Abramov" src="https://github.com/gaearon.png" class="relative -top-1 mx-1 inline h-8 w-8 rounded-full"/></a></span></header><main><article><h1 class="__className_b47211 text-[40px] font-black leading-[44px] text-[--title]">A Complete Guide to useEffect</h1><p class="mt-2 text-[13px] text-gray-700 dark:text-gray-300">March 9, 2019</p><div class="markdown mt-10"><p>You wrote a few components with <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-intro.html">Hooks</a>. Maybe even a small app. You’re mostly satisfied. You’re comfortable with the API and picked up a few tricks along the way. You even made some <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-custom.html">custom Hooks</a> to extract repetitive logic (300 lines gone!) and showed it off to your colleagues. “Great job”, they said.</p>
<p>But sometimes when you <code>useEffect</code>, the pieces don’t quite fit together. You have a nagging feeling that you’re missing something. It seems similar to class lifecycles… but is it really? You find yourself asking questions like:</p>
<ul>
<li>🤔 How do I replicate <code>componentDidMount</code> with <code>useEffect</code>?</li>
<li>🤔 How do I correctly fetch data inside <code>useEffect</code>? What is <code>[]</code>?</li>
<li>🤔 Do I need to specify functions as effect dependencies or not?</li>
<li>🤔 Why do I sometimes get an infinite refetching loop?</li>
<li>🤔 Why do I sometimes get an old state or prop value inside my effect?</li>
</ul>
<p>When I just started using Hooks, I was confused by all of those questions too. Even when writing the initial docs, I didn’t have a firm grasp on some of the subtleties. I’ve since had a few “aha” moments that I want to share with you. <strong>This deep dive will make the answers to these questions look obvious to you.</strong></p>
<p>To <em>see</em> the answers, we need to take a step back. The goal of this article isn’t to give you a list of bullet point recipes. It’s to help you truly “grok” <code>useEffect</code>. There won’t be much to learn. In fact, we’ll spend most of our time <em>un</em>learning.</p>
<p><strong>It’s only after I stopped looking at the <code>useEffect</code> Hook through the prism of the familiar class lifecycle methods that everything came together for me.</strong></p>
<blockquote>
<p>“Unlearn what you have learned.” — Yoda</p>
</blockquote>
<p><img src="./yoda.jpg" alt="Yoda sniffing the air. Caption: “I smell bacon.”"/></p>
<hr/>
<p><strong>This article assumes that you’re somewhat familiar with <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-effect.html"><code>useEffect</code></a> API.</strong></p>
<p><strong>It’s also <em>really</em> long. It’s like a mini-book. That’s just my preferred format. But I wrote a TLDR just below if you’re in a rush or don’t really care.</strong></p>
<p><strong>If you’re not comfortable with deep dives, you might want to wait until these explanations appear elsewhere. Just like when React came out in 2013, it will take some time for people to recognize a different mental model and teach it.</strong></p>
<hr/>
<h2>TLDR</h2>
<p>Here’s a quick TLDR if you don’t want to read the whole thing. If some parts don’t make sense, you can scroll down until you find something related.</p>
<p>Feel free to skip it if you plan to read the whole post. I’ll link to it at the end.</p>
<p><strong>🤔 Question: How do I replicate <code>componentDidMount</code> with <code>useEffect</code>?</strong></p>
<p>While you can <code>useEffect(fn, [])</code>, it’s not an exact equivalent. Unlike <code>componentDidMount</code>, it will <em>capture</em> props and state. So even inside the callbacks, you’ll see the initial props and state. If you want to see “latest” something, you can write it to a ref. But there’s usually a simpler way to structure the code so that you don’t have to. Keep in mind that the mental model for effects is different from <code>componentDidMount</code> and other lifecycles, and trying to find their exact equivalents may confuse you more than help. To get productive, you need to “think in effects”, and their mental model is closer to implementing synchronization than to responding to lifecycle events.</p>
<p><strong>🤔 Question:  How do I correctly fetch data inside <code>useEffect</code>? What is <code>[]</code>?</strong></p>
<p><a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://www.robinwieruch.de/react-hooks-fetch-data/">This article</a> is a good primer on data fetching with <code>useEffect</code>. Make sure to read it to the end! It’s not as long as this one. <code>[]</code> means the effect doesn’t use any value that participates in React data flow, and is for that reason safe to apply once. It is also a common source of bugs when the value actually <em>is</em> used. You’ll need to learn a few strategies (primarily <code>useReducer</code> and <code>useCallback</code>) that can <em>remove the need</em> for a dependency instead of incorrectly omitting it.</p>
<p><strong>🤔 Question: Do I need to specify functions as effect dependencies or not?</strong></p>
<p>The recommendation is to hoist functions that don’t need props or state <em>outside</em> of your component, and pull the ones that are used only by an effect <em>inside</em> of that effect.  If after that your effect still ends up using functions in the render scope (including function from props), wrap them into <code>useCallback</code> where they’re defined, and repeat the process. Why does it matter? Functions can “see” values from props and state — so they participate in the data flow. There’s a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies">more detailed answer</a> in our FAQ.</p>
<p><strong>🤔 Question: Why do I sometimes get an infinite refetching loop?</strong></p>
<p>This can happen if you’re doing data fetching in an effect without the second dependencies argument. Without it, effects run after every render — and setting the state will trigger the effects again. An infinite loop may also happen if you specify a value that <em>always</em> changes in the dependency array. You can tell which one by removing them one by one. However, removing a dependency you use (or blindly specifying <code>[]</code>) is usually the wrong fix. Instead, fix the problem at its source. For example, functions can cause this problem, and putting them inside effects, hoisting them out, or wrapping them with <code>useCallback</code> helps. To avoid recreating objects, <code>useMemo</code> can serve a similar purpose.</p>
<p><strong>🤔 Why do I sometimes get an old state or prop value inside my effect?</strong></p>
<p>Effects always “see” props and state from the render they were defined in. That <a class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/how-are-function-components-different-from-classes/">helps prevent bugs</a> but in some cases can be annoying. For those cases, you can explicitly maintain some value in a mutable ref (the linked article explains it at the end). If you think you’re seeing some props or state from an old render but don’t expect it, you probably missed some dependencies. Try using the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/facebook/react/issues/14920">lint rule</a> to train yourself to see them. A few days, and it’ll be like a second nature to you. See also <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-faq.html#why-am-i-seeing-stale-props-or-state-inside-my-function">this answer</a> in our FAQ.</p>
<hr/>
<p>I hope this TLDR was helpful! Otherwise, let’s go.</p>
<hr/>
<h2>Each Render Has Its Own Props and State</h2>
<p>Before we can talk about effects, we need to talk about rendering.</p>
<p>Here’s a counter. Look at the highlighted line closely:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        Click me</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>What does it mean? Does <code>count</code> somehow “watch” changes to our state and update automatically? That might be a useful first intuition when you learn React but it’s <em>not</em> an <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://overreacted.io/react-as-a-ui-runtime/">accurate mental model</a>.</p>
<p><strong>In this example, <code>count</code> is just a number.</strong> It’s not a magic “data binding”, a “watcher”, a “proxy”, or anything else. It’s a good old number like this one:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">42</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#637777">// ...</span></span></code></pre></div>
<p>The first time our component renders, the <code>count</code> variable we get from <code>useState()</code> is <code>0</code>. When we call <code>setCount(1)</code>, React calls our component again. This time, <code>count</code> will be <code>1</code>. And so on:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// During first render</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">0</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Returned by useState()</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// After a click, our function is called again</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Returned by useState()</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// After another click, our function is called again</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">2</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Returned by useState()</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><strong>Whenever we update the state, React calls our component. Each render result “sees” its own <code>counter</code> state value which is a <em>constant</em> inside our function.</strong></p>
<p>So this line doesn’t do any special data binding:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p><strong>It only embeds a number value into the render output.</strong> That number is provided by React. When we <code>setCount</code>, React calls our component again with a different <code>count</code> value. Then React updates the DOM to match our latest render output.</p>
<p>The key takeaway is that the <code>count</code> constant inside any particular render doesn’t change over time. It’s our component that’s called again — and each render “sees” its own <code>count</code> value that’s isolated between renders.</p>
<p><em>(For an in-depth overview of this process, check out my post <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://overreacted.io/react-as-a-ui-runtime/">React as a UI Runtime</a>.)</em></p>
<h2>Each Render Has Its Own Event Handlers</h2>
<p>So far so good. What about event handlers?</p>
<p>Look at this example. It shows an alert with the <code>count</code> after three seconds:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleAlertClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">alert</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">You clicked on: </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> count</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        Click me</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={</span><span style="color:#CED2D6">handleAlertClick</span><span style="color:#C792EA">}&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">        Show alert</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Let’s say I do this sequence of steps:</p>
<ul>
<li><strong>Increment</strong> the counter to 3</li>
<li><strong>Press</strong> “Show alert”</li>
<li><strong>Increment</strong> it to 5 before the timeout fires</li>
</ul>
<p><img src="./counter.gif" alt="Counter demo"/></p>
<p>What do you expect the alert to show? Will it show 5 — which is the counter state at the time of the alert? Or will it show 3 — the state when I clicked?</p>
<hr/>
<p><em>spoilers ahead</em></p>
<hr/>
<p>Go ahead and <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/w2wxl3yo0l">try it yourself!</a></p>
<p>If the behavior doesn’t quite make sense to you, imagine a more practical example: a chat app with the current recipient ID in the state, and a Send button. <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://overreacted.io/how-are-function-components-different-from-classes/">This article</a> explores the reasons in depth but the correct answer is 3.</p>
<p>The alert will “capture” the state at the time I clicked the button.</p>
<p><em>(There are ways to implement the other behavior too but I’ll be focusing on the default case for now. When building a mental model, it’s important that we distinguish the “path of least resistance” from the opt-in escape hatches.)</em></p>
<hr/>
<p>But how does it work?</p>
<p>We’ve discussed that the <code>count</code> value is constant for every particular call to our function. It’s worth emphasizing this — <strong>our function gets called many times (once per each render), but every one of those times the <code>count</code> value inside of it is constant and set to a particular value (state for that render).</strong></p>
<p>This is not specific to React — regular functions work in a similar way:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">sayHi</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">person</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">name</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> person</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">alert</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> name</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">someone</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Dan</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#8EACE3">sayHi</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">someone</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">someone </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Yuzhi</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#8EACE3">sayHi</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">someone</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">someone </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Dominic</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#8EACE3">sayHi</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">someone</span><span style="color:#C792EA">);</span></span></code></pre></div>
<p>In <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/mm6ww11lk8">this example</a>, the outer <code>someone</code> variable is reassigned several times. (Just like somewhere in React, the <em>current</em> component state can change.) <strong>However, inside <code>sayHi</code>, there is a local <code>name</code> constant that is associated with a <code>person</code> from a particular call.</strong> That constant is local, so it’s isolated between the calls! As a result, when the timeouts fire, each alert “remembers” its own <code>name</code>.</p>
<p>This explains how our event handler captures the <code>count</code> at the time of the click. If we apply the same substitution principle, each render “sees” its own <code>count</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// During first render</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">0</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Returned by useState()</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleAlertClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">alert</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">You clicked on: </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> count</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// After a click, our function is called again</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Returned by useState()</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleAlertClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">alert</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">You clicked on: </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> count</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// After another click, our function is called again</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">2</span><span style="color:#C792EA">;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Returned by useState()</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleAlertClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">alert</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">You clicked on: </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> count</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>So effectively, each render returns its own “version” of <code>handleAlertClick</code>. Each of those versions “remembers” its own <code>count</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// During first render</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleAlertClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">alert</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">You clicked on: </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={</span><span style="color:#CED2D6">handleAlertClick</span><span style="color:#C792EA">} /&gt;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// The one with 0 inside</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// After a click, our function is called again</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleAlertClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">alert</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">You clicked on: </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={</span><span style="color:#CED2D6">handleAlertClick</span><span style="color:#C792EA">} /&gt;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// The one with 1 inside</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// After another click, our function is called again</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">handleAlertClick</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">alert</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">You clicked on: </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">2</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={</span><span style="color:#CED2D6">handleAlertClick</span><span style="color:#C792EA">} /&gt;</span><span style="color:#CED2D6"> </span><span style="color:#637777">// The one with 2 inside</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>This is why <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/w2wxl3yo0l">in this demo</a> event handlers “belong” to a particular render, and when you click, it keeps using the <code>counter</code> state <em>from</em> that render.</p>
<p><strong>Inside any particular render, props and state forever stay the same.</strong> But if props and state are isolated between renders, so are any values using them (including the event handlers). They also “belong” to a particular render. So even async functions inside an event handler will “see” the same <code>count</code> value.</p>
<p><em>Side note: I inlined concrete <code>count</code> values right into <code>handleAlertClick</code> functions above. This mental substitution is safe because <code>count</code> can’t possibly change within a particular render. It’s declared as a <code>const</code> and is a number. It would be safe to think the same way about other values like objects too, but only if we agree to avoid mutating state. Calling <code>setSomething(newObj)</code> with a newly created object instead of mutating it is fine because state belonging to previous renders is intact.</em></p>
<h2>Each Render Has Its Own Effects</h2>
<p>This was supposed to be a post about effects but we still haven’t talked about effects yet! We’ll rectify this now. Turns out, effects aren’t really any different.</p>
<p>Let’s go back to an example from <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-effect.html">the docs</a>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#CED2D6">count</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        Click me</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><strong>Here’s a question for you: how does the effect read the latest <code>count</code> state?</strong></p>
<p>Maybe, there’s some kind of “data binding” or “watching” that makes <code>count</code> update live inside the effect function? Maybe <code>count</code> is a mutable variable that React sets inside our component so that our effect always sees the latest value?</p>
<p>Nope.</p>
<p>We already know that <code>count</code> is constant within a particular component render. Event handlers “see” the <code>count</code> state from the render that they “belong” to because <code>count</code> is a variable in their scope. The same is true for effects!</p>
<p><strong>It’s not the <code>count</code> variable that somehow changes inside an “unchanging” effect. It’s the <em>effect function itself</em> that’s different on every render.</strong></p>
<p>Each version “sees” the <code>count</code> value from the render that it “belongs” to:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// During first render</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Effect function from first render</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#F78C6C">0</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// After a click, our function is called again</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Effect function from second render</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#F78C6C">1</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// After another click, our function is called again</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Effect function from third render</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#F78C6C">2</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ..</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>React remembers the effect function you provided, and runs it after flushing changes to the DOM and letting the browser paint the screen.</p>
<p>So even if we speak of a single conceptual <em>effect</em> here (updating the document title), it is represented by a <em>different function</em> on every render — and each effect function “sees” props and state from the particular render it “belongs” to.</p>
<p><strong>Conceptually, you can imagine effects are a <em>part of the render result</em>.</strong></p>
<p>Strictly saying, they’re not (in order to <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://overreacted.io/why-do-hooks-rely-on-call-order/">allow Hook composition</a> without clumsy syntax or runtime overhead). But in the mental model we’re building up, effect functions <em>belong</em> to a particular render in the same way that event handlers do.</p>
<hr/>
<p>To make sure we have a solid understanding, let’s recap our first render:</p>
<ul>
<li><strong>React:</strong> Give me the UI when the state is <code>0</code>.</li>
<li><strong>Your component:</strong>
<ul>
<li>Here’s the render result:
<code>&lt;p&gt;You clicked 0 times&lt;/p&gt;</code>.</li>
<li>Also remember to run this effect after you’re done: <code>() =&gt; { document.title = &#x27;You clicked 0 times&#x27; }</code>.</li>
</ul>
</li>
<li><strong>React:</strong> Sure. Updating the UI. Hey browser, I’m adding some stuff to the DOM.</li>
<li><strong>Browser:</strong> Cool, I painted it to the screen.</li>
<li><strong>React:</strong> OK, now I’m going to run the effect you gave me.<!-- -->
<ul>
<li>Running <code>() =&gt; { document.title = &#x27;You clicked 0 times&#x27; }</code>.</li>
</ul>
</li>
</ul>
<hr/>
<p>Now let’s recap what happens after we click:</p>
<ul>
<li><strong>Your component:</strong> Hey React, set my state to <code>1</code>.</li>
<li><strong>React:</strong> Give me the UI for when the state is <code>1</code>.</li>
<li><strong>Your component:</strong>
<ul>
<li>Here’s the render result:
<code>&lt;p&gt;You clicked 1 times&lt;/p&gt;</code>.</li>
<li>Also remember to run this effect after you’re done: <code>() =&gt; { document.title = &#x27;You clicked 1 times&#x27; }</code>.</li>
</ul>
</li>
<li><strong>React:</strong> Sure. Updating the UI. Hey browser, I’ve changed the DOM.</li>
<li><strong>Browser:</strong> Cool, I painted your changes to the screen.</li>
<li><strong>React:</strong> OK, now I’ll run the effect that belongs to the render I just did.<!-- -->
<ul>
<li>Running <code>() =&gt; { document.title = &#x27;You clicked 1 times&#x27; }</code>.</li>
</ul>
</li>
</ul>
<hr/>
<h2>Each Render Has Its Own… Everything</h2>
<p><strong>We know now that effects run after every render, are conceptually a part of the component output, and “see” the props and state from that particular render.</strong></p>
<p>Let’s try a thought experiment. Consider this code:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">console</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">log</span><span style="color:#C792EA">(</span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#CED2D6">count</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span><span style="color:#CED2D6">You clicked </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> times</span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">p</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">        Click me</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">div</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>If I click several times with a small delay, what is the log going to look like?</p>
<hr/>
<p><em>spoilers ahead</em></p>
<hr/>
<p>You might think this is a gotcha and the end result is unintuitive. It’s not! We’re going to see a sequence of logs — each one belonging to a particular render and thus with its own <code>count</code> value. You can <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/lyx20m1ol">try it yourself</a>:</p>
<p><img src="./timeout_counter.gif" alt="Screen recording of 1, 2, 3, 4, 5 logged in order"/></p>
<p>You may think: “Of course that’s how it works! How else could it work?”</p>
<p>Well, that’s not how <code>this.state</code> works in classes. It’s easy to make the mistake of thinking that this <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/kkymzwjqz3">class implementation</a> is equivalent:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidUpdate</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">console</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">log</span><span style="color:#C792EA">(</span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">count</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>However, <code>this.state.count</code> always points at the <em>latest</em> count rather than the one belonging to a particular render. So you’ll see <code>5</code> logged each time instead:</p>
<p><img src="./timeout_counter_class.gif" alt="Screen recording of 5, 5, 5, 5, 5 logged in order"/></p>
<p>I think it’s ironic that Hooks rely so much on JavaScript closures, and yet it’s the class implementation that suffers from <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://wsvincent.com/javascript-closure-settimeout-for-loop/">the canonical wrong-value-in-a-timeout confusion</a> that’s often associated with closures. This is because the actual source of the confusion in this example is the mutation (React mutates <code>this.state</code> in classes to point to the latest state) and not closures themselves.</p>
<p><strong>Closures are great when the values you close over never change. That makes them easy to think about because you’re essentially referring to constants.</strong> And as we discussed, props and state never change within a particular render. By the way, we can fix the class version… by <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/w7vjo07055">using a closure</a>.</p>
<h2>Swimming Against the Tide</h2>
<p>At this point it’s important that we call it out explicitly: <strong>every</strong> function inside the component render (including event handlers, effects, timeouts or API calls inside them) captures the props and state of the render call that defined it.</p>
<p>So these two examples are equivalent:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">console</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">log</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">counter</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">counter</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">counter</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">console</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">log</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">counter</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><strong>It doesn’t matter whether you read from props or state “early” inside of your component.</strong> They’re not going to change! Inside the scope of a single render, props and state stay the same. (Destructuring props makes this more obvious.)</p>
<p>Of course, sometimes you <em>want</em> to read the latest rather than captured value inside some callback defined in an effect. The easiest way to do it is by using refs, as described in the last section of <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://overreacted.io/how-are-function-components-different-from-classes/">this article</a>.</p>
<p>Be aware that when you want to read the <em>future</em> props or state from a function in a <em>past</em> render, you’re swimming against the tide. It’s not <em>wrong</em> (and in some cases necessary) but it might look less “clean” to break out of the paradigm. This is an intentional consequence because it helps highlight which code is fragile and depends on timing. In classes, it’s less obvious when this happens.</p>
<p>Here’s a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/rm7z22qnlp">version of our counter example</a> that replicates the class behavior:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">latestCount</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useRef</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Set the mutable latest value</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">latestCount</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">current </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> count</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setTimeout</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#637777">// Read the mutable latest value</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">console</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">log</span><span style="color:#C792EA">(</span><span style="color:#C792EA">`You clicked </span><span style="color:#7986E7">${</span><span style="color:#FFA7C4">latestCount</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">current</span><span style="color:#7986E7">}</span><span style="color:#C792EA"> times`</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">3000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span></code></pre></div>
<p><img src="./timeout_counter_refs.gif" alt="Screen recording of 5, 5, 5, 5, 5 logged in order"/></p>
<p>It might seem quirky to mutate something in React. However, this is exactly how React itself reassigns <code>this.state</code> in classes. Unlike with captured props and state, you don’t have any guarantees that reading <code>latestCount.current</code> would give you the same value in any particular callback. By definition, you can mutate it any time. This is why it’s not a default, and you have to opt into that.</p>
<h2>So What About Cleanup?</h2>
<p>As <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-effect.html#effects-with-cleanup">the docs explain</a>, some effects might have a cleanup phase. Essentially, its purpose is to “undo” an effect for cases like subscriptions.</p>
<p>Consider this code:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">ChatAPI</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">subscribeToFriendStatus</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> handleStatusChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">ChatAPI</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">unsubscribeFromFriendStatus</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> handleStatusChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span></code></pre></div>
<p>Say <code>props</code> is <code>{id: 10}</code> on the first render, and <code>{id: 20}</code> on the second render. You <em>might</em> think that something like this happens:</p>
<ul>
<li>React cleans up the effect for <code>{id: 10}</code>.</li>
<li>React renders UI for <code>{id: 20}</code>.</li>
<li>React runs the effect for <code>{id: 20}</code>.</li>
</ul>
<p>(This is not quite the case.)</p>
<p>With this mental model, you might think the cleanup “sees” the old props because it runs before we re-render, and then the new effect “sees” the new props because it runs after the re-render. That’s the mental model lifted directly from the class lifecycles, and <strong>it’s not accurate here</strong>. Let’s see why.</p>
<p>React only runs the effects after <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://medium.com/@dan_abramov/this-benchmark-is-indeed-flawed-c3d6b5b6f97f">letting the browser paint</a>. This makes your app faster as most effects don’t need to block screen updates. Effect cleanup is also delayed. <strong>The previous effect is cleaned up <em>after</em> the re-render with new props:</strong></p>
<ul>
<li><strong>React renders UI for <code>{id: 20}</code>.</strong></li>
<li>The browser paints. We see the UI for <code>{id: 20}</code> on the screen.</li>
<li><strong>React cleans up the effect for <code>{id: 10}</code>.</strong></li>
<li>React runs the effect for <code>{id: 20}</code>.</li>
</ul>
<p>You might be wondering: but how can the cleanup of the previous effect still “see” the old <code>{id: 10}</code> props if it runs <em>after</em> the props change to <code>{id: 20}</code>?</p>
<p>We’ve been here before… 🤔</p>
<p><img src="./deja_vu.gif" alt="Deja vu (cat scene from the Matrix movie)"/></p>
<p>Quoting the previous section:</p>
<blockquote>
<p>Every function inside the component render (including event handlers, effects, timeouts or API calls inside them) captures the props and state of the render call that defined it.</p>
</blockquote>
<p>Now the answer is clear! The effect cleanup doesn’t read the “latest” props, whatever that means. It reads props that belong to the render it’s defined in:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// First render, props are {id: 10}</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Effect from first render</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">ChatAPI</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">subscribeToFriendStatus</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">10</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> handleStatusChange</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#637777">// Cleanup for effect from first render</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">        </span><span style="color:#FFA7C4">ChatAPI</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">unsubscribeFromFriendStatus</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">10</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> handleStatusChange</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// Next render, props are {id: 20}</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Example</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Effect from second render</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">ChatAPI</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">subscribeToFriendStatus</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">20</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> handleStatusChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#637777">// Cleanup for effect from second render</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">        </span><span style="color:#FFA7C4">ChatAPI</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">unsubscribeFromFriendStatus</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">20</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> handleStatusChange</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Kingdoms will rise and turn into ashes, the Sun will shed its outer layers to be a white dwarf, and the last civilization will end. But nothing will make the props “seen” by the first render effect’s cleanup anything other than <code>{id: 10}</code>.</p>
<p>That’s what allows React to deal with effects right after painting — and make your apps faster by default. The old props are still there if our code needs them.</p>
<h2>Synchronization, Not Lifecycle</h2>
<p>One of my favorite things about React is that it unifies describing the initial render result and the updates. This <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://overreacted.io/the-bug-o-notation/">reduces the entropy</a> of your program.</p>
<p>Say my component looks like this:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Greeting</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ name }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">Greeting</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      Hello, </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>It doesn’t matter if I render <code>&lt;Greeting name=&quot;Dan&quot; /&gt;</code> and later <code>&lt;Greeting name=&quot;Yuzhi&quot; /&gt;</code>, or if I just render <code>&lt;Greeting name=&quot;Yuzhi&quot; /&gt;</code>. In the end, we will see “Hello, Yuzhi” in both cases.</p>
<p>People say: “It’s all about the journey, not the destination”. With React, it’s the opposite. <strong>It’s all about the destination, not the journey.</strong> That’s the difference between <code>$.addClass</code> and <code>$.removeClass</code> calls in jQuery code (our “journey”) and specifying what the CSS class <em>should be</em> in React code (our “destination”).</p>
<p><strong>React synchronizes the DOM according to our current props and state.</strong> There is no distinction between a “mount” or an “update” when rendering.</p>
<p>You should think of effects in a similar way. <strong><code>useEffect</code> lets you <em>synchronize</em> things outside of the React tree according to our props and state.</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Greeting</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ name }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> name</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">Greeting</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      Hello, </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>This is subtly different from the familiar <em>mount/update/unmount</em> mental model. It is important really to internalize this. <strong>If you’re trying to write an effect that behaves differently depending on whether the component renders for the first time or not, you’re swimming against the tide!</strong> We’re failing at synchronizing if our result depends on the “journey” rather than the “destination”.</p>
<p>It shouldn’t matter whether we rendered with props A, B, and C, or if we rendered with C immediately. While there may be some temporary differences (e.g. while we’re fetching data), eventually the end result should be the same.</p>
<p>Still, of course running all effects on <em>every</em> render might not be efficient. (And in some cases, it would lead to infinite loops.)</p>
<p>So how can we fix this?</p>
<h2>Teaching React to Diff Your Effects</h2>
<p>We’ve already learned that lesson with the DOM itself. Instead of touching it on every re-render, React only updates the parts of the DOM that actually change.</p>
<p>When you’re updating</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">Greeting</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  Hello, Dan</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p>to</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">Greeting</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  Hello, Yuzhi</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p>React sees two objects:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">oldProps</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">className</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Greeting</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">children</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, Dan</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">newProps</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">className</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Greeting</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">children</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, Yuzhi</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">};</span></span></code></pre></div>
<p>It goes over each of their props and determine that <code>children</code> have changed and need a DOM update, but <code>className</code> did not. So it can just do:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">domNode</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">innerText </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, Yuzhi</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#637777">// No need to touch domNode.className</span></span></code></pre></div>
<p><strong>Could we do something like this with effects too? It would be nice to avoid re-running them when applying the effect is unnecessary.</strong></p>
<p>For example, maybe our component re-renders because of a state change:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Greeting</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ name }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">counter</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCounter</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> name</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA"> className=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">Greeting</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      Hello, </span><span style="color:#C792EA">{</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">}</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA"> onClick={() </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setCounter</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#C792EA"> + </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">)}&gt;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">        Increment</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">button</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>But our effect doesn’t use the <code>counter</code> state. <strong>Our effect synchronizes the <code>document.title</code> with the <code>name</code> prop, but the <code>name</code> prop is the same.</strong> Re-assigning <code>document.title</code> on every counter change seems non-ideal.</p>
<p>OK, so can React just… diff effects?</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#8EACE3">oldEffect</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, Dan</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#FFA7C4">let </span><span style="color:#8EACE3">newEffect</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, Dan</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#637777">// Can React see these functions do the same thing?</span></span></code></pre></div>
<p>Not really. React can’t guess what the function does without calling it. (The source doesn’t really contain specific values, it just closes over the <code>name</code> prop.)</p>
<p>This is why if you want to avoid re-running effects unnecessarily, you can provide a dependency array (also known as “deps”) argument to <code>useEffect</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> name</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Our deps</span></span></code></pre></div>
<p><strong>It’s like if we told React: “Hey, I know you can’t see <em>inside</em> this function, but I promise it only uses <code>name</code> and nothing else from the render scope.”</strong></p>
<p>If each of these values is the same between the current and the previous time this effect ran, there’s nothing to synchronize so React can skip the effect:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#8EACE3">oldEffect</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, Dan</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">oldDeps</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Dan</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">];</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#8EACE3">newEffect</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4"> document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, Dan</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">newDeps</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Dan</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">];</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// React can&#x27;t peek inside of functions, but it can compare deps.</span></span>
<span data-line=""><span style="color:#637777">// Since all deps are the same, it doesn’t need to run the new effect.</span></span></code></pre></div>
<p>If even one of the values in the dependency array is different between renders, we know running the effect can’t be skipped. Synchronize all the things!</p>
<h2>Don’t Lie to React About Dependencies</h2>
<p>Lying to React about dependencies has bad consequences. Intuitively, this makes sense, but I’ve seen pretty much everyone who tries <code>useEffect</code> with a mental model from classes try to cheat the rules. (And I did that too at first!)</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Is this okay? Not always -- and there&#x27;s a better way to write it.</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><em>(The <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies">Hooks FAQ</a> explains what to do instead. We’ll come back to this example <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="#moving-functions-inside-effects">below</a>.)</em></p>
<p>“But I only want to run it on mount!”, you’ll say. For now, remember: if you specify deps, <strong><em>all</em> values from inside your component that are used by the effect <em>must</em> be there</strong>. Including props, state, functions — anything in your component.</p>
<p>Sometimes when you do that, it causes a problem. For example, maybe you see an infinite refetching loop, or a socket is recreated too often. <strong>The solution to that problem is <em>not</em> to remove a dependency.</strong> We’ll look at the solutions soon.</p>
<p>But before we jump to solutions, let’s understand the problem better.</p>
<h2>What Happens When Dependencies Lie</h2>
<p>If deps contain every value used by the effect, React knows when to re-run it:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> name</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">name</span><span style="color:#C792EA">]);</span></span></code></pre></div>
<p><img src="./deps-compare-correct.gif" alt="Diagram of effects replacing one another"/></p>
<p><em>(Dependencies are different, so we re-run the effect.)</em></p>
<p>But if we specified <code>[]</code> for this effect, the new effect function wouldn’t run:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">document</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">title </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">Hello, </span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> name</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Wrong: name is missing in deps</span></span></code></pre></div>
<p><img src="./deps-compare-wrong.gif" alt="Diagram of effects replacing one another"/></p>
<p><em>(Dependencies are equal, so we skip the effect.)</em></p>
<p>In this case the problem might seem obvious. But the intuition can fool you in other cases where a class solution “jumps out” from your memory.</p>
<p>For example, let’s say we’re writing a counter that increments every second. With a class, our intuition is: “Set up the interval once and destroy it once”. Here’s an <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/n5mjzjy9kl">example</a> of how we can do it. When we mentally translate this code to <code>useEffect</code>, we instinctively add <code>[]</code> to the deps. “I want it to run once”, right?</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#FFA7C4">      </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>However, this example <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/91n5z8jo7r">only <em>increments</em> once</a>. <em>Oops.</em></p>
<p>If your mental model is “dependencies let me specify when I want to re-trigger the effect”, this example might give you an existential crisis. You <em>want</em> to trigger it once because it’s an interval — so why is it causing issues?</p>
<p>However, this makes sense if you know that dependencies are our hint to React about <em>everything</em> that the effect uses from the render scope. It uses <code>count</code> but we lied that it doesn’t with <code>[]</code>. It’s only a matter of time before this bites us!</p>
<p>In the first render, <code>count</code> is <code>0</code>. Therefore, <code>setCount(count + 1)</code> in the first render’s effect means <code>setCount(0 + 1)</code>. <strong>Since we never re-run the effect because of <code>[]</code> deps, it will keep calling <code>setCount(0 + 1)</code> every second:</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// First render, state is 0</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Effect from first render</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">        </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span><span style="color:#FFA7C4"> </span><span style="color:#637777">// Always setCount(1)</span></span>
<span data-line=""><span style="color:#FFA7C4">      </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">[]</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Never re-runs</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// Every next render, state is 1</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// This effect is always ignored because</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// we lied to React about empty deps.</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#FFA7C4">        </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">1</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">      </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">[]</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>We lied to React by saying our effect doesn’t depend on a value from inside our component, when in fact it does!</p>
<p>Our effect uses <code>count</code> — a value inside the component (but outside the effect):</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#637777">// ...</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">      </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span></span></code></pre></div>
<p>Therefore, specifying <code>[]</code> as a dependency will create a bug. React will compare the dependencies, and skip updating this effect:</p>
<p><img src="./interval-wrong.gif" alt="Diagram of stale interval closure"/></p>
<p><em>(Dependencies are equal, so we skip the effect.)</em></p>
<p>Issues like this are difficult to think about. Therefore, I encourage you to adopt it as a hard rule to always be honest about the effect dependencies, and specify them all. (We provide a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/facebook/react/issues/14920">lint rule</a> if you want to enforce this on your team.)</p>
<h2>Two Ways to Be Honest About Dependencies</h2>
<p>There are two strategies to be honest about dependencies. You should generally start with the first one, and then apply the second one if needed.</p>
<p><strong>The first strategy is to fix the dependency array to include <em>all</em> the values inside the component that are used inside the effect.</strong> Let’s include <code>count</code> as a dep:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">    </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">  </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">]);</span></span></code></pre></div>
<p>This makes the dependency array correct. It may not be <em>ideal</em> but that’s the first issue we needed to fix. Now a change to <code>count</code> will re-run the effect, with each next interval referencing <code>count</code> from its render in <code>setCount(count + 1)</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// First render, state is 0</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Effect from first render</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">        </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span><span style="color:#FFA7C4"> </span><span style="color:#637777">// setCount(count + 1)</span></span>
<span data-line=""><span style="color:#FFA7C4">      </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">[</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">]</span><span style="color:#CED2D6"> </span><span style="color:#637777">// [count]</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// Second render, state is 1</span></span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// Effect from second render</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">        </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">1</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span><span style="color:#FFA7C4"> </span><span style="color:#637777">// setCount(count + 1)</span></span>
<span data-line=""><span style="color:#FFA7C4">      </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">},</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">[</span><span style="color:#F78C6C">1</span><span style="color:#C792EA">]</span><span style="color:#CED2D6"> </span><span style="color:#637777">// [count]</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>That would <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/0x0mnlyq8l">fix the problem</a> but our interval would be cleared and set again whenever the <code>count</code> changes. That may be undesirable:</p>
<p><img src="./interval-rightish.gif" alt="Diagram of interval that re-subscribes"/></p>
<p><em>(Dependencies are different, so we re-run the effect.)</em></p>
<hr/>
<p><strong>The second strategy is to change our effect code so that it wouldn’t <em>need</em> a value that changes more often than we want.</strong> We don’t want to lie about the dependencies — we just want to change our effect to have <em>fewer</em> of them.</p>
<p>Let’s look at a few common techniques for removing dependencies.</p>
<hr/>
<h2>Making Effects Self-Sufficient</h2>
<p>We want to get rid of the <code>count</code> dependency in our effect.</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">      </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">]);</span></span></code></pre></div>
<p>To do this, we need to ask ourselves: <strong>what are we using <code>count</code> for?</strong> It seems like we only use it for the <code>setCount</code> call. In that case, we don’t actually need <code>count</code> in the scope at all. When we want to update state based on the previous state, we can use the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-reference.html#functional-updates">functional updater form</a> of <code>setState</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">      </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">c</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#CED2D6">c</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span></span></code></pre></div>
<p>I like to think of these cases as “false dependencies”. Yes, <code>count</code> was a necessary dependency because we wrote <code>setCount(count + 1)</code> inside the effect. However, we only truly needed <code>count</code> to transform it into <code>count + 1</code> and “send it back” to React. But React <em>already knows</em> the current <code>count</code>. <strong>All we needed to tell React is to increment the state — whatever it is right now.</strong></p>
<p>That’s exactly what <code>setCount(c =&gt; c + 1)</code> does. You can think of it as “sending an instruction” to React about how the state should change. This “updater form” also helps in other cases, like when you <a class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/react-as-a-ui-runtime/#batching">batch multiple updates</a>.</p>
<p><strong>Note that we actually <em>did the work</em> to remove the dependency. We didn’t cheat. Our effect doesn’t read the <code>counter</code> value from the render scope anymore:</strong></p>
<p><img src="./interval-right.gif" alt="Diagram of interval that works"/></p>
<p><em>(Dependencies are equal, so we skip the effect.)</em></p>
<p>You can try it <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/q3181xz1pj">here</a>.</p>
<p>Even though this effect only runs once, the interval callback that belongs to the first render is perfectly capable of sending the <code>c =&gt; c + 1</code> update instruction every time the interval fires. It doesn’t need to know the current <code>counter</code> state anymore. React already knows it.</p>
<h2>Functional Updates and Google Docs</h2>
<p>Remember how we talked about synchronization being the mental model for effects? An interesting aspect of synchronization is that you often want to keep the “messages” between the systems untangled from their state. For example, editing a document in Google Docs doesn’t actually send the <em>whole</em> page to the server. That would be very inefficient. Instead, it sends a representation of what the user tried to do.</p>
<p>While our use case is different, a similar philosophy applies to effects. <strong>It helps to send only the minimal necessary information from inside the effects into a component.</strong> The updater form like <code>setCount(c =&gt; c + 1)</code> conveys strictly less information than <code>setCount(count + 1)</code> because it isn’t “tainted” by the current count. It only expresses the action (“incrementing”). Thinking in React involves <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/thinking-in-react.html#step-3-identify-the-minimal-but-complete-representation-of-ui-state">finding the minimal state</a>. This is the same principle, but for updates.</p>
<p>Encoding the <em>intent</em> (rather than the result) is similar to how Google Docs <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://medium.com/@srijancse/how-real-time-collaborative-editing-work-operational-transformation-ac4902d75682">solves</a> collaborative editing. While this is stretching the analogy, functional updates serve a similar role in React. They ensure updates from multiple sources (event handlers, effect subscriptions, etc) can be correctly applied in a batch and in a predictable way.</p>
<p><strong>However, even <code>setCount(c =&gt; c + 1)</code> isn’t that great.</strong> It looks a bit weird and it’s very limited in what it can do. For example, if we had two state variables whose values depend on each other, or if we needed to calculate the next state based on a prop, it wouldn’t help us. Luckily, <code>setCount(c =&gt; c + 1)</code> has a more powerful sister pattern. Its name is <code>useReducer</code>.</p>
<h2>Decoupling Updates from Actions</h2>
<p>Let’s modify the previous example to have two state variables: <code>count</code> and <code>step</code>. Our interval will increment the count by the value of the <code>step</code> input:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setCount</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">step</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setStep</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">1</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">      </span><span style="color:#8EACE3">setCount</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">c</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#CED2D6">c</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">step</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">step</span><span style="color:#C792EA">]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">input</span><span style="color:#C792EA"> value={</span><span style="color:#CED2D6">step</span><span style="color:#C792EA">} onChange={</span><span style="color:#CED2D6">e</span><span style="color:#C792EA"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#C792EA"> </span><span style="color:#8EACE3">setStep</span><span style="color:#C792EA">(</span><span style="color:#8EACE3">Number</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">e</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">target</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">value</span><span style="color:#C792EA">))} /&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">&lt;/&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>(Here’s a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/zxn70rnkx">demo</a>.)</p>
<p>Note that <strong>we’re not cheating</strong>. Since I started using <code>step</code> inside the effect, I added it to the dependencies. And that’s why the code runs correctly.</p>
<p>The current behavior in this example is that changing the <code>step</code> restarts the interval — because it’s one of the dependencies. And in many cases, that is exactly what you want! There’s nothing wrong with tearing down an effect and setting it up anew, and we shouldn’t avoid that unless we have a good reason.</p>
<p>However, let’s say we want the interval clock to not reset on changes to the <code>step</code>. How do we remove the <code>step</code> dependency from our effect?</p>
<p><strong>When setting a state variable depends on the current value of another state variable, you might want to try replacing them both with <code>useReducer</code>.</strong></p>
<p>When you find yourself writing <code>setSomething(something =&gt; ...)</code>, it’s a good time to consider using a reducer instead. A reducer lets you <strong>decouple expressing the “actions” that happened in your component from how the state updates in response to them</strong>.</p>
<p>Let’s trade the <code>step</code> dependency for a <code>dispatch</code> dependency in our effect:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">dispatch</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useReducer</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">reducer</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">initialState</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#FFA7C4">const { </span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">step</span><span style="color:#FFA7C4"> } </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">state</span><span style="color:#C792EA">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">    </span><span style="color:#8EACE3">dispatch</span><span style="color:#C792EA">({</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">type</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">tick</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">});</span><span style="color:#FFA7C4"> </span><span style="color:#637777">// Instead of setCount(c =&gt; c + step);</span></span>
<span data-line=""><span style="color:#FFA7C4">  </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">dispatch</span><span style="color:#C792EA">]);</span></span></code></pre></div>
<p>(See the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/xzr480k0np">demo</a>.)</p>
<p>You might ask me: “How is this any better?” The answer is that <strong>React guarantees the <code>dispatch</code> function to be constant throughout the component lifetime. So the example above doesn’t ever need to resubscribe the interval.</strong></p>
<p>We solved our problem!</p>
<p><em>(You may omit <code>dispatch</code>, <code>setState</code>, and <code>useRef</code> container values from the deps because React guarantees them to be static. But it also doesn’t hurt to specify them.)</em></p>
<p>Instead of reading the state <em>inside</em> an effect, it dispatches an <em>action</em> that encodes the information about <em>what happened</em>. This allows our effect to stay decoupled from the <code>step</code> state. Our effect doesn’t care <em>how</em> we update the state, it just tells us about <em>what happened</em>. And the reducer centralizes the update logic:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">initialState</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#FFA7C4">  </span><span style="color:#CED2D6">count</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">0</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#FFA7C4">  </span><span style="color:#CED2D6">step</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#F78C6C">1</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#C792EA">};</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">reducer</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> action</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const { </span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">step</span><span style="color:#FFA7C4"> } </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">state</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">action</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">type </span><span style="color:#C792EA">===</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">tick</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> count</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> count </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> step</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> step </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">else</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">action</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">type </span><span style="color:#C792EA">===</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">step</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> count</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> step</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">action</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">step </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">else</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">throw</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">new</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Error</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>(Here’s a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/xzr480k0np">demo</a> if you missed it earlier).</p>
<h2>Why useReducer Is the Cheat Mode of Hooks</h2>
<p>We’ve seen how to remove dependencies when an effect needs to set state based on previous state, or on another state variable. <strong>But what if we need <em>props</em> to calculate the next state?</strong> For example, maybe our API is <code>&lt;Counter step={1} /&gt;</code>. Surely, in this case we can’t avoid specifying <code>props.step</code> as a dependency?</p>
<p>In fact, we can! We can put <em>the reducer itself</em> inside our component to read props:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Counter</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ step }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">dispatch</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useReducer</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">reducer</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">0</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">reducer</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> action</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">action</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">type </span><span style="color:#C792EA">===</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">tick</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> state </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> step</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">else</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">throw</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">new</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Error</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">id</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">setInterval</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#FFA7C4">      </span><span style="color:#8EACE3">dispatch</span><span style="color:#C792EA">({</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">type</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">tick</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">},</span><span style="color:#FFA7C4"> </span><span style="color:#F78C6C">1000</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">clearInterval</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">dispatch</span><span style="color:#C792EA">]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;{</span><span style="color:#CED2D6">count</span><span style="color:#C792EA">}&lt;/</span><span style="color:#FFA7C4">h1</span><span style="color:#C792EA">&gt;;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>This pattern disables a few optimizations so try not to use it everywhere, but you can totally access props from a reducer if you need to. (Here’s a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/7ypm405o8q">demo</a>.)</p>
<p><strong>Even in that case, <code>dispatch</code> identity is still guaranteed to be stable between re-renders.</strong> So you may omit it from the effect deps if you want. It’s not going to cause the effect to re-run.</p>
<p>You may be wondering: how can this possibly work? How can the reducer “know” props when called from inside an effect that belongs to another render? The answer is that when you <code>dispatch</code>, React just remembers the action — but it will <em>call</em> your reducer during the next render. At that point the fresh props will be in scope, and you won’t be inside an effect.</p>
<p><strong>This is why I like to think of <code>useReducer</code> as the “cheat mode” of Hooks. It lets me decouple the update logic from describing what happened. This, in turn, helps me remove unnecessary dependencies from my effects and avoid re-running them more often than necessary.</strong></p>
<h2>Moving Functions Inside Effects</h2>
<p>A common mistake is to think functions shouldn’t be dependencies. For example, this seems like it could work:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">data</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setData</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">({</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">hits</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">result</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> await </span><span style="color:#8EACE3">axios</span><span style="color:#C792EA">(</span></span>
<span data-line=""><span style="color:#FFA7C4">      </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#FFA7C4">    </span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setData</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">result</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">data</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// Is this okay?</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span></code></pre></div>
<p><em>(<a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/8j4ykjyv0">This example</a> is adapted from a great article by Robin Wieruch — <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://www.robinwieruch.de/react-hooks-fetch-data/">check it out</a>!)</em></p>
<p>And to be clear, this code <em>does</em> work. <strong>But the problem with simply omitting local functions is that it gets pretty hard to tell whether we’re handling all cases as the component grows!</strong></p>
<p>Imagine our code was split like this and each function was five times larger:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Imagine this function is long</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Imagine this function is also long</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">result</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> await </span><span style="color:#8EACE3">axios</span><span style="color:#C792EA">(</span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">());</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setData</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">result</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">data</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Now let’s say we later use some state or prop in one of these functions:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setQuery</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Imagine this function is also long</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> query</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Imagine this function is also long</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">result</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> await </span><span style="color:#8EACE3">axios</span><span style="color:#C792EA">(</span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">());</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">setData</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">result</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">data</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>If we forget to update the deps of any effects that call these functions (possibly, through other functions!), our effects will fail to synchronize changes from our props and state. This doesn’t sound great.</p>
<p>Luckily, there is an easy solution to this problem. <strong>If you only use some functions <em>inside</em> an effect, move them directly <em>into</em> that effect:</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// We moved these functions inside!</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line="" data-highlighted-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">result</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> await </span><span style="color:#8EACE3">axios</span><span style="color:#C792EA">(</span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">());</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">setData</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">result</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">data</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// ✅ Deps are OK</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>(<a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/04kp3jwwql">Here’s a demo</a>.)</p>
<p>So what is the benefit? We no longer have to think about the “transitive dependencies”. Our dependencies array isn’t lying anymore: <strong>we truly <em>aren’t</em> using anything from the outer scope of the component in our effect</strong>.</p>
<p>If we later edit <code>getFetchUrl</code> to use the <code>query</code> state, we’re much more likely to notice that we’re editing it <em>inside</em> an effect — and therefore, we need to add <code>query</code> to the effect dependencies:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setQuery</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> query</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">result</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> await </span><span style="color:#8EACE3">axios</span><span style="color:#C792EA">(</span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">());</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#8EACE3">setData</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">result</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">data</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// ✅ Deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>(Here’s a <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://codesandbox.io/s/pwm32zx7z7">demo</a>.)</p>
<p>By adding this dependency, we’re not just “appeasing React”. It <em>makes sense</em> to refetch the data when the query changes. <strong>The design of <code>useEffect</code> forces you to notice the change in our data flow and choose how our effects should synchronize it — instead of ignoring it until our product users hit a bug.</strong></p>
<p>Thanks to the <code>exhaustive-deps</code> lint rule from the <code>eslint-plugin-react-hooks</code> plugin, you can <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/facebook/react/issues/14920">analyze the effects as you type in your editor</a> and receive suggestions about which dependencies are missing. In other words, a machine can tell you which data flow changes aren’t handled correctly by a component.</p>
<p><img src="./exhaustive-deps.gif" alt="Lint rule gif"/></p>
<p>Pretty sweet.</p>
<h2>But I Can’t Put This Function Inside an Effect</h2>
<p>Sometimes you might not want to move a function <em>inside</em> an effect. For example, several effects in the same component may call the same function, and you don’t want to copy and paste its logic. Or maybe it’s a prop.</p>
<p>Should you skip a function like this in the effect dependencies? I think not. Again, <strong>effects shouldn’t lie about their dependencies.</strong> There are usually better solutions. A common misconception is that “a function would never change”. But as we learned throughout this article, this couldn’t be further from truth. Indeed, a function defined inside a component changes on every render!</p>
<p><strong>That by itself presents a problem.</strong> Say two effects call <code>getFetchUrl</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> query</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// 🔴 Missing dep: getFetchUrl</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">redux</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// 🔴 Missing dep: getFetchUrl</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>In that case you might not want to move <code>getFetchUrl</code> inside either of the effects since you wouldn’t be able to share the logic.</p>
<p>On the other hand, if you’re “honest” about the effect dependencies, you may run into a problem. Since both our effects depend on <code>getFetchUrl</code> <strong>(which is different on every render)</strong>, our dependency arrays are useless:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// 🔴 Re-triggers all effects on every render</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> query</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">getFetchUrl</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// 🚧 Deps are correct but they change too often</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">redux</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">getFetchUrl</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// 🚧 Deps are correct but they change too often</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>A tempting solution to this is to just skip the <code>getFetchUrl</code> function in the deps list. However, I don’t think it’s a good solution. This makes it difficult to notice when we <em>are</em> adding a change to the data flow that <em>needs</em> to be handled by an effect. This leads to bugs like the “never updating interval” we saw earlier.</p>
<p>Instead, there are two other solutions that are simpler.</p>
<p><strong>First of all, if a function doesn’t use anything from the component scope, you can hoist it outside the component and then freely use it inside your effects:</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line="" data-highlighted-line=""><span style="color:#637777">// ✅ Not affected by the data flow</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">+</span><span style="color:#CED2D6"> query</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// ✅ Deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">redux</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// ✅ Deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>There’s no need to specify it in deps because it’s not in the render scope and can’t be affected by the data flow. It can’t accidentally depend on props or state.</p>
<p>Alternatively, you can wrap it into the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-reference.html#usecallback"><code>useCallback</code> Hook</a>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ✅ Preserves identity when its own deps are the same</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">getFetchUrl</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useCallback</span><span style="color:#C792EA">((</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">)</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">    return </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">query</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6">  </span><span style="color:#637777">// ✅ Callback deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">getFetchUrl</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// ✅ Effect deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">redux</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">getFetchUrl</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// ✅ Effect deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><code>useCallback</code> is essentially like adding another layer of dependency checks. It’s solving the problem on the other end — <strong>rather than avoid a function dependency, we make the function itself only change when necessary</strong>.</p>
<p>Let’s see why this approach is useful. Previously, our example showed two search results (for <code>&#x27;react&#x27;</code> and <code>&#x27;redux&#x27;</code> search queries). But let’s say we want to add an input so that you can search for an arbitrary <code>query</code>. So instead of taking <code>query</code> as an argument, <code>getFetchUrl</code> will now read it from local state.</p>
<p>We’ll immediately see that it’s missing a <code>query</code> dependency:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setQuery</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">getFetchUrl</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useCallback</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span><span style="color:#FFA7C4"> </span><span style="color:#637777">// No query argument</span></span>
<span data-line=""><span style="color:#FFA7C4">    return </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">query</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// 🔴 Missing dep: query</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>If I fix my <code>useCallback</code> deps to include <code>query</code>, any effect with <code>getFetchUrl</code> in deps will re-run whenever the <code>query</code> changes:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">SearchResults</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setQuery</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ✅ Preserves identity until query changes</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">getFetchUrl</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useCallback</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">    return </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">query</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6">  </span><span style="color:#637777">// ✅ Callback deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">getFetchUrl</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">getFetchUrl</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// ✅ Effect deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Thanks to <code>useCallback</code>, if <code>query</code> is the same, <code>getFetchUrl</code> also stays the same, and our effect doesn’t re-run. But if <code>query</code> changes, <code>getFetchUrl</code> will also change, and we will re-fetch the data. It’s a lot like when you change some cell in an Excel spreadsheet, and the other cells using it recalculate automatically.</p>
<p>This is just a consequence of embracing the data flow and the synchronization mindset. <strong>The same solution works for function props passed from parents:</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Parent</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setQuery</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ✅ Preserves identity until query changes</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">fetchData</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useCallback</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">    const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">query</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">    </span><span style="color:#637777">// ... Fetch data and return it ...</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FFA7C4">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6">  </span><span style="color:#637777">// ✅ Callback deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Child</span><span style="color:#C792EA"> fetchData={</span><span style="color:#CED2D6">fetchData</span><span style="color:#C792EA">} /&gt;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Child</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ fetchData }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">let [</span><span style="color:#CED2D6">data</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setData</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F87086">null</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">().</span><span style="color:#8EACE3">then</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">setData</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">fetchData</span><span style="color:#C792EA">]);</span><span style="color:#CED2D6"> </span><span style="color:#637777">// ✅ Effect deps are OK</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Since <code>fetchData</code> only changes inside <code>Parent</code> when its <code>query</code> state changes, our <code>Child</code> won’t refetch the data until it’s actually necessary for the app.</p>
<h2>Are Functions Part of the Data Flow?</h2>
<p>Interestingly, this pattern is broken with classes in a way that really shows the difference between the effect and lifecycle paradigms. Consider this translation:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">class</span><span style="color:#CED2D6"> </span><span style="color:#FFCB8B">Parent</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">extends</span><span style="color:#CED2D6"> Component </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  state </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    query</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">fetchData</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">render</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Child</span><span style="color:#C792EA"> fetchData={</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">fetchData</span><span style="color:#C792EA">} /&gt;;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">class</span><span style="color:#CED2D6"> </span><span style="color:#FFCB8B">Child</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">extends</span><span style="color:#CED2D6"> Component </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  state </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    data</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#F87086">null</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidMount</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">render</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>You might be thinking: “Come on Dan, we all know that <code>useEffect</code> is like <code>componentDidMount</code> and <code>componentDidUpdate</code> combined, you can’t keep beating that drum!” <strong>Yet this doesn’t work even with <code>componentDidUpdate</code>:</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">class</span><span style="color:#CED2D6"> </span><span style="color:#FFCB8B">Child</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">extends</span><span style="color:#CED2D6"> Component </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  state </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    data</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#F87086">null</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidMount</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidUpdate</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">prevProps</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// 🔴 This condition will never be true</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">fetchData </span><span style="color:#C792EA">!==</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">prevProps</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">fetchData</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">render</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Of course, <code>fetchData</code> is a class method! (Or, rather, a class property — but that doesn’t change anything.) It’s not going to be different because of a state change. So <code>this.props.fetchData</code> will stay equal to <code>prevProps.fetchData</code> and we’ll never refetch. Let’s just remove this condition then?</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidUpdate</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">prevProps</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Oh wait, this fetches on <em>every</em> re-render. (Adding an animation above in the tree is a fun way to discover it.) Maybe let’s bind it to a particular query?</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">render</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Child</span><span style="color:#C792EA"> fetchData={</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">fetchData</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">bind</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">, </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">)} /&gt;;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span></code></pre></div>
<p>But then <code>this.props.fetchData !== prevProps.fetchData</code> is <em>always</em> <code>true</code>, even if the <code>query</code> didn’t change! So we’ll <em>always</em> refetch.</p>
<p>The only real solution to this conundrum with classes is to bite the bullet and pass the <code>query</code> itself into the <code>Child</code> component. The <code>Child</code> doesn’t actually end up <em>using</em> the <code>query</code>, but it can trigger a refetch when it changes:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">class</span><span style="color:#CED2D6"> </span><span style="color:#FFCB8B">Parent</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">extends</span><span style="color:#CED2D6"> Component </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  state </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    query</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">react</span><span style="color:#C792EA">&#x27;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">fetchData</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">url</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">https://hn.algolia.com/api/v1/search?query=</span><span style="color:#C792EA">&#x27;</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">+</span><span style="color:#FFA7C4"> this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">;</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ... Fetch data and do something ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">render</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Child</span><span style="color:#C792EA"> fetchData={</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">fetchData</span><span style="color:#C792EA">} query={</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">state</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">} /&gt;;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">class</span><span style="color:#CED2D6"> </span><span style="color:#FFCB8B">Child</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">extends</span><span style="color:#CED2D6"> Component </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  state </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    data</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#F87086">null</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidMount</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidUpdate</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">prevProps</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">query </span><span style="color:#C792EA">!==</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">prevProps</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">query</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">render</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>Over the years of working with classes with React, I’ve gotten so used to passing unnecessary props down and breaking encapsulation of parent components that I only realized a week ago why we had to do it.</p>
<p><strong>With classes, function props by themselves aren’t truly a part of the data flow.</strong> Methods close over the mutable <code>this</code> variable so we can’t rely on their identity to mean anything. Therefore, even when we only want a function, we have to pass a bunch of other data around in order to be able to “diff” it. We can’t know whether <code>this.props.fetchData</code> passed from the parent depends on some state or not, and whether that state has just changed.</p>
<p><strong>With <code>useCallback</code>, functions can fully participate in the data flow.</strong> We can say that if the function inputs changed, the function itself has changed, but if not, it stayed the same. Thanks to the granularity provided by <code>useCallback</code>, changes to props like <code>props.fetchData</code> can propagate down automatically.</p>
<p>Similarly, <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-reference.html#usememo"><code>useMemo</code></a> lets us do the same for complex objects:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">ColorPicker</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// Doesn&#x27;t break Child&#x27;s shallow equality prop check</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// unless the color actually changes.</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">color</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setColor</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">pink</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">style</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useMemo</span><span style="color:#C792EA">(()</span><span style="color:#FFA7C4"> =&gt; </span><span style="color:#C792EA">({</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">color </span><span style="color:#C792EA">}),</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">color</span><span style="color:#C792EA">]);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">Child</span><span style="color:#C792EA"> style={</span><span style="color:#CED2D6">style</span><span style="color:#C792EA">} /&gt;;</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><strong>I want to emphasize that putting <code>useCallback</code> everywhere is pretty clunky.</strong> It’s a nice escape hatch and it’s useful when a function is both passed down <em>and</em> called from inside an effect in some children. Or if you’re trying to prevent breaking memoization of a child component. But Hooks lend themselves better to <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down">avoiding passing callbacks down</a> altogether.</p>
<p>In the above examples, I’d much prefer if <code>fetchData</code> was either inside my effect (which itself could be extracted to a custom Hook) or a top-level import. I want to keep the effects simple, and callbacks in them don’t help that. (“What if some <code>props.onComplete</code> callback changes while the request was in flight?”) You can <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="#swimming-against-the-tide">simulate the class behavior</a> but that doesn’t solve race conditions.</p>
<h2>Speaking of Race Conditions</h2>
<p>A classic data fetching example with classes might look like this:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">class</span><span style="color:#CED2D6"> </span><span style="color:#FFCB8B">Article</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">extends</span><span style="color:#CED2D6"> Component </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  state </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    article</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#F87086">null</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidMount</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">article</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> await </span><span style="color:#CED2D6">API</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchArticle</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">setState</span><span style="color:#C792EA">({</span><span style="color:#CED2D6"> article </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>As you probably know, this code is buggy. It doesn’t handle updates. So the second classic example you could find online is something like this:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">class</span><span style="color:#CED2D6"> </span><span style="color:#FFCB8B">Article</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">extends</span><span style="color:#CED2D6"> Component </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  state </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    article</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#F87086">null</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidMount</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">componentDidUpdate</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">prevProps</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">prevProps</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">id </span><span style="color:#C792EA">!==</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">(</span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">props</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">article</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> await </span><span style="color:#CED2D6">API</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchArticle</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">setState</span><span style="color:#C792EA">({</span><span style="color:#CED2D6"> article </span><span style="color:#C792EA">});</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p>This is definitely better! But it’s still buggy. The reason it’s buggy is that the request may come out of order. So if I’m fetching <code>{id: 10}</code>, switch to <code>{id: 20}</code>, but the <code>{id: 20}</code> request comes first, the request that started earlier but finished later would incorrectly overwrite my state.</p>
<p>This is called a race condition, and it’s typical in code that mixes <code>async</code> / <code>await</code> (which assumes something waits for the result) with top-down data flow (props or state can change while we’re in the middle of an async function).</p>
<p>Effects don’t magically solve this problem, although they’ll warn you if you try to pass an <code>async</code> function to the effect directly. (We’ll need to improve that warning to better explain the problems you might run into.)</p>
<p>If the async approach you use supports cancellation, that’s great! You can cancel the async request right in your cleanup function.</p>
<p>Alternatively, the easiest stopgap approach is to track it with a boolean:</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="jsx" data-theme="default"><code data-language="jsx" data-theme="default" style="display:grid"><span data-line=""><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">Article</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">{ id }</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">const [</span><span style="color:#CED2D6">article</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">setArticle</span><span style="color:#FFA7C4">] </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useState</span><span style="color:#C792EA">(</span><span style="color:#F87086">null</span><span style="color:#C792EA">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#8EACE3">useEffect</span><span style="color:#C792EA">(()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">let </span><span style="color:#CED2D6">didCancel</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#F87086">false</span><span style="color:#C792EA">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">async</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">article</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> await </span><span style="color:#CED2D6">API</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">fetchArticle</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">);</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">if</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(!</span><span style="color:#CED2D6">didCancel</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">        </span><span style="color:#8EACE3">setArticle</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">article</span><span style="color:#C792EA">);</span></span>
<span data-line=""><span style="color:#CED2D6">      </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">fetchData</span><span style="color:#C792EA">();</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">      didCancel </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#F87086">true</span><span style="color:#C792EA">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#CED2D6">    </span><span style="color:#C792EA">};</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">},</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">[</span><span style="color:#CED2D6">id</span><span style="color:#C792EA">]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#637777">// ...</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<p><a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://www.robinwieruch.de/react-hooks-fetch-data/">This article</a> goes into more detail about how you can handle errors and loading states, as well as extract that logic into a custom Hook. I recommend you to check it out if you’re interested to learn more about data fetching with Hooks.</p>
<h2>Raising the Bar</h2>
<p>With the class lifecycle mindset, side effects behave differently from the render output. Rendering the UI is driven by props and state, and is guaranteed to be consistent with them, but side effects are not. This is a common source of bugs.</p>
<p>With the mindset of <code>useEffect</code>, things are synchronized by default. Side effects become a part of the React data flow. For every <code>useEffect</code> call, once you get it right, your component handles edge cases much better.</p>
<p>However, the upfront cost of getting it right is higher. This can be annoying. Writing synchronization code that handles edge cases well is inherently more difficult than firing one-off side effects that aren’t consistent with rendering.</p>
<p>This could be worrying if <code>useEffect</code> was meant to be <em>the</em> tool you use most of the time. However, it’s a low-level building block. It’s an early time for Hooks so everybody uses low-level ones all the time, especially in tutorials. But in practice, it’s likely the community will start moving to higher-level Hooks as good APIs gain momentum.</p>
<p>I’m seeing different apps create their own Hooks like <code>useFetch</code> that encapsulates some of their app’s auth logic or <code>useTheme</code> which uses theme context. Once you have a toolbox of those, you don’t reach for <code>useEffect</code> <em>that</em> often. But the resilience it brings benefits every Hook built on top of it.</p>
<p>So far, <code>useEffect</code> is most commonly used for data fetching. But data fetching isn’t exactly a synchronization problem. This is especially obvious because our deps are often <code>[]</code>. What are we even synchronizing?</p>
<p>In the longer term, <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://reactjs.org/blog/2018/11/27/react-16-roadmap.html#react-16x-mid-2019-the-one-with-suspense-for-data-fetching">Suspense for Data Fetching</a> will allow third-party libraries to have a first-class way to tell React to suspend rendering until something async (anything: code, data, images) is ready.</p>
<p>As Suspense gradually covers more data fetching use cases, I anticipate that <code>useEffect</code> will fade into background as a power user tool for cases when you actually want to synchronize props and state to some side effect. Unlike data fetching, it handles this case naturally because it was designed for it. But until then, custom Hooks like <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://www.robinwieruch.de/react-hooks-fetch-data/">shown here</a> are a good way to reuse data fetching logic.</p>
<h2>In Closing</h2>
<p>Now that you know pretty much everything I know about using effects, check out the <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="#tldr">TLDR</a> in the beginning. Does it make sense? Did I miss something? (I haven’t run out of paper yet!)</p>
<p>I’d love to hear from you on Twitter! Thanks for reading.</p><hr/><p><a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://x.com/search?q=https%3A%2F%2Foverreacted.io%2Fa-complete-guide-to-useeffect%2F">Discuss on 𝕏</a>  ·  <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/gaearon/overreacted.io/edit/main/public/a-complete-guide-to-useeffect/index.md">Edit on GitHub</a></p></div></article><footer class="mt-12"><a class="__className_b47211 inline-block text-2xl font-black hover:scale-[1.02] scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/"><span style="--myColor1:var(--pink);--myColor2:var(--purple);background-image:linear-gradient(45deg, var(--myColor1), var(--myColor2));background-clip:text;-webkit-background-clip:text;color:transparent;transition:--myColor1 0.2s ease-out, --myColor2 0.2s ease-in-out">overreacted</span></a></footer></main><script src="/_next/static/chunks/webpack-fdca05b8968262b2.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/0f6647b39fdbcb3d.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/3c6c21fa7f32edf2.css\",\"style\",{\"crossOrigin\":\"\"}]\n4:HL[\"/_next/static/css/f9d4d708579596e8.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[3728,[],\"\"]\n7:I[9928,[],\"\"]\n8:I[4982,[\"569\",\"static/chunks/569-52e5d813bbfa85ea.js\",\"185\",\"static/chunks/app/layout-cfb37acb14684668.js\"],\"\"]\n9:I[8256,[\"569\",\"static/chunks/569-52e5d813bbfa85ea.js\",\"64\",\"static/chunks/app/%5Bslug%5D/layout-d3e08fbfdc858bf2.js\"],\"\"]\na:I[2008,[\"569\",\"static/chunks/569-52e5d813bbfa85ea.js\",\"42\",\"static/chunks/app/%5Bslug%5D/page-798073576b23f3f1.js\"],\"\"]\nb:I[6954,[],\"\"]\nc:I[7264,[],\"\"]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0f6647b39fdbcb3d.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"iWWiOWlg3tDiHen4DuUO-\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/a-complete-guide-to-useeffect/\",\"initialTree\":[\"\",{\"children\":[[\"slug\",\"a-complete-guide-to-useeffect\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"a-complete-guide-to-useeffect\\\"}\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L6\"],\"globalErrorComponent\":\"$7\",\"children\":[null,[\"$\",\"$L8\",null,{\"children\":[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__className_e34cb4\",\"children\":[\"$\",\"body\",null,{\"className\":\"mx-auto max-w-2xl bg-[--bg] px-5 py-12 text-[--text]\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-14 flex flex-row place-content-between\",\"children\":[[\"$\",\"$L9\",null,{}],[\"$\",\"span\",null,{\"className\":\"relative top-[4px] italic\",\"children\":[\"by\",\" \",[\"$\",\"$La\",null,{\"href\":\"https://danabra.mov\",\"target\":\"_blank\",\"children\":[\"$\",\"img\",null,{\"alt\":\"Dan Abramov\",\"src\":\"https://github.com/gaearon.png\",\"className\":\"relative -top-1 mx-1 inline h-8 w-8 rounded-full\"}]}]]}]]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"article\",null,{\"className\":\"markdown\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"__className_b47211 text-[40px] font-black leading-[44px] text-[--title]\",\"children\":\"Not found\"}],[\"$\",\"div\",null,{\"className\":\"markdown mt-10\",\"children\":[[\"$\",\"p\",null,{\"children\":\"This page doesn't exist (yet?)\"}],[\"$\",\"p\",null,{\"children\":[\"I recently rewrote the site so maybe something broke. Please\",\" \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/gaearon/overreacted.io/issues/796\",\"children\":\"complain here.\"}]]}],[\"$\",\"p\",null,{\"children\":[\"If you're looking for translated posts, they're not on the site anymore but you can find\",\" \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/gaearon/overreacted.io/tree/archive/src/pages\",\"children\":\"an archive of them here.\"}]]}],[\"$\",\"p\",null,{\"children\":\"Hope you'll find what you're looking for.\"}]]}]]}],\"notFoundStyles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f9d4d708579596e8.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],\"childProp\":{\"current\":[null,[[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",[\"slug\",\"a-complete-guide-to-useeffect\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Ld\",\"$Le\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"a-complete-guide-to-useeffect\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f9d4d708579596e8.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}],[\"$\",\"footer\",null,{\"className\":\"mt-12\",\"children\":[\"$\",\"$L9\",null,{}]}]],null],\"segment\":[\"slug\",\"a-complete-guide-to-useeffect\",\"d\"]},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3c6c21fa7f32edf2.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]}]]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"article\",null,{\"children\":[[\"$\",\"h1\",null,{\"className\":\"__className_b47211 text-[40px] font-black leading-[44px] text-[--title]\",\"children\":\"A Complete Guide to useEffect\"}],[\"$\",\"p\",null,{\"className\":\"mt-2 text-[13px] text-gray-700 dark:text-gray-300\",\"children\":\"March 9, 2019\"}],[\"$\",\"div\",null,{\"className\":\"markdown mt-10\",\"children\":[\"$Lf\",[\"$\",\"hr\",null,{}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"$La\",null,{\"href\":\"https://x.com/search?q=https%3A%2F%2Foverreacted.io%2Fa-complete-guide-to-useeffect%2F\",\"children\":\"Discuss on 𝕏\"}],\"  ·  \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/gaearon/overreacted.io/edit/main/public/a-complete-guide-to-useeffect/index.md\",\"children\":\"Edit on GitHub\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"6:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"A Complete Guide to useEffect — overreacted\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Effects are a part of your data flow.\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/icon.png?e0852c1e2c7f0e65\",\"type\":\"image/png\",\"sizes\":\"329x329\"}]]\nd:null\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"p\",null,{\"children\":[\"You wrote a few components with \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-intro.html\",\"children\":\"Hooks\"}],\". Maybe even a small app. You’re mostly satisfied. You’re comfortable with the API and picked up a few tricks along the way. You even made some \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-custom.html\",\"children\":\"custom Hooks\"}],\" to extract repetitive logic (300 lines gone!) and showed it off to your colleagues. “Great job”, they said.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"But sometimes when you \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\", the pieces don’t quite fit together. You have a nagging feeling that you’re missing something. It seems similar to class lifecycles… but is it really? You find yourself asking questions like:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"🤔 How do I replicate \",[\"$\",\"code\",null,{\"children\":\"componentDidMount\"}],\" with \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\"?\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"🤔 How do I correctly fetch data inside \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\"? What is \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\"?\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"🤔 Do I need to specify functions as effect dependencies or not?\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"🤔 Why do I sometimes get an infinite refetching loop?\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"🤔 Why do I sometimes get an old state or prop value inside my effect?\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When I just started using Hooks, I was confused by all of those questions too. Even when writing the initial docs, I didn’t have a firm grasp on some of the subtleties. I’ve since had a few “aha” moments that I want to share with you. \",[\"$\",\"strong\",null,{\"children\":\"This deep dive will make the answers to these questions look obvious to you.\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To \",[\"$\",\"em\",null,{\"children\":\"see\"}],\" the answers, we need to take a step back. The goal of this article isn’t to give you a list of bullet point recipes. It’s to help you truly “grok” \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\". There won’t be much to learn. In fact, we’ll spend most of our time \",[\"$\",\"em\",null,{\"children\":\"un\"}],\"learning.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"It’s only after I stopped looking at the \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" Hook through the prism of the familiar class lifecycle methods that everything came together for me.\"]}]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"“Unlearn what you have learned.” — Yoda\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./yoda.jpg\",\"alt\":\"Yoda sniffing the air. Caption: “I smell bacon.”\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"This article assumes that you’re somewhat familiar with \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-effect.html\",\"children\":[\"$\",\"code\",null,{\"children\":\"useEffect\"}]}],\" API.\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"It’s also \",[\"$\",\"em\",null,{\"children\":\"really\"}],\" long. It’s like a mini-book. That’s just my preferred format. But I wrote a TLDR just below if you’re in a rush or don’t really care.\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"If you’re not comfortable with deep dives, you might want to wait until these explanations appear elsewhere. Just like when React came out in 2013, it will take some time for people to recognize a different mental model and teach it.\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"TLDR\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Here’s a quick TLDR if you don’t want to read the whole thing. If some parts don’t make sense, you can scroll down until you find something related.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Feel free to skip it if you plan to read the whole post. I’ll link to it at the end.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"🤔 Question: How do I replicate \",[\"$\",\"code\",null,{\"children\":\"componentDidMount\"}],\" with \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\"?\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"While you can \",[\"$\",\"code\",null,{\"children\":\"useEffect(fn, [])\"}],\", it’s not an exact equivalent. Unlike \",[\"$\",\"code\",null,{\"children\":\"componentDidMount\"}],\", it will \",[\"$\",\"em\",null,{\"children\":\"capture\"}],\" props and state. So even inside the callbacks, you’ll see the initial props and state. If you want to see “latest” something, you can write it to a ref. But there’s usually a simpler way to structure the code so that you don’t have to. Keep in mind that the mental model for effects is different from \",[\"$\",\"code\",null,{\"children\":\"componentDidMount\"}],\" and other lifecycles, and trying to find their exact equivalents may confuse you more than help. To get productive, you need to “think in effects”, and their mental model is closer to implementing synchronization than to responding to lifecycle events.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"🤔 Question:  How do I correctly fetch data inside \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\"? What is \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\"?\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"$La\",null,{\"href\":\"https://www.robinwieruch.de/react-hooks-fetch-data/\",\"children\":\"This article\"}],\" is a good primer on data fetching with \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\". Make sure to read it to the end! It’s not as long as this one. \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\" means the effect doesn’t use any value that participates in React data flow, and is for that reason safe to apply once. It is also a common source of bugs when the value actually \",[\"$\",\"em\",null,{\"children\":\"is\"}],\" used. You’ll need to learn a few strategies (primarily \",[\"$\",\"code\",null,{\"children\":\"useReducer\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\") that can \",[\"$\",\"em\",null,{\"children\":\"remove the need\"}],\" for a dependency instead of incorrectly omitting it.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"🤔 Question: Do I need to specify functions as effect dependencies or not?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The recommendation is to hoist functions that don’t need props or state \",[\"$\",\"em\",null,{\"children\":\"outside\"}],\" of your component, and pull the ones that are used only by an effect \",[\"$\",\"em\",null,{\"children\":\"inside\"}],\" of that effect.  If after that your effect still ends up using functions in the render scope (including function from props), wrap them into \",[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\" where they’re defined, and repeat the process. Why does it matter? Functions can “see” values from props and state — so they participate in the data flow. There’s a \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies\",\"children\":\"more detailed answer\"}],\" in our FAQ.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"🤔 Question: Why do I sometimes get an infinite refetching loop?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This can happen if you’re doing data fetching in an effect without the second dependencies argument. Without it, effects run after every render — and setting the state will trigger the effects again. An infinite loop may also happen if you specify a value that \",[\"$\",\"em\",null,{\"children\":\"always\"}],\" changes in the dependency array. You can tell which one by removing them one by one. However, removing a dependency you use (or blindly specifying \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\") is usually the wrong fix. Instead, fix the problem at its source. For example, functions can cause this problem, and putting them inside effects, hoisting them out, or wrapping them with \",[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\" helps. To avoid recreating objects, \",[\"$\",\"code\",null,{\"children\":\"useMemo\"}],\" can serve a similar purpose.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"🤔 Why do I sometimes get an old state or prop value inside my effect?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Effects always “see” props and state from the render they were defined in. That \",[\"$\",\"$La\",null,{\"href\":\"/how-are-function-components-different-from-classes/\",\"children\":\"helps prevent bugs\"}],\" but in some cases can be annoying. For those cases, you can explicitly maintain some value in a mutable ref (the linked article explains it at the end). If you think you’re seeing some props or state from an old render but don’t expect it, you probably missed some dependencies. Try using the \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/facebook/react/issues/14920\",\"children\":\"lint rule\"}],\" to train yourself to see them. A few days, and it’ll be like a second nature to you. See also \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-faq.html#why-am-i-seeing-stale-props-or-state-inside-my-function\",\"children\":\"this answer\"}],\" in our FAQ.\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I hope this TLDR was helpful! Otherwise, let’s go.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Each Render Has Its Own Props and State\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Before we can talk about effects, we need to talk about rendering.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Here’s a counter. Look at the highlighted line closely:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Click me\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"What does it mean? Does \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" somehow “watch” changes to our state and update automatically? That might be a useful first intuition when you learn React but it’s \",[\"$\",\"em\",null,{\"children\":\"not\"}],\" an \",[\"$\",\"$La\",null,{\"href\":\"https://overreacted.io/react-as-a-ui-runtime/\",\"children\":\"accurate mental model\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"In this example, \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" is just a number.\"]}],\" It’s not a magic “data binding”, a “watcher”, a “proxy”, or anything else. It’s a good old number like this one:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"42\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The first time our component renders, the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" variable we get from \",[\"$\",\"code\",null,{\"children\":\"useState()\"}],\" is \",[\"$\",\"code\",null,{\"children\":\"0\"}],\". When we call \",[\"$\",\"code\",null,{\"children\":\"setCount(1)\"}],\", React calls our component again. This time, \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" will be \",[\"$\",\"code\",null,{\"children\":\"1\"}],\". And so on:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// During first render\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Returned by useState()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// After a click, our function is called again\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Returned by useState()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// After another click, our function is called again\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"2\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Returned by useState()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"Whenever we update the state, React calls our component. Each render result “sees” its own \",[\"$\",\"code\",null,{\"children\":\"counter\"}],\" state value which is a \",[\"$\",\"em\",null,{\"children\":\"constant\"}],\" inside our function.\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So this line doesn’t do any special data binding:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"It only embeds a number value into the render output.\"}],\" That number is provided by React. When we \",[\"$\",\"code\",null,{\"children\":\"setCount\"}],\", React calls our component again with a different \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" value. Then React updates the DOM to match our latest render output.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The key takeaway is that the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" constant inside any particular render doesn’t change over time. It’s our component that’s called again — and each render “sees” its own \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" value that’s isolated between renders.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(For an in-depth overview of this process, check out my post \",[\"$\",\"$La\",null,{\"href\":\"https://overreacted.io/react-as-a-ui-runtime/\",\"children\":\"React as a UI Runtime\"}],\".)\"]}]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Each Render Has Its Own Event Handlers\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So far so good. What about event handlers?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Look at this example. It shows an alert with the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" after three seconds:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"alert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"You clicked on: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Click me\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Show alert\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let’s say I do this sequence of steps:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Increment\"}],\" the counter to 3\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Press\"}],\" “Show alert”\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Increment\"}],\" it to 5 before the timeout fires\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./counter.gif\",\"alt\":\"Counter demo\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"What do you expect the alert to show? Will it show 5 — which is the counter state at the time of the alert? Or will it show 3 — the state when I clicked?\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"spoilers ahead\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Go ahead and \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/w2wxl3yo0l\",\"children\":\"try it yourself!\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If the behavior doesn’t quite make sense to you, imagine a more practical example: a chat app with the current recipient ID in the state, and a Send button. \",[\"$\",\"$La\",null,{\"href\":\"https://overreacted.io/how-are-function-components-different-from-classes/\",\"children\":\"This article\"}],\" explores the reasons in depth but the correct answer is 3.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The alert will “capture” the state at the time I clicked the button.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"(There are ways to implement the other behavior too but I’ll be focusing on the default case for now. When building a mental model, it’s important that we distinguish the “path of least resistance” from the opt-in escape hatches.)\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"But how does it work?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We’ve discussed that the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" value is constant for every particular call to our function. It’s worth emphasizing this — \",[\"$\",\"strong\",null,{\"children\":[\"our function gets called many times (once per each render), but every one of those times the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" value inside of it is constant and set to a particular value (state for that render).\"]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This is not specific to React — regular functions work in a similar way:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"sayHi\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"person\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" person\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"alert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"someone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Dan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"sayHi\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"someone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"someone \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Yuzhi\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"sayHi\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"someone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"someone \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Dominic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"sayHi\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"someone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/mm6ww11lk8\",\"children\":\"this example\"}],\", the outer \",[\"$\",\"code\",null,{\"children\":\"someone\"}],\" variable is reassigned several times. (Just like somewhere in React, the \",[\"$\",\"em\",null,{\"children\":\"current\"}],\" component state can change.) \",[\"$\",\"strong\",null,{\"children\":[\"However, inside \",[\"$\",\"code\",null,{\"children\":\"sayHi\"}],\", there is a local \",[\"$\",\"code\",null,{\"children\":\"name\"}],\" constant that is associated with a \",[\"$\",\"code\",null,{\"children\":\"person\"}],\" from a particular call.\"]}],\" That constant is local, so it’s isolated between the calls! As a result, when the timeouts fire, each alert “remembers” its own \",[\"$\",\"code\",null,{\"children\":\"name\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This explains how our event handler captures the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" at the time of the click. If we apply the same substitution principle, each render “sees” its own \",[\"$\",\"code\",null,{\"children\":\"count\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// During first render\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Returned by useState()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"alert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"You clicked on: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// After a click, our function is called again\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Returned by useState()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"alert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"You clicked on: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// After another click, our function is called again\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"2\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Returned by useState()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"alert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"You clicked on: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"So effectively, each render returns its own “version” of \",[\"$\",\"code\",null,{\"children\":\"handleAlertClick\"}],\". Each of those versions “remembers” its own \",[\"$\",\"code\",null,{\"children\":\"count\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// During first render\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"alert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"You clicked on: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// The one with 0 inside\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// After a click, our function is called again\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"alert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"You clicked on: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// The one with 1 inside\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// After another click, our function is called again\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"alert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"You clicked on: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"2\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"handleAlertClick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// The one with 2 inside\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is why \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/w2wxl3yo0l\",\"children\":\"in this demo\"}],\" event handlers “belong” to a particular render, and when you click, it keeps using the \",[\"$\",\"code\",null,{\"children\":\"counter\"}],\" state \",[\"$\",\"em\",null,{\"children\":\"from\"}],\" that render.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Inside any particular render, props and state forever stay the same.\"}],\" But if props and state are isolated between renders, so are any values using them (including the event handlers). They also “belong” to a particular render. So even async functions inside an event handler will “see” the same \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" value.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"Side note: I inlined concrete \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" values right into \",[\"$\",\"code\",null,{\"children\":\"handleAlertClick\"}],\" functions above. This mental substitution is safe because \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" can’t possibly change within a particular render. It’s declared as a \",[\"$\",\"code\",null,{\"children\":\"const\"}],\" and is a number. It would be safe to think the same way about other values like objects too, but only if we agree to avoid mutating state. Calling \",[\"$\",\"code\",null,{\"children\":\"setSomething(newObj)\"}],\" with a newly created object instead of mutating it is fine because state belonging to previous renders is intact.\"]}]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Each Render Has Its Own Effects\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This was supposed to be a post about effects but we still haven’t talked about effects yet! We’ll rectify this now. Turns out, effects aren’t really any different.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Let’s go back to an example from \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-effect.html\",\"children\":\"the docs\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Click me\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"Here’s a question for you: how does the effect read the latest \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" state?\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Maybe, there’s some kind of “data binding” or “watching” that makes \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" update live inside the effect function? Maybe \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" is a mutable variable that React sets inside our component so that our effect always sees the latest value?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Nope.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We already know that \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" is constant within a particular component render. Event handlers “see” the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" state from the render that they “belong” to because \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" is a variable in their scope. The same is true for effects!\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"It’s not the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" variable that somehow changes inside an “unchanging” effect. It’s the \",[\"$\",\"em\",null,{\"children\":\"effect function itself\"}],\" that’s different on every render.\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Each version “sees” the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" value from the render that it “belongs” to:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// During first render\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Effect function from first render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// After a click, our function is called again\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Effect function from second render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// After another click, our function is called again\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Effect function from third render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"2\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ..\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"React remembers the effect function you provided, and runs it after flushing changes to the DOM and letting the browser paint the screen.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"So even if we speak of a single conceptual \",[\"$\",\"em\",null,{\"children\":\"effect\"}],\" here (updating the document title), it is represented by a \",[\"$\",\"em\",null,{\"children\":\"different function\"}],\" on every render — and each effect function “sees” props and state from the particular render it “belongs” to.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"Conceptually, you can imagine effects are a \",[\"$\",\"em\",null,{\"children\":\"part of the render result\"}],\".\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Strictly saying, they’re not (in order to \",[\"$\",\"$La\",null,{\"href\":\"https://overreacted.io/why-do-hooks-rely-on-call-order/\",\"children\":\"allow Hook composition\"}],\" without clumsy syntax or runtime overhead). But in the mental model we’re building up, effect functions \",[\"$\",\"em\",null,{\"children\":\"belong\"}],\" to a particular render in the same way that event handlers do.\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"To make sure we have a solid understanding, let’s recap our first render:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Give me the UI when the state is \",[\"$\",\"code\",null,{\"children\":\"0\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Your component:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Here’s the render result:\\r\\n\",[\"$\",\"code\",null,{\"children\":\"\u003cp\u003eYou clicked 0 times\u003c/p\u003e\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Also remember to run this effect after you’re done: \",[\"$\",\"code\",null,{\"children\":\"() =\u003e { document.title = 'You clicked 0 times' }\"}],\".\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Sure. Updating the UI. Hey browser, I’m adding some stuff to the DOM.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Browser:\"}],\" Cool, I painted it to the screen.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" OK, now I’m going to run the effect you gave me.\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Running \",[\"$\",\"code\",null,{\"children\":\"() =\u003e { document.title = 'You clicked 0 times' }\"}],\".\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Now let’s recap what happens after we click:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Your component:\"}],\" Hey React, set my state to \",[\"$\",\"code\",null,{\"children\":\"1\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Give me the UI for when the state is \",[\"$\",\"code\",null,{\"children\":\"1\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Your component:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Here’s the render result:\\r\\n\",[\"$\",\"code\",null,{\"children\":\"\u003cp\u003eYou clicked 1 times\u003c/p\u003e\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Also remember to run this effect after you’re done: \",[\"$\",\"code\",null,{\"children\":\"() =\u003e { document.title = 'You clicked 1 times' }\"}],\".\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" Sure. Updating the UI. Hey browser, I’ve changed the DOM.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Browser:\"}],\" Cool, I painted your changes to the screen.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React:\"}],\" OK, now I’ll run the effect that belongs to the render I just did.\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Running \",[\"$\",\"code\",null,{\"children\":\"() =\u003e { document.title = 'You clicked 1 times' }\"}],\".\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Each Render Has Its Own… Everything\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"We know now that effects run after every render, are conceptually a part of the component output, and “see” the props and state from that particular render.\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let’s try a thought experiment. Consider this code:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" times\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Click me\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"div\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If I click several times with a small delay, what is the log going to look like?\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"spoilers ahead\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You might think this is a gotcha and the end result is unintuitive. It’s not! We’re going to see a sequence of logs — each one belonging to a particular render and thus with its own \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" value. You can \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/lyx20m1ol\",\"children\":\"try it yourself\"}],\":\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./timeout_counter.gif\",\"alt\":\"Screen recording of 1, 2, 3, 4, 5 logged in order\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You may think: “Of course that’s how it works! How else could it work?”\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Well, that’s not how \",[\"$\",\"code\",null,{\"children\":\"this.state\"}],\" works in classes. It’s easy to make the mistake of thinking that this \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/kkymzwjqz3\",\"children\":\"class implementation\"}],\" is equivalent:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, \",[\"$\",\"code\",null,{\"children\":\"this.state.count\"}],\" always points at the \",[\"$\",\"em\",null,{\"children\":\"latest\"}],\" count rather than the one belonging to a particular render. So you’ll see \",[\"$\",\"code\",null,{\"children\":\"5\"}],\" logged each time instead:\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./timeout_counter_class.gif\",\"alt\":\"Screen recording of 5, 5, 5, 5, 5 logged in order\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I think it’s ironic that Hooks rely so much on JavaScript closures, and yet it’s the class implementation that suffers from \",[\"$\",\"$La\",null,{\"href\":\"https://wsvincent.com/javascript-closure-settimeout-for-loop/\",\"children\":\"the canonical wrong-value-in-a-timeout confusion\"}],\" that’s often associated with closures. This is because the actual source of the confusion in this example is the mutation (React mutates \",[\"$\",\"code\",null,{\"children\":\"this.state\"}],\" in classes to point to the latest state) and not closures themselves.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Closures are great when the values you close over never change. That makes them easy to think about because you’re essentially referring to constants.\"}],\" And as we discussed, props and state never change within a particular render. By the way, we can fix the class version… by \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/w7vjo07055\",\"children\":\"using a closure\"}],\".\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Swimming Against the Tide\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"At this point it’s important that we call it out explicitly: \",[\"$\",\"strong\",null,{\"children\":\"every\"}],\" function inside the component render (including event handlers, effects, timeouts or API calls inside them) captures the props and state of the render call that defined it.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So these two examples are equivalent:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"It doesn’t matter whether you read from props or state “early” inside of your component.\"}],\" They’re not going to change! Inside the scope of a single render, props and state stay the same. (Destructuring props makes this more obvious.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Of course, sometimes you \",[\"$\",\"em\",null,{\"children\":\"want\"}],\" to read the latest rather than captured value inside some callback defined in an effect. The easiest way to do it is by using refs, as described in the last section of \",[\"$\",\"$La\",null,{\"href\":\"https://overreacted.io/how-are-function-components-different-from-classes/\",\"children\":\"this article\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Be aware that when you want to read the \",[\"$\",\"em\",null,{\"children\":\"future\"}],\" props or state from a function in a \",[\"$\",\"em\",null,{\"children\":\"past\"}],\" render, you’re swimming against the tide. It’s not \",[\"$\",\"em\",null,{\"children\":\"wrong\"}],\" (and in some cases necessary) but it might look less “clean” to break out of the paradigm. This is an intentional consequence because it helps highlight which code is fragile and depends on timing. In classes, it’s less obvious when this happens.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Here’s a \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/rm7z22qnlp\",\"children\":\"version of our counter example\"}],\" that replicates the class behavior:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"latestCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useRef\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Set the mutable latest value\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"latestCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"current \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setTimeout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Read the mutable latest value\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"`You clicked \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"latestCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"current\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7986E7\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" times`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"3000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./timeout_counter_refs.gif\",\"alt\":\"Screen recording of 5, 5, 5, 5, 5 logged in order\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"It might seem quirky to mutate something in React. However, this is exactly how React itself reassigns \",[\"$\",\"code\",null,{\"children\":\"this.state\"}],\" in classes. Unlike with captured props and state, you don’t have any guarantees that reading \",[\"$\",\"code\",null,{\"children\":\"latestCount.current\"}],\" would give you the same value in any particular callback. By definition, you can mutate it any time. This is why it’s not a default, and you have to opt into that.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"So What About Cleanup?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"As \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-effect.html#effects-with-cleanup\",\"children\":\"the docs explain\"}],\", some effects might have a cleanup phase. Essentially, its purpose is to “undo” an effect for cases like subscriptions.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Consider this code:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ChatAPI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"subscribeToFriendStatus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" handleStatusChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ChatAPI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"unsubscribeFromFriendStatus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" handleStatusChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Say \",[\"$\",\"code\",null,{\"children\":\"props\"}],\" is \",[\"$\",\"code\",null,{\"children\":\"{id: 10}\"}],\" on the first render, and \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\" on the second render. You \",[\"$\",\"em\",null,{\"children\":\"might\"}],\" think that something like this happens:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"React cleans up the effect for \",[\"$\",\"code\",null,{\"children\":\"{id: 10}\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"React renders UI for \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"React runs the effect for \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\".\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"(This is not quite the case.)\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"With this mental model, you might think the cleanup “sees” the old props because it runs before we re-render, and then the new effect “sees” the new props because it runs after the re-render. That’s the mental model lifted directly from the class lifecycles, and \",[\"$\",\"strong\",null,{\"children\":\"it’s not accurate here\"}],\". Let’s see why.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"React only runs the effects after \",[\"$\",\"$La\",null,{\"href\":\"https://medium.com/@dan_abramov/this-benchmark-is-indeed-flawed-c3d6b5b6f97f\",\"children\":\"letting the browser paint\"}],\". This makes your app faster as most effects don’t need to block screen updates. Effect cleanup is also delayed. \",[\"$\",\"strong\",null,{\"children\":[\"The previous effect is cleaned up \",[\"$\",\"em\",null,{\"children\":\"after\"}],\" the re-render with new props:\"]}]]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"React renders UI for \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\".\"]}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"The browser paints. We see the UI for \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\" on the screen.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"React cleans up the effect for \",[\"$\",\"code\",null,{\"children\":\"{id: 10}\"}],\".\"]}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"React runs the effect for \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\".\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You might be wondering: but how can the cleanup of the previous effect still “see” the old \",[\"$\",\"code\",null,{\"children\":\"{id: 10}\"}],\" props if it runs \",[\"$\",\"em\",null,{\"children\":\"after\"}],\" the props change to \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\"?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We’ve been here before… 🤔\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./deja_vu.gif\",\"alt\":\"Deja vu (cat scene from the Matrix movie)\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Quoting the previous section:\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"Every function inside the component render (including event handlers, effects, timeouts or API calls inside them) captures the props and state of the render call that defined it.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Now the answer is clear! The effect cleanup doesn’t read the “latest” props, whatever that means. It reads props that belong to the render it’s defined in:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// First render, props are {id: 10}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Effect from first render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ChatAPI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"subscribeToFriendStatus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"10\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" handleStatusChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Cleanup for effect from first render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ChatAPI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"unsubscribeFromFriendStatus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"10\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" handleStatusChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Next render, props are {id: 20}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Example\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Effect from second render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ChatAPI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"subscribeToFriendStatus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"20\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" handleStatusChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Cleanup for effect from second render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"ChatAPI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"unsubscribeFromFriendStatus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"20\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" handleStatusChange\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Kingdoms will rise and turn into ashes, the Sun will shed its outer layers to be a white dwarf, and the last civilization will end. But nothing will make the props “seen” by the first render effect’s cleanup anything other than \",[\"$\",\"code\",null,{\"children\":\"{id: 10}\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"That’s what allows React to deal with effects right after painting — and make your apps faster by default. The old props are still there if our code needs them.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Synchronization, Not Lifecycle\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"One of my favorite things about React is that it unifies describing the initial render result and the updates. This \",[\"$\",\"$La\",null,{\"href\":\"https://overreacted.io/the-bug-o-notation/\",\"children\":\"reduces the entropy\"}],\" of your program.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Say my component looks like this:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ name }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"It doesn’t matter if I render \",[\"$\",\"code\",null,{\"children\":\"\u003cGreeting name=\\\"Dan\\\" /\u003e\"}],\" and later \",[\"$\",\"code\",null,{\"children\":\"\u003cGreeting name=\\\"Yuzhi\\\" /\u003e\"}],\", or if I just render \",[\"$\",\"code\",null,{\"children\":\"\u003cGreeting name=\\\"Yuzhi\\\" /\u003e\"}],\". In the end, we will see “Hello, Yuzhi” in both cases.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"People say: “It’s all about the journey, not the destination”. With React, it’s the opposite. \",[\"$\",\"strong\",null,{\"children\":\"It’s all about the destination, not the journey.\"}],\" That’s the difference between \",[\"$\",\"code\",null,{\"children\":\"$$.addClass\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"$$.removeClass\"}],\" calls in jQuery code (our “journey”) and specifying what the CSS class \",[\"$\",\"em\",null,{\"children\":\"should be\"}],\" in React code (our “destination”).\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"React synchronizes the DOM according to our current props and state.\"}],\" There is no distinction between a “mount” or an “update” when rendering.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You should think of effects in a similar way. \",[\"$\",\"strong\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" lets you \",[\"$\",\"em\",null,{\"children\":\"synchronize\"}],\" things outside of the React tree according to our props and state.\"]}]]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ name }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is subtly different from the familiar \",[\"$\",\"em\",null,{\"children\":\"mount/update/unmount\"}],\" mental model. It is important really to internalize this. \",[\"$\",\"strong\",null,{\"children\":\"If you’re trying to write an effect that behaves differently depending on whether the component renders for the first time or not, you’re swimming against the tide!\"}],\" We’re failing at synchronizing if our result depends on the “journey” rather than the “destination”.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"It shouldn’t matter whether we rendered with props A, B, and C, or if we rendered with C immediately. While there may be some temporary differences (e.g. while we’re fetching data), eventually the end result should be the same.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Still, of course running all effects on \",[\"$\",\"em\",null,{\"children\":\"every\"}],\" render might not be efficient. (And in some cases, it would lead to infinite loops.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So how can we fix this?\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Teaching React to Diff Your Effects\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We’ve already learned that lesson with the DOM itself. Instead of touching it on every re-render, React only updates the parts of the DOM that actually change.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"When you’re updating\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  Hello, Dan\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"to\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  Hello, Yuzhi\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"React sees two objects:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"oldProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, Dan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"newProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"className\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"children\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, Yuzhi\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"It goes over each of their props and determine that \",[\"$\",\"code\",null,{\"children\":\"children\"}],\" have changed and need a DOM update, but \",[\"$\",\"code\",null,{\"children\":\"className\"}],\" did not. So it can just do:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"domNode\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"innerText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, Yuzhi\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// No need to touch domNode.className\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Could we do something like this with effects too? It would be nice to avoid re-running them when applying the effect is unnecessary.\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For example, maybe our component re-renders because of a state change:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ name }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCounter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" className=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Greeting\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" onClick={() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCounter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" + \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")}\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        Increment\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"button\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"But our effect doesn’t use the \",[\"$\",\"code\",null,{\"children\":\"counter\"}],\" state. \",[\"$\",\"strong\",null,{\"children\":[\"Our effect synchronizes the \",[\"$\",\"code\",null,{\"children\":\"document.title\"}],\" with the \",[\"$\",\"code\",null,{\"children\":\"name\"}],\" prop, but the \",[\"$\",\"code\",null,{\"children\":\"name\"}],\" prop is the same.\"]}],\" Re-assigning \",[\"$\",\"code\",null,{\"children\":\"document.title\"}],\" on every counter change seems non-ideal.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"OK, so can React just… diff effects?\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"oldEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, Dan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"newEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, Dan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Can React see these functions do the same thing?\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Not really. React can’t guess what the function does without calling it. (The source doesn’t really contain specific values, it just closes over the \",[\"$\",\"code\",null,{\"children\":\"name\"}],\" prop.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is why if you want to avoid re-running effects unnecessarily, you can provide a dependency array (also known as “deps”) argument to \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Our deps\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"It’s like if we told React: “Hey, I know you can’t see \",[\"$\",\"em\",null,{\"children\":\"inside\"}],\" this function, but I promise it only uses \",[\"$\",\"code\",null,{\"children\":\"name\"}],\" and nothing else from the render scope.”\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If each of these values is the same between the current and the previous time this effect ran, there’s nothing to synchronize so React can skip the effect:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"oldEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, Dan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"oldDeps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Dan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"newEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, Dan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"newDeps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Dan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// React can't peek inside of functions, but it can compare deps.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Since all deps are the same, it doesn’t need to run the new effect.\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If even one of the values in the dependency array is different between renders, we know running the effect can’t be skipped. Synchronize all the things!\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Don’t Lie to React About Dependencies\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Lying to React about dependencies has bad consequences. Intuitively, this makes sense, but I’ve seen pretty much everyone who tries \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" with a mental model from classes try to cheat the rules. (And I did that too at first!)\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Is this okay? Not always -- and there's a better way to write it.\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(The \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies\",\"children\":\"Hooks FAQ\"}],\" explains what to do instead. We’ll come back to this example \",[\"$\",\"$La\",null,{\"href\":\"#moving-functions-inside-effects\",\"children\":\"below\"}],\".)\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"“But I only want to run it on mount!”, you’ll say. For now, remember: if you specify deps, \",[\"$\",\"strong\",null,{\"children\":[[\"$\",\"em\",null,{\"children\":\"all\"}],\" values from inside your component that are used by the effect \",[\"$\",\"em\",null,{\"children\":\"must\"}],\" be there\"]}],\". Including props, state, functions — anything in your component.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Sometimes when you do that, it causes a problem. For example, maybe you see an infinite refetching loop, or a socket is recreated too often. \",[\"$\",\"strong\",null,{\"children\":[\"The solution to that problem is \",[\"$\",\"em\",null,{\"children\":\"not\"}],\" to remove a dependency.\"]}],\" We’ll look at the solutions soon.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"But before we jump to solutions, let’s understand the problem better.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"What Happens When Dependencies Lie\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If deps contain every value used by the effect, React knows when to re-run it:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./deps-compare-correct.gif\",\"alt\":\"Diagram of effects replacing one another\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"(Dependencies are different, so we re-run the effect.)\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"But if we specified \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\" for this effect, the new effect function wouldn’t run:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"document\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"title \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"Hello, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Wrong: name is missing in deps\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./deps-compare-wrong.gif\",\"alt\":\"Diagram of effects replacing one another\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"(Dependencies are equal, so we skip the effect.)\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In this case the problem might seem obvious. But the intuition can fool you in other cases where a class solution “jumps out” from your memory.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"For example, let’s say we’re writing a counter that increments every second. With a class, our intuition is: “Set up the interval once and destroy it once”. Here’s an \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/n5mjzjy9kl\",\"children\":\"example\"}],\" of how we can do it. When we mentally translate this code to \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\", we instinctively add \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\" to the deps. “I want it to run once”, right?\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, this example \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/91n5z8jo7r\",\"children\":[\"only \",[\"$\",\"em\",null,{\"children\":\"increments\"}],\" once\"]}],\". \",[\"$\",\"em\",null,{\"children\":\"Oops.\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If your mental model is “dependencies let me specify when I want to re-trigger the effect”, this example might give you an existential crisis. You \",[\"$\",\"em\",null,{\"children\":\"want\"}],\" to trigger it once because it’s an interval — so why is it causing issues?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, this makes sense if you know that dependencies are our hint to React about \",[\"$\",\"em\",null,{\"children\":\"everything\"}],\" that the effect uses from the render scope. It uses \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" but we lied that it doesn’t with \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\". It’s only a matter of time before this bites us!\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In the first render, \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" is \",[\"$\",\"code\",null,{\"children\":\"0\"}],\". Therefore, \",[\"$\",\"code\",null,{\"children\":\"setCount(count + 1)\"}],\" in the first render’s effect means \",[\"$\",\"code\",null,{\"children\":\"setCount(0 + 1)\"}],\". \",[\"$\",\"strong\",null,{\"children\":[\"Since we never re-run the effect because of \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\" deps, it will keep calling \",[\"$\",\"code\",null,{\"children\":\"setCount(0 + 1)\"}],\" every second:\"]}]]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// First render, state is 0\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Effect from first render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Always setCount(1)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Never re-runs\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Every next render, state is 1\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// This effect is always ignored because\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// we lied to React about empty deps.\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We lied to React by saying our effect doesn’t depend on a value from inside our component, when in fact it does!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Our effect uses \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" — a value inside the component (but outside the effect):\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Therefore, specifying \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\" as a dependency will create a bug. React will compare the dependencies, and skip updating this effect:\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./interval-wrong.gif\",\"alt\":\"Diagram of stale interval closure\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"(Dependencies are equal, so we skip the effect.)\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Issues like this are difficult to think about. Therefore, I encourage you to adopt it as a hard rule to always be honest about the effect dependencies, and specify them all. (We provide a \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/facebook/react/issues/14920\",\"children\":\"lint rule\"}],\" if you want to enforce this on your team.)\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Two Ways to Be Honest About Dependencies\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"There are two strategies to be honest about dependencies. You should generally start with the first one, and then apply the second one if needed.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"The first strategy is to fix the dependency array to include \",[\"$\",\"em\",null,{\"children\":\"all\"}],\" the values inside the component that are used inside the effect.\"]}],\" Let’s include \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" as a dep:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This makes the dependency array correct. It may not be \",[\"$\",\"em\",null,{\"children\":\"ideal\"}],\" but that’s the first issue we needed to fix. Now a change to \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" will re-run the effect, with each next interval referencing \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" from its render in \",[\"$\",\"code\",null,{\"children\":\"setCount(count + 1)\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// First render, state is 0\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Effect from first render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// setCount(count + 1)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// [count]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Second render, state is 1\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Effect from second render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// setCount(count + 1)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// [count]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"That would \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/0x0mnlyq8l\",\"children\":\"fix the problem\"}],\" but our interval would be cleared and set again whenever the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" changes. That may be undesirable:\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./interval-rightish.gif\",\"alt\":\"Diagram of interval that re-subscribes\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"(Dependencies are different, so we re-run the effect.)\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"The second strategy is to change our effect code so that it wouldn’t \",[\"$\",\"em\",null,{\"children\":\"need\"}],\" a value that changes more often than we want.\"]}],\" We don’t want to lie about the dependencies — we just want to change our effect to have \",[\"$\",\"em\",null,{\"children\":\"fewer\"}],\" of them.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let’s look at a few common techniques for removing dependencies.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Making Effects Self-Sufficient\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We want to get rid of the \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" dependency in our effect.\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To do this, we need to ask ourselves: \",[\"$\",\"strong\",null,{\"children\":[\"what are we using \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" for?\"]}],\" It seems like we only use it for the \",[\"$\",\"code\",null,{\"children\":\"setCount\"}],\" call. In that case, we don’t actually need \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" in the scope at all. When we want to update state based on the previous state, we can use the \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-reference.html#functional-updates\",\"children\":\"functional updater form\"}],\" of \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I like to think of these cases as “false dependencies”. Yes, \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" was a necessary dependency because we wrote \",[\"$\",\"code\",null,{\"children\":\"setCount(count + 1)\"}],\" inside the effect. However, we only truly needed \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" to transform it into \",[\"$\",\"code\",null,{\"children\":\"count + 1\"}],\" and “send it back” to React. But React \",[\"$\",\"em\",null,{\"children\":\"already knows\"}],\" the current \",[\"$\",\"code\",null,{\"children\":\"count\"}],\". \",[\"$\",\"strong\",null,{\"children\":\"All we needed to tell React is to increment the state — whatever it is right now.\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"That’s exactly what \",[\"$\",\"code\",null,{\"children\":\"setCount(c =\u003e c + 1)\"}],\" does. You can think of it as “sending an instruction” to React about how the state should change. This “updater form” also helps in other cases, like when you \",[\"$\",\"$La\",null,{\"href\":\"/react-as-a-ui-runtime/#batching\",\"children\":\"batch multiple updates\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"Note that we actually \",[\"$\",\"em\",null,{\"children\":\"did the work\"}],\" to remove the dependency. We didn’t cheat. Our effect doesn’t read the \",[\"$\",\"code\",null,{\"children\":\"counter\"}],\" value from the render scope anymore:\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./interval-right.gif\",\"alt\":\"Diagram of interval that works\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"(Dependencies are equal, so we skip the effect.)\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You can try it \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/q3181xz1pj\",\"children\":\"here\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Even though this effect only runs once, the interval callback that belongs to the first render is perfectly capable of sending the \",[\"$\",\"code\",null,{\"children\":\"c =\u003e c + 1\"}],\" update instruction every time the interval fires. It doesn’t need to know the current \",[\"$\",\"code\",null,{\"children\":\"counter\"}],\" state anymore. React already knows it.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Functional Updates and Google Docs\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Remember how we talked about synchronization being the mental model for effects? An interesting aspect of synchronization is that you often want to keep the “messages” between the systems untangled from their state. For example, editing a document in Google Docs doesn’t actually send the \",[\"$\",\"em\",null,{\"children\":\"whole\"}],\" page to the server. That would be very inefficient. Instead, it sends a representation of what the user tried to do.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"While our use case is different, a similar philosophy applies to effects. \",[\"$\",\"strong\",null,{\"children\":\"It helps to send only the minimal necessary information from inside the effects into a component.\"}],\" The updater form like \",[\"$\",\"code\",null,{\"children\":\"setCount(c =\u003e c + 1)\"}],\" conveys strictly less information than \",[\"$\",\"code\",null,{\"children\":\"setCount(count + 1)\"}],\" because it isn’t “tainted” by the current count. It only expresses the action (“incrementing”). Thinking in React involves \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/thinking-in-react.html#step-3-identify-the-minimal-but-complete-representation-of-ui-state\",\"children\":\"finding the minimal state\"}],\". This is the same principle, but for updates.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Encoding the \",[\"$\",\"em\",null,{\"children\":\"intent\"}],\" (rather than the result) is similar to how Google Docs \",[\"$\",\"$La\",null,{\"href\":\"https://medium.com/@srijancse/how-real-time-collaborative-editing-work-operational-transformation-ac4902d75682\",\"children\":\"solves\"}],\" collaborative editing. While this is stretching the analogy, functional updates serve a similar role in React. They ensure updates from multiple sources (event handlers, effect subscriptions, etc) can be correctly applied in a batch and in a predictable way.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"However, even \",[\"$\",\"code\",null,{\"children\":\"setCount(c =\u003e c + 1)\"}],\" isn’t that great.\"]}],\" It looks a bit weird and it’s very limited in what it can do. For example, if we had two state variables whose values depend on each other, or if we needed to calculate the next state based on a prop, it wouldn’t help us. Luckily, \",[\"$\",\"code\",null,{\"children\":\"setCount(c =\u003e c + 1)\"}],\" has a more powerful sister pattern. Its name is \",[\"$\",\"code\",null,{\"children\":\"useReducer\"}],\".\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Decoupling Updates from Actions\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Let’s modify the previous example to have two state variables: \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"step\"}],\". Our interval will increment the count by the value of the \",[\"$\",\"code\",null,{\"children\":\"step\"}],\" input:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setStep\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setCount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" value={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} onChange={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setStep\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Number\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"target\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"))} /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"(Here’s a \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/zxn70rnkx\",\"children\":\"demo\"}],\".)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Note that \",[\"$\",\"strong\",null,{\"children\":\"we’re not cheating\"}],\". Since I started using \",[\"$\",\"code\",null,{\"children\":\"step\"}],\" inside the effect, I added it to the dependencies. And that’s why the code runs correctly.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The current behavior in this example is that changing the \",[\"$\",\"code\",null,{\"children\":\"step\"}],\" restarts the interval — because it’s one of the dependencies. And in many cases, that is exactly what you want! There’s nothing wrong with tearing down an effect and setting it up anew, and we shouldn’t avoid that unless we have a good reason.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, let’s say we want the interval clock to not reset on changes to the \",[\"$\",\"code\",null,{\"children\":\"step\"}],\". How do we remove the \",[\"$\",\"code\",null,{\"children\":\"step\"}],\" dependency from our effect?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"When setting a state variable depends on the current value of another state variable, you might want to try replacing them both with \",[\"$\",\"code\",null,{\"children\":\"useReducer\"}],\".\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When you find yourself writing \",[\"$\",\"code\",null,{\"children\":\"setSomething(something =\u003e ...)\"}],\", it’s a good time to consider using a reducer instead. A reducer lets you \",[\"$\",\"strong\",null,{\"children\":\"decouple expressing the “actions” that happened in your component from how the state updates in response to them\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Let’s trade the \",[\"$\",\"code\",null,{\"children\":\"step\"}],\" dependency for a \",[\"$\",\"code\",null,{\"children\":\"dispatch\"}],\" dependency in our effect:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useReducer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"reducer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"initialState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"tick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Instead of setCount(c =\u003e c + step);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"(See the \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/xzr480k0np\",\"children\":\"demo\"}],\".)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You might ask me: “How is this any better?” The answer is that \",[\"$\",\"strong\",null,{\"children\":[\"React guarantees the \",[\"$\",\"code\",null,{\"children\":\"dispatch\"}],\" function to be constant throughout the component lifetime. So the example above doesn’t ever need to resubscribe the interval.\"]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We solved our problem!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(You may omit \",[\"$\",\"code\",null,{\"children\":\"dispatch\"}],\", \",[\"$\",\"code\",null,{\"children\":\"setState\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"useRef\"}],\" container values from the deps because React guarantees them to be static. But it also doesn’t hurt to specify them.)\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Instead of reading the state \",[\"$\",\"em\",null,{\"children\":\"inside\"}],\" an effect, it dispatches an \",[\"$\",\"em\",null,{\"children\":\"action\"}],\" that encodes the information about \",[\"$\",\"em\",null,{\"children\":\"what happened\"}],\". This allows our effect to stay decoupled from the \",[\"$\",\"code\",null,{\"children\":\"step\"}],\" state. Our effect doesn’t care \",[\"$\",\"em\",null,{\"children\":\"how\"}],\" we update the state, it just tells us about \",[\"$\",\"em\",null,{\"children\":\"what happened\"}],\". And the reducer centralizes the update logic:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"initialState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"reducer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"tick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" count \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" step \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"step \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"(Here’s a \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/xzr480k0np\",\"children\":\"demo\"}],\" if you missed it earlier).\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Why useReducer Is the Cheat Mode of Hooks\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We’ve seen how to remove dependencies when an effect needs to set state based on previous state, or on another state variable. \",[\"$\",\"strong\",null,{\"children\":[\"But what if we need \",[\"$\",\"em\",null,{\"children\":\"props\"}],\" to calculate the next state?\"]}],\" For example, maybe our API is \",[\"$\",\"code\",null,{\"children\":\"\u003cCounter step={1} /\u003e\"}],\". Surely, in this case we can’t avoid specifying \",[\"$\",\"code\",null,{\"children\":\"props.step\"}],\" as a dependency?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In fact, we can! We can put \",[\"$\",\"em\",null,{\"children\":\"the reducer itself\"}],\" inside our component to read props:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Counter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ step }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useReducer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"reducer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"reducer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"tick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" state \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"tick\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"1000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"clearInterval\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"dispatch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"h1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This pattern disables a few optimizations so try not to use it everywhere, but you can totally access props from a reducer if you need to. (Here’s a \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/7ypm405o8q\",\"children\":\"demo\"}],\".)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"Even in that case, \",[\"$\",\"code\",null,{\"children\":\"dispatch\"}],\" identity is still guaranteed to be stable between re-renders.\"]}],\" So you may omit it from the effect deps if you want. It’s not going to cause the effect to re-run.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You may be wondering: how can this possibly work? How can the reducer “know” props when called from inside an effect that belongs to another render? The answer is that when you \",[\"$\",\"code\",null,{\"children\":\"dispatch\"}],\", React just remembers the action — but it will \",[\"$\",\"em\",null,{\"children\":\"call\"}],\" your reducer during the next render. At that point the fresh props will be in scope, and you won’t be inside an effect.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"This is why I like to think of \",[\"$\",\"code\",null,{\"children\":\"useReducer\"}],\" as the “cheat mode” of Hooks. It lets me decouple the update logic from describing what happened. This, in turn, helps me remove unnecessary dependencies from my effects and avoid re-running them more often than necessary.\"]}]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Moving Functions Inside Effects\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A common mistake is to think functions shouldn’t be dependencies. For example, this seems like it could work:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"hits\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" await \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"axios\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Is this okay?\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":[\"(\",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/8j4ykjyv0\",\"children\":\"This example\"}],\" is adapted from a great article by Robin Wieruch — \",[\"$\",\"$La\",null,{\"href\":\"https://www.robinwieruch.de/react-hooks-fetch-data/\",\"children\":\"check it out\"}],\"!)\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"And to be clear, this code \",[\"$\",\"em\",null,{\"children\":\"does\"}],\" work. \",[\"$\",\"strong\",null,{\"children\":\"But the problem with simply omitting local functions is that it gets pretty hard to tell whether we’re handling all cases as the component grows!\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Imagine our code was split like this and each function was five times larger:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Imagine this function is long\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Imagine this function is also long\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" await \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"axios\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"());\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Now let’s say we later use some state or prop in one of these functions:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Imagine this function is also long\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Imagine this function is also long\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" await \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"axios\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"());\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If we forget to update the deps of any effects that call these functions (possibly, through other functions!), our effects will fail to synchronize changes from our props and state. This doesn’t sound great.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Luckily, there is an easy solution to this problem. \",[\"$\",\"strong\",null,{\"children\":[\"If you only use some functions \",[\"$\",\"em\",null,{\"children\":\"inside\"}],\" an effect, move them directly \",[\"$\",\"em\",null,{\"children\":\"into\"}],\" that effect:\"]}]]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// We moved these functions inside!\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" await \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"axios\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"());\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"(\",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/04kp3jwwql\",\"children\":\"Here’s a demo\"}],\".)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"So what is the benefit? We no longer have to think about the “transitive dependencies”. Our dependencies array isn’t lying anymore: \",[\"$\",\"strong\",null,{\"children\":[\"we truly \",[\"$\",\"em\",null,{\"children\":\"aren’t\"}],\" using anything from the outer scope of the component in our effect\"]}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If we later edit \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\" to use the \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" state, we’re much more likely to notice that we’re editing it \",[\"$\",\"em\",null,{\"children\":\"inside\"}],\" an effect — and therefore, we need to add \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" to the effect dependencies:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" await \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"axios\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"());\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"(Here’s a \",[\"$\",\"$La\",null,{\"href\":\"https://codesandbox.io/s/pwm32zx7z7\",\"children\":\"demo\"}],\".)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"By adding this dependency, we’re not just “appeasing React”. It \",[\"$\",\"em\",null,{\"children\":\"makes sense\"}],\" to refetch the data when the query changes. \",[\"$\",\"strong\",null,{\"children\":[\"The design of \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" forces you to notice the change in our data flow and choose how our effects should synchronize it — instead of ignoring it until our product users hit a bug.\"]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Thanks to the \",[\"$\",\"code\",null,{\"children\":\"exhaustive-deps\"}],\" lint rule from the \",[\"$\",\"code\",null,{\"children\":\"eslint-plugin-react-hooks\"}],\" plugin, you can \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/facebook/react/issues/14920\",\"children\":\"analyze the effects as you type in your editor\"}],\" and receive suggestions about which dependencies are missing. In other words, a machine can tell you which data flow changes aren’t handled correctly by a component.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"./exhaustive-deps.gif\",\"alt\":\"Lint rule gif\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Pretty sweet.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"But I Can’t Put This Function Inside an Effect\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Sometimes you might not want to move a function \",[\"$\",\"em\",null,{\"children\":\"inside\"}],\" an effect. For example, several effects in the same component may call the same function, and you don’t want to copy and paste its logic. Or maybe it’s a prop.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Should you skip a function like this in the effect dependencies? I think not. Again, \",[\"$\",\"strong\",null,{\"children\":\"effects shouldn’t lie about their dependencies.\"}],\" There are usually better solutions. A common misconception is that “a function would never change”. But as we learned throughout this article, this couldn’t be further from truth. Indeed, a function defined inside a component changes on every render!\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"That by itself presents a problem.\"}],\" Say two effects call \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🔴 Missing dep: getFetchUrl\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"redux\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🔴 Missing dep: getFetchUrl\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In that case you might not want to move \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\" inside either of the effects since you wouldn’t be able to share the logic.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"On the other hand, if you’re “honest” about the effect dependencies, you may run into a problem. Since both our effects depend on \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\" \",[\"$\",\"strong\",null,{\"children\":\"(which is different on every render)\"}],\", our dependency arrays are useless:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🔴 Re-triggers all effects on every render\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🚧 Deps are correct but they change too often\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"redux\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🚧 Deps are correct but they change too often\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A tempting solution to this is to just skip the \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\" function in the deps list. However, I don’t think it’s a good solution. This makes it difficult to notice when we \",[\"$\",\"em\",null,{\"children\":\"are\"}],\" adding a change to the data flow that \",[\"$\",\"em\",null,{\"children\":\"needs\"}],\" to be handled by an effect. This leads to bugs like the “never updating interval” we saw earlier.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Instead, there are two other solutions that are simpler.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"First of all, if a function doesn’t use anything from the component scope, you can hoist it outside the component and then freely use it inside your effects:\"}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Not affected by the data flow\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"redux\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"There’s no need to specify it in deps because it’s not in the render scope and can’t be affected by the data flow. It can’t accidentally depend on props or state.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Alternatively, you can wrap it into the \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-reference.html#usecallback\",\"children\":[[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\" Hook\"]}],\":\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Preserves identity when its own deps are the same\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useCallback\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    return \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Callback deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Effect deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"redux\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Effect deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\" is essentially like adding another layer of dependency checks. It’s solving the problem on the other end — \",[\"$\",\"strong\",null,{\"children\":\"rather than avoid a function dependency, we make the function itself only change when necessary\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Let’s see why this approach is useful. Previously, our example showed two search results (for \",[\"$\",\"code\",null,{\"children\":\"'react'\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"'redux'\"}],\" search queries). But let’s say we want to add an input so that you can search for an arbitrary \",[\"$\",\"code\",null,{\"children\":\"query\"}],\". So instead of taking \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" as an argument, \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\" will now read it from local state.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We’ll immediately see that it’s missing a \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" dependency:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useCallback\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// No query argument\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    return \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🔴 Missing dep: query\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If I fix my \",[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\" deps to include \",[\"$\",\"code\",null,{\"children\":\"query\"}],\", any effect with \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\" in deps will re-run whenever the \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" changes:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"SearchResults\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Preserves identity until query changes\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useCallback\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    return \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Callback deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"getFetchUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Effect deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Thanks to \",[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\", if \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" is the same, \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\" also stays the same, and our effect doesn’t re-run. But if \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" changes, \",[\"$\",\"code\",null,{\"children\":\"getFetchUrl\"}],\" will also change, and we will re-fetch the data. It’s a lot like when you change some cell in an Excel spreadsheet, and the other cells using it recalculate automatically.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is just a consequence of embracing the data flow and the synchronization mindset. \",[\"$\",\"strong\",null,{\"children\":\"The same solution works for function props passed from parents:\"}]]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Parent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Preserves identity until query changes\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useCallback\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and return it ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Callback deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" fetchData={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ fetchData }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"().\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"then\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ✅ Effect deps are OK\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Since \",[\"$\",\"code\",null,{\"children\":\"fetchData\"}],\" only changes inside \",[\"$\",\"code\",null,{\"children\":\"Parent\"}],\" when its \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" state changes, our \",[\"$\",\"code\",null,{\"children\":\"Child\"}],\" won’t refetch the data until it’s actually necessary for the app.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Are Functions Part of the Data Flow?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Interestingly, this pattern is broken with classes in a way that really shows the difference between the effect and lifecycle paradigms. Consider this translation:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFCB8B\"},\"children\":\"Parent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"extends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  state \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" fetchData={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFCB8B\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"extends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  state \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidMount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You might be thinking: “Come on Dan, we all know that \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" is like \",[\"$\",\"code\",null,{\"children\":\"componentDidMount\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"componentDidUpdate\"}],\" combined, you can’t keep beating that drum!” \",[\"$\",\"strong\",null,{\"children\":[\"Yet this doesn’t work even with \",[\"$\",\"code\",null,{\"children\":\"componentDidUpdate\"}],\":\"]}]]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFCB8B\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"extends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  state \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidMount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"prevProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 🔴 This condition will never be true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"fetchData \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"!==\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"prevProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Of course, \",[\"$\",\"code\",null,{\"children\":\"fetchData\"}],\" is a class method! (Or, rather, a class property — but that doesn’t change anything.) It’s not going to be different because of a state change. So \",[\"$\",\"code\",null,{\"children\":\"this.props.fetchData\"}],\" will stay equal to \",[\"$\",\"code\",null,{\"children\":\"prevProps.fetchData\"}],\" and we’ll never refetch. Let’s just remove this condition then?\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"prevProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Oh wait, this fetches on \",[\"$\",\"em\",null,{\"children\":\"every\"}],\" re-render. (Adding an animation above in the tree is a fun way to discover it.) Maybe let’s bind it to a particular query?\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" fetchData={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"bind\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")} /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"But then \",[\"$\",\"code\",null,{\"children\":\"this.props.fetchData !== prevProps.fetchData\"}],\" is \",[\"$\",\"em\",null,{\"children\":\"always\"}],\" \",[\"$\",\"code\",null,{\"children\":\"true\"}],\", even if the \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" didn’t change! So we’ll \",[\"$\",\"em\",null,{\"children\":\"always\"}],\" refetch.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The only real solution to this conundrum with classes is to bite the bullet and pass the \",[\"$\",\"code\",null,{\"children\":\"query\"}],\" itself into the \",[\"$\",\"code\",null,{\"children\":\"Child\"}],\" component. The \",[\"$\",\"code\",null,{\"children\":\"Child\"}],\" doesn’t actually end up \",[\"$\",\"em\",null,{\"children\":\"using\"}],\" the \",[\"$\",\"code\",null,{\"children\":\"query\"}],\", but it can trigger a refetch when it changes:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFCB8B\"},\"children\":\"Parent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"extends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  state \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"https://hn.algolia.com/api/v1/search?query=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ... Fetch data and do something ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" fetchData={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} query={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFCB8B\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"extends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  state \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidMount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"prevProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"!==\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"prevProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"render\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Over the years of working with classes with React, I’ve gotten so used to passing unnecessary props down and breaking encapsulation of parent components that I only realized a week ago why we had to do it.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"With classes, function props by themselves aren’t truly a part of the data flow.\"}],\" Methods close over the mutable \",[\"$\",\"code\",null,{\"children\":\"this\"}],\" variable so we can’t rely on their identity to mean anything. Therefore, even when we only want a function, we have to pass a bunch of other data around in order to be able to “diff” it. We can’t know whether \",[\"$\",\"code\",null,{\"children\":\"this.props.fetchData\"}],\" passed from the parent depends on some state or not, and whether that state has just changed.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"With \",[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\", functions can fully participate in the data flow.\"]}],\" We can say that if the function inputs changed, the function itself has changed, but if not, it stayed the same. Thanks to the granularity provided by \",[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\", changes to props like \",[\"$\",\"code\",null,{\"children\":\"props.fetchData\"}],\" can propagate down automatically.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Similarly, \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-reference.html#usememo\",\"children\":[\"$\",\"code\",null,{\"children\":\"useMemo\"}]}],\" lets us do the same for complex objects:\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"ColorPicker\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Doesn't break Child's shallow equality prop check\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// unless the color actually changes.\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"color\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"pink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"style\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useMemo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" =\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"color \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}),\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"color\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"Child\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" style={\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"style\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"} /\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"I want to emphasize that putting \",[\"$\",\"code\",null,{\"children\":\"useCallback\"}],\" everywhere is pretty clunky.\"]}],\" It’s a nice escape hatch and it’s useful when a function is both passed down \",[\"$\",\"em\",null,{\"children\":\"and\"}],\" called from inside an effect in some children. Or if you’re trying to prevent breaking memoization of a child component. But Hooks lend themselves better to \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down\",\"children\":\"avoiding passing callbacks down\"}],\" altogether.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In the above examples, I’d much prefer if \",[\"$\",\"code\",null,{\"children\":\"fetchData\"}],\" was either inside my effect (which itself could be extracted to a custom Hook) or a top-level import. I want to keep the effects simple, and callbacks in them don’t help that. (“What if some \",[\"$\",\"code\",null,{\"children\":\"props.onComplete\"}],\" callback changes while the request was in flight?”) You can \",[\"$\",\"$La\",null,{\"href\":\"#swimming-against-the-tide\",\"children\":\"simulate the class behavior\"}],\" but that doesn’t solve race conditions.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Speaking of Race Conditions\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A classic data fetching example with classes might look like this:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFCB8B\"},\"children\":\"Article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"extends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  state \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidMount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" await \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"API\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchArticle\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" article \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"As you probably know, this code is buggy. It doesn’t handle updates. So the second classic example you could find online is something like this:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFCB8B\"},\"children\":\"Article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"extends\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" Component \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  state \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidMount\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"componentDidUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"prevProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"prevProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"!==\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" await \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"API\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchArticle\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" article \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"});\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is definitely better! But it’s still buggy. The reason it’s buggy is that the request may come out of order. So if I’m fetching \",[\"$\",\"code\",null,{\"children\":\"{id: 10}\"}],\", switch to \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\", but the \",[\"$\",\"code\",null,{\"children\":\"{id: 20}\"}],\" request comes first, the request that started earlier but finished later would incorrectly overwrite my state.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is called a race condition, and it’s typical in code that mixes \",[\"$\",\"code\",null,{\"children\":\"async\"}],\" / \",[\"$\",\"code\",null,{\"children\":\"await\"}],\" (which assumes something waits for the result) with top-down data flow (props or state can change while we’re in the middle of an async function).\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Effects don’t magically solve this problem, although they’ll warn you if you try to pass an \",[\"$\",\"code\",null,{\"children\":\"async\"}],\" function to the effect directly. (We’ll need to improve that warning to better explain the problems you might run into.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If the async approach you use supports cancellation, that’s great! You can cancel the async request right in your cleanup function.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Alternatively, the easiest stopgap approach is to track it with a boolean:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"jsx\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"Article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"{ id }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"setArticle\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useState\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useEffect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"let \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"didCancel\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" await \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"API\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchArticle\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"didCancel\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"        \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"setArticle\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"article\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"fetchData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"      didCancel \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F87086\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"data-highlighted-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"},\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"]);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// ...\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"$La\",null,{\"href\":\"https://www.robinwieruch.de/react-hooks-fetch-data/\",\"children\":\"This article\"}],\" goes into more detail about how you can handle errors and loading states, as well as extract that logic into a custom Hook. I recommend you to check it out if you’re interested to learn more about data fetching with Hooks.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Raising the Bar\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"With the class lifecycle mindset, side effects behave differently from the render output. Rendering the UI is driven by props and state, and is guaranteed to be consistent with them, but side effects are not. This is a common source of bugs.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"With the mindset of \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\", things are synchronized by default. Side effects become a part of the React data flow. For every \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" call, once you get it right, your component handles edge cases much better.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"However, the upfront cost of getting it right is higher. This can be annoying. Writing synchronization code that handles edge cases well is inherently more difficult than firing one-off side effects that aren’t consistent with rendering.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This could be worrying if \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" was meant to be \",[\"$\",\"em\",null,{\"children\":\"the\"}],\" tool you use most of the time. However, it’s a low-level building block. It’s an early time for Hooks so everybody uses low-level ones all the time, especially in tutorials. But in practice, it’s likely the community will start moving to higher-level Hooks as good APIs gain momentum.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I’m seeing different apps create their own Hooks like \",[\"$\",\"code\",null,{\"children\":\"useFetch\"}],\" that encapsulates some of their app’s auth logic or \",[\"$\",\"code\",null,{\"children\":\"useTheme\"}],\" which uses theme context. Once you have a toolbox of those, you don’t reach for \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" \",[\"$\",\"em\",null,{\"children\":\"that\"}],\" often. But the resilience it brings benefits every Hook built on top of it.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"So far, \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" is most commonly used for data fetching. But data fetching isn’t exactly a synchronization problem. This is especially obvious because our deps are often \",[\"$\",\"code\",null,{\"children\":\"[]\"}],\". What are we even synchronizing?\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In the longer term, \",[\"$\",\"$La\",null,{\"href\":\"https://reactjs.org/blog/2018/11/27/react-16-roadmap.html#react-16x-mid-2019-the-one-with-suspense-for-data-fetching\",\"children\":\"Suspense for Data Fetching\"}],\" will allow third-party libraries to have a first-class way to tell React to suspend rendering until something async (anything: code, data, images) is ready.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"As Suspense gradually covers more data fetching use cases, I anticipate that \",[\"$\",\"code\",null,{\"children\":\"useEffect\"}],\" will fade into background as a power user tool for cases when you actually want to synchronize props and state to some side effect. Unlike data fetching, it handles this case naturally because it was designed for it. But until then, custom Hooks like \",[\"$\",\"$La\",null,{\"href\":\"https://www.robinwieruch.de/react-hooks-fetch-data/\",\"children\":\"shown here\"}],\" are a good way to reuse data fetching logic.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"In Closing\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now that you know pretty much everything I know about using effects, check out the \",[\"$\",\"$La\",null,{\"href\":\"#tldr\",\"children\":\"TLDR\"}],\" in the beginning. Does it make sense? Did I miss something? (I haven’t run out of paper yet!)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I’d love to hear from you on Twitter! Thanks for reading.\"}]]\n"])</script><script>self.__next_f.push([1,""])</script></body></html>